<!DOCTYPE html>




<html class="theme-next pisces" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
    
  
  <link href="https://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet" type="text/css" />







  

<link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.css" rel="stylesheet" type="text/css" />



  

<link href="https://cdn.bootcss.com/social-share.js/1.0.9/css/share.min.css" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=0.0.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=0.0.4">



  <link rel="mask-icon" href="/images/logo.svg?v=0.0.4" color="#222">





  <meta name="keywords" content="Vue源码逐行解读," />










<meta name="description" content="前言由于直接在 vue 文件夹中跳来跳去会非常混乱，要去各个文件一层层中找到想要的函数，不方便查找，就逐行看下来了，不过这样跳来跳去可以比较清楚地了解 Vue 的运行流程，各有利弊吧。">
<meta property="og:type" content="article">
<meta property="og:title" content="Vue源码逐行解读">
<meta property="og:url" content="https://dloux.gitee.io/2020/09/05/Vue%E6%BA%90%E7%A0%81%E9%80%90%E8%A1%8C%E8%A7%A3%E8%AF%BB/index.html">
<meta property="og:site_name" content="Dloux">
<meta property="og:description" content="前言由于直接在 vue 文件夹中跳来跳去会非常混乱，要去各个文件一层层中找到想要的函数，不方便查找，就逐行看下来了，不过这样跳来跳去可以比较清楚地了解 Vue 的运行流程，各有利弊吧。">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-09-05T02:44:02.000Z">
<meta property="article:modified_time" content="2020-09-05T02:56:24.121Z">
<meta property="article:author" content="Dloux">
<meta property="article:tag" content="Vue源码逐行解读">
<meta name="twitter:card" content="summary">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '0.0.4',
    sidebar: {"position":"right","display":"always","offset":52,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    since: '6/2/2020 11:30:00',
    onlineAPI: '',
    site: {
      title: 'Dloux',
      subtitle: '',
      author: 'Dloux'
    },
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    leancloud: {
      enable: false,
      appID: '',
      appKey: ''
    },
    favicon: {
      visibilitychange: true,
      narmal: '',
      hidden: '/images/failure.ico',
      show_text: '(/≧▽≦/)咦！又好了！',
      hide_text: '(●—●)喔哟，崩溃啦！'
    }
  };
</script>



  
    <script type="text/javascript" src="https://cdn.bootcss.com/jquery/2.1.3/jquery.min.js"></script>




  <link rel="canonical" href="https://dloux.gitee.io/2020/09/05/Vue源码逐行解读/"/>





  <title>Vue源码逐行解读 | Dloux</title>
  








<meta name="generator" content="Hexo 4.2.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-right page-post-detail">
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-主页">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            主页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-实验室">
          <a href="/proj" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-magic"></i> <br />
            
            实验室
          </a>
        </li>
      
        
        <li class="menu-item menu-item-归档">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-关于我">
          <a href="/proj/cv/resume.html" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br />
            
            关于我
          </a>
        </li>
      
        
        <li class="menu-item menu-item-吃个饭">
          <a href="/proj/meal/index.html" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br />
            
            吃个饭
          </a>
        </li>
      

      
      <li class="menu-item search">
          <form class="search-form">
            <input name="keyword" type="text" class="search-input" placeholder="站内搜索">
            <button type="submit" class="search-submit"><i class="fa fa-search"></i></button>
          </form>
      </li>
      <li class="menu-item online"><span id="online-count">?</span>人在线</li>
    </ul>
  

  
</nav>

<div class="site-brand-wrapper" style="background-image: url(/images/header-cat.jpg)">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <div class="brand">
        <span class="logo-line-before"><i></i></span>
        <div class="site-title">
          <div id="animate" class="animate">
            <span>D</span><span>l</span><span>o</span><span>u</span><span>x</span>
          </div>
          <div id="guide" class="guide">
            <span>D</span><span>l</span><span>o</span><span>u</span><span>x</span>
          </div>
        </div>
        <span class="logo-line-after"><i></i></span>
      </div>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>
<div class="site-master" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-master-avatar" itemprop="image" src="/images/dloux.jpg" alt="Dloux" />
    <h2 class="site-master-description" itemprop="description">
        catch fish with the hands
    </h2>
</div>


 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-date">
			<div class="post-month">09月</div>
			<div class="post-day">05</div>
	</div>
  
  <div class="post-badge">
    
      <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
        <a href="/categories/%E6%BA%90%E7%A0%81/" itemprop="url" rel="index">
          <span itemprop="name">源码</span>
        </a>
      </span>
    
  </div>
  

  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dloux.gitee.io/2020/09/05/Vue%E6%BA%90%E7%A0%81%E9%80%90%E8%A1%8C%E8%A7%A3%E8%AF%BB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Dloux">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/dloux.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dloux">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Vue源码逐行解读</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-09-05T10:44:02+08:00">
                2020-09-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">•</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%BA%90%E7%A0%81/" itemprop="url" rel="index">
                    <span itemprop="name">源码</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>由于直接在 vue 文件夹中跳来跳去会非常混乱，要去各个文件一层层中找到想要的函数，不方便查找，就逐行看下来了，不过这样跳来跳去可以比较清楚地了解 Vue 的运行流程，各有利弊吧。<a id="more"></a></p>
<p>目前只看了这些，进度缓慢。主要是这样的看源码方式，虽然知道定义了这个函数，但并不清楚它到底会用在哪个地方，为了理解，往往还是会直接跳到调用这个函数的地方。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br><span class="line">1022</span><br><span class="line">1023</span><br><span class="line">1024</span><br><span class="line">1025</span><br><span class="line">1026</span><br><span class="line">1027</span><br><span class="line">1028</span><br><span class="line">1029</span><br><span class="line">1030</span><br><span class="line">1031</span><br><span class="line">1032</span><br><span class="line">1033</span><br><span class="line">1034</span><br><span class="line">1035</span><br><span class="line">1036</span><br><span class="line">1037</span><br><span class="line">1038</span><br><span class="line">1039</span><br><span class="line">1040</span><br><span class="line">1041</span><br><span class="line">1042</span><br><span class="line">1043</span><br><span class="line">1044</span><br><span class="line">1045</span><br><span class="line">1046</span><br><span class="line">1047</span><br><span class="line">1048</span><br><span class="line">1049</span><br><span class="line">1050</span><br><span class="line">1051</span><br><span class="line">1052</span><br><span class="line">1053</span><br><span class="line">1054</span><br><span class="line">1055</span><br><span class="line">1056</span><br><span class="line">1057</span><br><span class="line">1058</span><br><span class="line">1059</span><br><span class="line">1060</span><br><span class="line">1061</span><br><span class="line">1062</span><br><span class="line">1063</span><br><span class="line">1064</span><br><span class="line">1065</span><br><span class="line">1066</span><br><span class="line">1067</span><br><span class="line">1068</span><br><span class="line">1069</span><br><span class="line">1070</span><br><span class="line">1071</span><br><span class="line">1072</span><br><span class="line">1073</span><br><span class="line">1074</span><br><span class="line">1075</span><br><span class="line">1076</span><br><span class="line">1077</span><br><span class="line">1078</span><br><span class="line">1079</span><br><span class="line">1080</span><br><span class="line">1081</span><br><span class="line">1082</span><br><span class="line">1083</span><br><span class="line">1084</span><br><span class="line">1085</span><br><span class="line">1086</span><br><span class="line">1087</span><br><span class="line">1088</span><br><span class="line">1089</span><br><span class="line">1090</span><br><span class="line">1091</span><br><span class="line">1092</span><br><span class="line">1093</span><br><span class="line">1094</span><br><span class="line">1095</span><br><span class="line">1096</span><br><span class="line">1097</span><br><span class="line">1098</span><br><span class="line">1099</span><br><span class="line">1100</span><br><span class="line">1101</span><br><span class="line">1102</span><br><span class="line">1103</span><br><span class="line">1104</span><br><span class="line">1105</span><br><span class="line">1106</span><br><span class="line">1107</span><br><span class="line">1108</span><br><span class="line">1109</span><br><span class="line">1110</span><br><span class="line">1111</span><br><span class="line">1112</span><br><span class="line">1113</span><br><span class="line">1114</span><br><span class="line">1115</span><br><span class="line">1116</span><br><span class="line">1117</span><br><span class="line">1118</span><br><span class="line">1119</span><br><span class="line">1120</span><br><span class="line">1121</span><br><span class="line">1122</span><br><span class="line">1123</span><br><span class="line">1124</span><br><span class="line">1125</span><br><span class="line">1126</span><br><span class="line">1127</span><br><span class="line">1128</span><br><span class="line">1129</span><br><span class="line">1130</span><br><span class="line">1131</span><br><span class="line">1132</span><br><span class="line">1133</span><br><span class="line">1134</span><br><span class="line">1135</span><br><span class="line">1136</span><br><span class="line">1137</span><br><span class="line">1138</span><br><span class="line">1139</span><br><span class="line">1140</span><br><span class="line">1141</span><br><span class="line">1142</span><br><span class="line">1143</span><br><span class="line">1144</span><br><span class="line">1145</span><br><span class="line">1146</span><br><span class="line">1147</span><br><span class="line">1148</span><br><span class="line">1149</span><br><span class="line">1150</span><br><span class="line">1151</span><br><span class="line">1152</span><br><span class="line">1153</span><br><span class="line">1154</span><br><span class="line">1155</span><br><span class="line">1156</span><br><span class="line">1157</span><br><span class="line">1158</span><br><span class="line">1159</span><br><span class="line">1160</span><br><span class="line">1161</span><br><span class="line">1162</span><br><span class="line">1163</span><br><span class="line">1164</span><br><span class="line">1165</span><br><span class="line">1166</span><br><span class="line">1167</span><br><span class="line">1168</span><br><span class="line">1169</span><br><span class="line">1170</span><br><span class="line">1171</span><br><span class="line">1172</span><br><span class="line">1173</span><br><span class="line">1174</span><br><span class="line">1175</span><br><span class="line">1176</span><br><span class="line">1177</span><br><span class="line">1178</span><br><span class="line">1179</span><br><span class="line">1180</span><br><span class="line">1181</span><br><span class="line">1182</span><br><span class="line">1183</span><br><span class="line">1184</span><br><span class="line">1185</span><br><span class="line">1186</span><br><span class="line">1187</span><br><span class="line">1188</span><br><span class="line">1189</span><br><span class="line">1190</span><br><span class="line">1191</span><br><span class="line">1192</span><br><span class="line">1193</span><br><span class="line">1194</span><br><span class="line">1195</span><br><span class="line">1196</span><br><span class="line">1197</span><br><span class="line">1198</span><br><span class="line">1199</span><br><span class="line">1200</span><br><span class="line">1201</span><br><span class="line">1202</span><br><span class="line">1203</span><br><span class="line">1204</span><br><span class="line">1205</span><br><span class="line">1206</span><br><span class="line">1207</span><br><span class="line">1208</span><br><span class="line">1209</span><br><span class="line">1210</span><br><span class="line">1211</span><br><span class="line">1212</span><br><span class="line">1213</span><br><span class="line">1214</span><br><span class="line">1215</span><br><span class="line">1216</span><br><span class="line">1217</span><br><span class="line">1218</span><br><span class="line">1219</span><br><span class="line">1220</span><br><span class="line">1221</span><br><span class="line">1222</span><br><span class="line">1223</span><br><span class="line">1224</span><br><span class="line">1225</span><br><span class="line">1226</span><br><span class="line">1227</span><br><span class="line">1228</span><br><span class="line">1229</span><br><span class="line">1230</span><br><span class="line">1231</span><br><span class="line">1232</span><br><span class="line">1233</span><br><span class="line">1234</span><br><span class="line">1235</span><br><span class="line">1236</span><br><span class="line">1237</span><br><span class="line">1238</span><br><span class="line">1239</span><br><span class="line">1240</span><br><span class="line">1241</span><br><span class="line">1242</span><br><span class="line">1243</span><br><span class="line">1244</span><br><span class="line">1245</span><br><span class="line">1246</span><br><span class="line">1247</span><br><span class="line">1248</span><br><span class="line">1249</span><br><span class="line">1250</span><br><span class="line">1251</span><br><span class="line">1252</span><br><span class="line">1253</span><br><span class="line">1254</span><br><span class="line">1255</span><br><span class="line">1256</span><br><span class="line">1257</span><br><span class="line">1258</span><br><span class="line">1259</span><br><span class="line">1260</span><br><span class="line">1261</span><br><span class="line">1262</span><br><span class="line">1263</span><br><span class="line">1264</span><br><span class="line">1265</span><br><span class="line">1266</span><br><span class="line">1267</span><br><span class="line">1268</span><br><span class="line">1269</span><br><span class="line">1270</span><br><span class="line">1271</span><br><span class="line">1272</span><br><span class="line">1273</span><br><span class="line">1274</span><br><span class="line">1275</span><br><span class="line">1276</span><br><span class="line">1277</span><br><span class="line">1278</span><br><span class="line">1279</span><br><span class="line">1280</span><br><span class="line">1281</span><br><span class="line">1282</span><br><span class="line">1283</span><br><span class="line">1284</span><br><span class="line">1285</span><br><span class="line">1286</span><br><span class="line">1287</span><br><span class="line">1288</span><br><span class="line">1289</span><br><span class="line">1290</span><br><span class="line">1291</span><br><span class="line">1292</span><br><span class="line">1293</span><br><span class="line">1294</span><br><span class="line">1295</span><br><span class="line">1296</span><br><span class="line">1297</span><br><span class="line">1298</span><br><span class="line">1299</span><br><span class="line">1300</span><br><span class="line">1301</span><br><span class="line">1302</span><br><span class="line">1303</span><br><span class="line">1304</span><br><span class="line">1305</span><br><span class="line">1306</span><br><span class="line">1307</span><br><span class="line">1308</span><br><span class="line">1309</span><br><span class="line">1310</span><br><span class="line">1311</span><br><span class="line">1312</span><br><span class="line">1313</span><br><span class="line">1314</span><br><span class="line">1315</span><br><span class="line">1316</span><br><span class="line">1317</span><br><span class="line">1318</span><br><span class="line">1319</span><br><span class="line">1320</span><br><span class="line">1321</span><br><span class="line">1322</span><br><span class="line">1323</span><br><span class="line">1324</span><br><span class="line">1325</span><br><span class="line">1326</span><br><span class="line">1327</span><br><span class="line">1328</span><br><span class="line">1329</span><br><span class="line">1330</span><br><span class="line">1331</span><br><span class="line">1332</span><br><span class="line">1333</span><br><span class="line">1334</span><br><span class="line">1335</span><br><span class="line">1336</span><br><span class="line">1337</span><br><span class="line">1338</span><br><span class="line">1339</span><br><span class="line">1340</span><br><span class="line">1341</span><br><span class="line">1342</span><br><span class="line">1343</span><br><span class="line">1344</span><br><span class="line">1345</span><br><span class="line">1346</span><br><span class="line">1347</span><br><span class="line">1348</span><br><span class="line">1349</span><br><span class="line">1350</span><br><span class="line">1351</span><br><span class="line">1352</span><br><span class="line">1353</span><br><span class="line">1354</span><br><span class="line">1355</span><br><span class="line">1356</span><br><span class="line">1357</span><br><span class="line">1358</span><br><span class="line">1359</span><br><span class="line">1360</span><br><span class="line">1361</span><br><span class="line">1362</span><br><span class="line">1363</span><br><span class="line">1364</span><br><span class="line">1365</span><br><span class="line">1366</span><br><span class="line">1367</span><br><span class="line">1368</span><br><span class="line">1369</span><br><span class="line">1370</span><br><span class="line">1371</span><br><span class="line">1372</span><br><span class="line">1373</span><br><span class="line">1374</span><br><span class="line">1375</span><br><span class="line">1376</span><br><span class="line">1377</span><br><span class="line">1378</span><br><span class="line">1379</span><br><span class="line">1380</span><br><span class="line">1381</span><br><span class="line">1382</span><br><span class="line">1383</span><br><span class="line">1384</span><br><span class="line">1385</span><br><span class="line">1386</span><br><span class="line">1387</span><br><span class="line">1388</span><br><span class="line">1389</span><br><span class="line">1390</span><br><span class="line">1391</span><br><span class="line">1392</span><br><span class="line">1393</span><br><span class="line">1394</span><br><span class="line">1395</span><br><span class="line">1396</span><br><span class="line">1397</span><br><span class="line">1398</span><br><span class="line">1399</span><br><span class="line">1400</span><br><span class="line">1401</span><br><span class="line">1402</span><br><span class="line">1403</span><br><span class="line">1404</span><br><span class="line">1405</span><br><span class="line">1406</span><br><span class="line">1407</span><br><span class="line">1408</span><br><span class="line">1409</span><br><span class="line">1410</span><br><span class="line">1411</span><br><span class="line">1412</span><br><span class="line">1413</span><br><span class="line">1414</span><br><span class="line">1415</span><br><span class="line">1416</span><br><span class="line">1417</span><br><span class="line">1418</span><br><span class="line">1419</span><br><span class="line">1420</span><br><span class="line">1421</span><br><span class="line">1422</span><br><span class="line">1423</span><br><span class="line">1424</span><br><span class="line">1425</span><br><span class="line">1426</span><br><span class="line">1427</span><br><span class="line">1428</span><br><span class="line">1429</span><br><span class="line">1430</span><br><span class="line">1431</span><br><span class="line">1432</span><br><span class="line">1433</span><br><span class="line">1434</span><br><span class="line">1435</span><br><span class="line">1436</span><br><span class="line">1437</span><br><span class="line">1438</span><br><span class="line">1439</span><br><span class="line">1440</span><br><span class="line">1441</span><br><span class="line">1442</span><br><span class="line">1443</span><br><span class="line">1444</span><br><span class="line">1445</span><br><span class="line">1446</span><br><span class="line">1447</span><br><span class="line">1448</span><br><span class="line">1449</span><br><span class="line">1450</span><br><span class="line">1451</span><br><span class="line">1452</span><br><span class="line">1453</span><br><span class="line">1454</span><br><span class="line">1455</span><br><span class="line">1456</span><br><span class="line">1457</span><br><span class="line">1458</span><br><span class="line">1459</span><br><span class="line">1460</span><br><span class="line">1461</span><br><span class="line">1462</span><br><span class="line">1463</span><br><span class="line">1464</span><br><span class="line">1465</span><br><span class="line">1466</span><br><span class="line">1467</span><br><span class="line">1468</span><br><span class="line">1469</span><br><span class="line">1470</span><br><span class="line">1471</span><br><span class="line">1472</span><br><span class="line">1473</span><br><span class="line">1474</span><br><span class="line">1475</span><br><span class="line">1476</span><br><span class="line">1477</span><br><span class="line">1478</span><br><span class="line">1479</span><br><span class="line">1480</span><br><span class="line">1481</span><br><span class="line">1482</span><br><span class="line">1483</span><br><span class="line">1484</span><br><span class="line">1485</span><br><span class="line">1486</span><br><span class="line">1487</span><br><span class="line">1488</span><br><span class="line">1489</span><br><span class="line">1490</span><br><span class="line">1491</span><br><span class="line">1492</span><br><span class="line">1493</span><br><span class="line">1494</span><br><span class="line">1495</span><br><span class="line">1496</span><br><span class="line">1497</span><br><span class="line">1498</span><br><span class="line">1499</span><br><span class="line">1500</span><br><span class="line">1501</span><br><span class="line">1502</span><br><span class="line">1503</span><br><span class="line">1504</span><br><span class="line">1505</span><br><span class="line">1506</span><br><span class="line">1507</span><br><span class="line">1508</span><br><span class="line">1509</span><br><span class="line">1510</span><br><span class="line">1511</span><br><span class="line">1512</span><br><span class="line">1513</span><br><span class="line">1514</span><br><span class="line">1515</span><br><span class="line">1516</span><br><span class="line">1517</span><br><span class="line">1518</span><br><span class="line">1519</span><br><span class="line">1520</span><br><span class="line">1521</span><br><span class="line">1522</span><br><span class="line">1523</span><br><span class="line">1524</span><br><span class="line">1525</span><br><span class="line">1526</span><br><span class="line">1527</span><br><span class="line">1528</span><br><span class="line">1529</span><br><span class="line">1530</span><br><span class="line">1531</span><br><span class="line">1532</span><br><span class="line">1533</span><br><span class="line">1534</span><br><span class="line">1535</span><br><span class="line">1536</span><br><span class="line">1537</span><br><span class="line">1538</span><br><span class="line">1539</span><br><span class="line">1540</span><br><span class="line">1541</span><br><span class="line">1542</span><br><span class="line">1543</span><br><span class="line">1544</span><br><span class="line">1545</span><br><span class="line">1546</span><br><span class="line">1547</span><br><span class="line">1548</span><br><span class="line">1549</span><br><span class="line">1550</span><br><span class="line">1551</span><br><span class="line">1552</span><br><span class="line">1553</span><br><span class="line">1554</span><br><span class="line">1555</span><br><span class="line">1556</span><br><span class="line">1557</span><br><span class="line">1558</span><br><span class="line">1559</span><br><span class="line">1560</span><br><span class="line">1561</span><br><span class="line">1562</span><br><span class="line">1563</span><br><span class="line">1564</span><br><span class="line">1565</span><br><span class="line">1566</span><br><span class="line">1567</span><br><span class="line">1568</span><br><span class="line">1569</span><br><span class="line">1570</span><br><span class="line">1571</span><br><span class="line">1572</span><br><span class="line">1573</span><br><span class="line">1574</span><br><span class="line">1575</span><br><span class="line">1576</span><br><span class="line">1577</span><br><span class="line">1578</span><br><span class="line">1579</span><br><span class="line">1580</span><br><span class="line">1581</span><br><span class="line">1582</span><br><span class="line">1583</span><br><span class="line">1584</span><br><span class="line">1585</span><br><span class="line">1586</span><br><span class="line">1587</span><br><span class="line">1588</span><br><span class="line">1589</span><br><span class="line">1590</span><br><span class="line">1591</span><br><span class="line">1592</span><br><span class="line">1593</span><br><span class="line">1594</span><br><span class="line">1595</span><br><span class="line">1596</span><br><span class="line">1597</span><br><span class="line">1598</span><br><span class="line">1599</span><br><span class="line">1600</span><br><span class="line">1601</span><br><span class="line">1602</span><br><span class="line">1603</span><br><span class="line">1604</span><br><span class="line">1605</span><br><span class="line">1606</span><br><span class="line">1607</span><br><span class="line">1608</span><br><span class="line">1609</span><br><span class="line">1610</span><br><span class="line">1611</span><br><span class="line">1612</span><br><span class="line">1613</span><br><span class="line">1614</span><br><span class="line">1615</span><br><span class="line">1616</span><br><span class="line">1617</span><br><span class="line">1618</span><br><span class="line">1619</span><br><span class="line">1620</span><br><span class="line">1621</span><br><span class="line">1622</span><br><span class="line">1623</span><br><span class="line">1624</span><br><span class="line">1625</span><br><span class="line">1626</span><br><span class="line">1627</span><br><span class="line">1628</span><br><span class="line">1629</span><br><span class="line">1630</span><br><span class="line">1631</span><br><span class="line">1632</span><br><span class="line">1633</span><br><span class="line">1634</span><br><span class="line">1635</span><br><span class="line">1636</span><br><span class="line">1637</span><br><span class="line">1638</span><br><span class="line">1639</span><br><span class="line">1640</span><br><span class="line">1641</span><br><span class="line">1642</span><br><span class="line">1643</span><br><span class="line">1644</span><br><span class="line">1645</span><br><span class="line">1646</span><br><span class="line">1647</span><br><span class="line">1648</span><br><span class="line">1649</span><br><span class="line">1650</span><br><span class="line">1651</span><br><span class="line">1652</span><br><span class="line">1653</span><br><span class="line">1654</span><br><span class="line">1655</span><br><span class="line">1656</span><br><span class="line">1657</span><br><span class="line">1658</span><br><span class="line">1659</span><br><span class="line">1660</span><br><span class="line">1661</span><br><span class="line">1662</span><br><span class="line">1663</span><br><span class="line">1664</span><br><span class="line">1665</span><br><span class="line">1666</span><br><span class="line">1667</span><br><span class="line">1668</span><br><span class="line">1669</span><br><span class="line">1670</span><br><span class="line">1671</span><br><span class="line">1672</span><br><span class="line">1673</span><br><span class="line">1674</span><br><span class="line">1675</span><br><span class="line">1676</span><br><span class="line">1677</span><br><span class="line">1678</span><br><span class="line">1679</span><br><span class="line">1680</span><br><span class="line">1681</span><br><span class="line">1682</span><br><span class="line">1683</span><br><span class="line">1684</span><br><span class="line">1685</span><br><span class="line">1686</span><br><span class="line">1687</span><br><span class="line">1688</span><br><span class="line">1689</span><br><span class="line">1690</span><br><span class="line">1691</span><br><span class="line">1692</span><br><span class="line">1693</span><br><span class="line">1694</span><br><span class="line">1695</span><br><span class="line">1696</span><br><span class="line">1697</span><br><span class="line">1698</span><br><span class="line">1699</span><br><span class="line">1700</span><br><span class="line">1701</span><br><span class="line">1702</span><br><span class="line">1703</span><br><span class="line">1704</span><br><span class="line">1705</span><br><span class="line">1706</span><br><span class="line">1707</span><br><span class="line">1708</span><br><span class="line">1709</span><br><span class="line">1710</span><br><span class="line">1711</span><br><span class="line">1712</span><br><span class="line">1713</span><br><span class="line">1714</span><br><span class="line">1715</span><br><span class="line">1716</span><br><span class="line">1717</span><br><span class="line">1718</span><br><span class="line">1719</span><br><span class="line">1720</span><br><span class="line">1721</span><br><span class="line">1722</span><br><span class="line">1723</span><br><span class="line">1724</span><br><span class="line">1725</span><br><span class="line">1726</span><br><span class="line">1727</span><br><span class="line">1728</span><br><span class="line">1729</span><br><span class="line">1730</span><br><span class="line">1731</span><br><span class="line">1732</span><br><span class="line">1733</span><br><span class="line">1734</span><br><span class="line">1735</span><br><span class="line">1736</span><br><span class="line">1737</span><br><span class="line">1738</span><br><span class="line">1739</span><br><span class="line">1740</span><br><span class="line">1741</span><br><span class="line">1742</span><br><span class="line">1743</span><br><span class="line">1744</span><br><span class="line">1745</span><br><span class="line">1746</span><br><span class="line">1747</span><br><span class="line">1748</span><br><span class="line">1749</span><br><span class="line">1750</span><br><span class="line">1751</span><br><span class="line">1752</span><br><span class="line">1753</span><br><span class="line">1754</span><br><span class="line">1755</span><br><span class="line">1756</span><br><span class="line">1757</span><br><span class="line">1758</span><br><span class="line">1759</span><br><span class="line">1760</span><br><span class="line">1761</span><br><span class="line">1762</span><br><span class="line">1763</span><br><span class="line">1764</span><br><span class="line">1765</span><br><span class="line">1766</span><br><span class="line">1767</span><br><span class="line">1768</span><br><span class="line">1769</span><br><span class="line">1770</span><br><span class="line">1771</span><br><span class="line">1772</span><br><span class="line">1773</span><br><span class="line">1774</span><br><span class="line">1775</span><br><span class="line">1776</span><br><span class="line">1777</span><br><span class="line">1778</span><br><span class="line">1779</span><br><span class="line">1780</span><br><span class="line">1781</span><br><span class="line">1782</span><br><span class="line">1783</span><br><span class="line">1784</span><br><span class="line">1785</span><br><span class="line">1786</span><br><span class="line">1787</span><br><span class="line">1788</span><br><span class="line">1789</span><br><span class="line">1790</span><br><span class="line">1791</span><br><span class="line">1792</span><br><span class="line">1793</span><br><span class="line">1794</span><br><span class="line">1795</span><br><span class="line">1796</span><br><span class="line">1797</span><br><span class="line">1798</span><br><span class="line">1799</span><br><span class="line">1800</span><br><span class="line">1801</span><br><span class="line">1802</span><br><span class="line">1803</span><br><span class="line">1804</span><br><span class="line">1805</span><br><span class="line">1806</span><br><span class="line">1807</span><br><span class="line">1808</span><br><span class="line">1809</span><br><span class="line">1810</span><br><span class="line">1811</span><br><span class="line">1812</span><br><span class="line">1813</span><br><span class="line">1814</span><br><span class="line">1815</span><br><span class="line">1816</span><br><span class="line">1817</span><br><span class="line">1818</span><br><span class="line">1819</span><br><span class="line">1820</span><br><span class="line">1821</span><br><span class="line">1822</span><br><span class="line">1823</span><br><span class="line">1824</span><br><span class="line">1825</span><br><span class="line">1826</span><br><span class="line">1827</span><br><span class="line">1828</span><br><span class="line">1829</span><br><span class="line">1830</span><br><span class="line">1831</span><br><span class="line">1832</span><br><span class="line">1833</span><br><span class="line">1834</span><br><span class="line">1835</span><br><span class="line">1836</span><br><span class="line">1837</span><br><span class="line">1838</span><br><span class="line">1839</span><br><span class="line">1840</span><br><span class="line">1841</span><br><span class="line">1842</span><br><span class="line">1843</span><br><span class="line">1844</span><br><span class="line">1845</span><br><span class="line">1846</span><br><span class="line">1847</span><br><span class="line">1848</span><br><span class="line">1849</span><br><span class="line">1850</span><br><span class="line">1851</span><br><span class="line">1852</span><br><span class="line">1853</span><br><span class="line">1854</span><br><span class="line">1855</span><br><span class="line">1856</span><br><span class="line">1857</span><br><span class="line">1858</span><br><span class="line">1859</span><br><span class="line">1860</span><br><span class="line">1861</span><br><span class="line">1862</span><br><span class="line">1863</span><br><span class="line">1864</span><br><span class="line">1865</span><br><span class="line">1866</span><br><span class="line">1867</span><br><span class="line">1868</span><br><span class="line">1869</span><br><span class="line">1870</span><br><span class="line">1871</span><br><span class="line">1872</span><br><span class="line">1873</span><br><span class="line">1874</span><br><span class="line">1875</span><br><span class="line">1876</span><br><span class="line">1877</span><br><span class="line">1878</span><br><span class="line">1879</span><br><span class="line">1880</span><br><span class="line">1881</span><br><span class="line">1882</span><br><span class="line">1883</span><br><span class="line">1884</span><br><span class="line">1885</span><br><span class="line">1886</span><br><span class="line">1887</span><br><span class="line">1888</span><br><span class="line">1889</span><br><span class="line">1890</span><br><span class="line">1891</span><br><span class="line">1892</span><br><span class="line">1893</span><br><span class="line">1894</span><br><span class="line">1895</span><br><span class="line">1896</span><br><span class="line">1897</span><br><span class="line">1898</span><br><span class="line">1899</span><br><span class="line">1900</span><br><span class="line">1901</span><br><span class="line">1902</span><br><span class="line">1903</span><br><span class="line">1904</span><br><span class="line">1905</span><br><span class="line">1906</span><br><span class="line">1907</span><br><span class="line">1908</span><br><span class="line">1909</span><br><span class="line">1910</span><br><span class="line">1911</span><br><span class="line">1912</span><br><span class="line">1913</span><br><span class="line">1914</span><br><span class="line">1915</span><br><span class="line">1916</span><br><span class="line">1917</span><br><span class="line">1918</span><br><span class="line">1919</span><br><span class="line">1920</span><br><span class="line">1921</span><br><span class="line">1922</span><br><span class="line">1923</span><br><span class="line">1924</span><br><span class="line">1925</span><br><span class="line">1926</span><br><span class="line">1927</span><br><span class="line">1928</span><br><span class="line">1929</span><br><span class="line">1930</span><br><span class="line">1931</span><br><span class="line">1932</span><br><span class="line">1933</span><br><span class="line">1934</span><br><span class="line">1935</span><br><span class="line">1936</span><br><span class="line">1937</span><br><span class="line">1938</span><br><span class="line">1939</span><br><span class="line">1940</span><br><span class="line">1941</span><br><span class="line">1942</span><br><span class="line">1943</span><br><span class="line">1944</span><br><span class="line">1945</span><br><span class="line">1946</span><br><span class="line">1947</span><br><span class="line">1948</span><br><span class="line">1949</span><br><span class="line">1950</span><br><span class="line">1951</span><br><span class="line">1952</span><br><span class="line">1953</span><br><span class="line">1954</span><br><span class="line">1955</span><br><span class="line">1956</span><br><span class="line">1957</span><br><span class="line">1958</span><br><span class="line">1959</span><br><span class="line">1960</span><br><span class="line">1961</span><br><span class="line">1962</span><br><span class="line">1963</span><br><span class="line">1964</span><br><span class="line">1965</span><br><span class="line">1966</span><br><span class="line">1967</span><br><span class="line">1968</span><br><span class="line">1969</span><br><span class="line">1970</span><br><span class="line">1971</span><br><span class="line">1972</span><br><span class="line">1973</span><br><span class="line">1974</span><br><span class="line">1975</span><br><span class="line">1976</span><br><span class="line">1977</span><br><span class="line">1978</span><br><span class="line">1979</span><br><span class="line">1980</span><br><span class="line">1981</span><br><span class="line">1982</span><br><span class="line">1983</span><br><span class="line">1984</span><br><span class="line">1985</span><br><span class="line">1986</span><br><span class="line">1987</span><br><span class="line">1988</span><br><span class="line">1989</span><br><span class="line">1990</span><br><span class="line">1991</span><br><span class="line">1992</span><br><span class="line">1993</span><br><span class="line">1994</span><br><span class="line">1995</span><br><span class="line">1996</span><br><span class="line">1997</span><br><span class="line">1998</span><br><span class="line">1999</span><br><span class="line">2000</span><br><span class="line">2001</span><br><span class="line">2002</span><br><span class="line">2003</span><br><span class="line">2004</span><br><span class="line">2005</span><br><span class="line">2006</span><br><span class="line">2007</span><br><span class="line">2008</span><br><span class="line">2009</span><br><span class="line">2010</span><br><span class="line">2011</span><br><span class="line">2012</span><br><span class="line">2013</span><br><span class="line">2014</span><br><span class="line">2015</span><br><span class="line">2016</span><br><span class="line">2017</span><br><span class="line">2018</span><br><span class="line">2019</span><br><span class="line">2020</span><br><span class="line">2021</span><br><span class="line">2022</span><br><span class="line">2023</span><br><span class="line">2024</span><br><span class="line">2025</span><br><span class="line">2026</span><br><span class="line">2027</span><br><span class="line">2028</span><br><span class="line">2029</span><br><span class="line">2030</span><br><span class="line">2031</span><br><span class="line">2032</span><br><span class="line">2033</span><br><span class="line">2034</span><br><span class="line">2035</span><br><span class="line">2036</span><br><span class="line">2037</span><br><span class="line">2038</span><br><span class="line">2039</span><br><span class="line">2040</span><br><span class="line">2041</span><br><span class="line">2042</span><br><span class="line">2043</span><br><span class="line">2044</span><br><span class="line">2045</span><br><span class="line">2046</span><br><span class="line">2047</span><br><span class="line">2048</span><br><span class="line">2049</span><br><span class="line">2050</span><br><span class="line">2051</span><br><span class="line">2052</span><br><span class="line">2053</span><br><span class="line">2054</span><br><span class="line">2055</span><br><span class="line">2056</span><br><span class="line">2057</span><br><span class="line">2058</span><br><span class="line">2059</span><br><span class="line">2060</span><br><span class="line">2061</span><br><span class="line">2062</span><br><span class="line">2063</span><br><span class="line">2064</span><br><span class="line">2065</span><br><span class="line">2066</span><br><span class="line">2067</span><br><span class="line">2068</span><br><span class="line">2069</span><br><span class="line">2070</span><br><span class="line">2071</span><br><span class="line">2072</span><br><span class="line">2073</span><br><span class="line">2074</span><br><span class="line">2075</span><br><span class="line">2076</span><br><span class="line">2077</span><br><span class="line">2078</span><br><span class="line">2079</span><br><span class="line">2080</span><br><span class="line">2081</span><br><span class="line">2082</span><br><span class="line">2083</span><br><span class="line">2084</span><br><span class="line">2085</span><br><span class="line">2086</span><br><span class="line">2087</span><br><span class="line">2088</span><br><span class="line">2089</span><br><span class="line">2090</span><br><span class="line">2091</span><br><span class="line">2092</span><br><span class="line">2093</span><br><span class="line">2094</span><br><span class="line">2095</span><br><span class="line">2096</span><br><span class="line">2097</span><br><span class="line">2098</span><br><span class="line">2099</span><br><span class="line">2100</span><br><span class="line">2101</span><br><span class="line">2102</span><br><span class="line">2103</span><br><span class="line">2104</span><br><span class="line">2105</span><br><span class="line">2106</span><br><span class="line">2107</span><br><span class="line">2108</span><br><span class="line">2109</span><br><span class="line">2110</span><br><span class="line">2111</span><br><span class="line">2112</span><br><span class="line">2113</span><br><span class="line">2114</span><br><span class="line">2115</span><br><span class="line">2116</span><br><span class="line">2117</span><br><span class="line">2118</span><br><span class="line">2119</span><br><span class="line">2120</span><br><span class="line">2121</span><br><span class="line">2122</span><br><span class="line">2123</span><br><span class="line">2124</span><br><span class="line">2125</span><br><span class="line">2126</span><br><span class="line">2127</span><br><span class="line">2128</span><br><span class="line">2129</span><br><span class="line">2130</span><br><span class="line">2131</span><br><span class="line">2132</span><br><span class="line">2133</span><br><span class="line">2134</span><br><span class="line">2135</span><br><span class="line">2136</span><br><span class="line">2137</span><br><span class="line">2138</span><br><span class="line">2139</span><br><span class="line">2140</span><br><span class="line">2141</span><br><span class="line">2142</span><br><span class="line">2143</span><br><span class="line">2144</span><br><span class="line">2145</span><br><span class="line">2146</span><br><span class="line">2147</span><br><span class="line">2148</span><br><span class="line">2149</span><br><span class="line">2150</span><br><span class="line">2151</span><br><span class="line">2152</span><br><span class="line">2153</span><br><span class="line">2154</span><br><span class="line">2155</span><br><span class="line">2156</span><br><span class="line">2157</span><br><span class="line">2158</span><br><span class="line">2159</span><br><span class="line">2160</span><br><span class="line">2161</span><br><span class="line">2162</span><br><span class="line">2163</span><br><span class="line">2164</span><br><span class="line">2165</span><br><span class="line">2166</span><br><span class="line">2167</span><br><span class="line">2168</span><br><span class="line">2169</span><br><span class="line">2170</span><br><span class="line">2171</span><br><span class="line">2172</span><br><span class="line">2173</span><br><span class="line">2174</span><br><span class="line">2175</span><br><span class="line">2176</span><br><span class="line">2177</span><br><span class="line">2178</span><br><span class="line">2179</span><br><span class="line">2180</span><br><span class="line">2181</span><br><span class="line">2182</span><br><span class="line">2183</span><br><span class="line">2184</span><br><span class="line">2185</span><br><span class="line">2186</span><br><span class="line">2187</span><br><span class="line">2188</span><br><span class="line">2189</span><br><span class="line">2190</span><br><span class="line">2191</span><br><span class="line">2192</span><br><span class="line">2193</span><br><span class="line">2194</span><br><span class="line">2195</span><br><span class="line">2196</span><br><span class="line">2197</span><br><span class="line">2198</span><br><span class="line">2199</span><br><span class="line">2200</span><br><span class="line">2201</span><br><span class="line">2202</span><br><span class="line">2203</span><br><span class="line">2204</span><br><span class="line">2205</span><br><span class="line">2206</span><br><span class="line">2207</span><br><span class="line">2208</span><br><span class="line">2209</span><br><span class="line">2210</span><br><span class="line">2211</span><br><span class="line">2212</span><br><span class="line">2213</span><br><span class="line">2214</span><br><span class="line">2215</span><br><span class="line">2216</span><br><span class="line">2217</span><br><span class="line">2218</span><br><span class="line">2219</span><br><span class="line">2220</span><br><span class="line">2221</span><br><span class="line">2222</span><br><span class="line">2223</span><br><span class="line">2224</span><br><span class="line">2225</span><br><span class="line">2226</span><br><span class="line">2227</span><br><span class="line">2228</span><br><span class="line">2229</span><br><span class="line">2230</span><br><span class="line">2231</span><br><span class="line">2232</span><br><span class="line">2233</span><br><span class="line">2234</span><br><span class="line">2235</span><br><span class="line">2236</span><br><span class="line">2237</span><br><span class="line">2238</span><br><span class="line">2239</span><br><span class="line">2240</span><br><span class="line">2241</span><br><span class="line">2242</span><br><span class="line">2243</span><br><span class="line">2244</span><br><span class="line">2245</span><br><span class="line">2246</span><br><span class="line">2247</span><br><span class="line">2248</span><br><span class="line">2249</span><br><span class="line">2250</span><br><span class="line">2251</span><br><span class="line">2252</span><br><span class="line">2253</span><br><span class="line">2254</span><br><span class="line">2255</span><br><span class="line">2256</span><br><span class="line">2257</span><br><span class="line">2258</span><br><span class="line">2259</span><br><span class="line">2260</span><br><span class="line">2261</span><br><span class="line">2262</span><br><span class="line">2263</span><br><span class="line">2264</span><br><span class="line">2265</span><br><span class="line">2266</span><br><span class="line">2267</span><br><span class="line">2268</span><br><span class="line">2269</span><br><span class="line">2270</span><br><span class="line">2271</span><br><span class="line">2272</span><br><span class="line">2273</span><br><span class="line">2274</span><br><span class="line">2275</span><br><span class="line">2276</span><br><span class="line">2277</span><br><span class="line">2278</span><br><span class="line">2279</span><br><span class="line">2280</span><br><span class="line">2281</span><br><span class="line">2282</span><br><span class="line">2283</span><br><span class="line">2284</span><br><span class="line">2285</span><br><span class="line">2286</span><br><span class="line">2287</span><br><span class="line">2288</span><br><span class="line">2289</span><br><span class="line">2290</span><br><span class="line">2291</span><br><span class="line">2292</span><br><span class="line">2293</span><br><span class="line">2294</span><br><span class="line">2295</span><br><span class="line">2296</span><br><span class="line">2297</span><br><span class="line">2298</span><br><span class="line">2299</span><br><span class="line">2300</span><br><span class="line">2301</span><br><span class="line">2302</span><br><span class="line">2303</span><br><span class="line">2304</span><br><span class="line">2305</span><br><span class="line">2306</span><br><span class="line">2307</span><br><span class="line">2308</span><br><span class="line">2309</span><br><span class="line">2310</span><br><span class="line">2311</span><br><span class="line">2312</span><br><span class="line">2313</span><br><span class="line">2314</span><br><span class="line">2315</span><br><span class="line">2316</span><br><span class="line">2317</span><br><span class="line">2318</span><br><span class="line">2319</span><br><span class="line">2320</span><br><span class="line">2321</span><br><span class="line">2322</span><br><span class="line">2323</span><br><span class="line">2324</span><br><span class="line">2325</span><br><span class="line">2326</span><br><span class="line">2327</span><br><span class="line">2328</span><br><span class="line">2329</span><br><span class="line">2330</span><br><span class="line">2331</span><br><span class="line">2332</span><br><span class="line">2333</span><br><span class="line">2334</span><br><span class="line">2335</span><br><span class="line">2336</span><br><span class="line">2337</span><br><span class="line">2338</span><br><span class="line">2339</span><br><span class="line">2340</span><br><span class="line">2341</span><br><span class="line">2342</span><br><span class="line">2343</span><br><span class="line">2344</span><br><span class="line">2345</span><br><span class="line">2346</span><br><span class="line">2347</span><br><span class="line">2348</span><br><span class="line">2349</span><br><span class="line">2350</span><br><span class="line">2351</span><br><span class="line">2352</span><br><span class="line">2353</span><br><span class="line">2354</span><br><span class="line">2355</span><br><span class="line">2356</span><br><span class="line">2357</span><br><span class="line">2358</span><br><span class="line">2359</span><br><span class="line">2360</span><br><span class="line">2361</span><br><span class="line">2362</span><br><span class="line">2363</span><br><span class="line">2364</span><br><span class="line">2365</span><br><span class="line">2366</span><br><span class="line">2367</span><br><span class="line">2368</span><br><span class="line">2369</span><br><span class="line">2370</span><br><span class="line">2371</span><br><span class="line">2372</span><br><span class="line">2373</span><br><span class="line">2374</span><br><span class="line">2375</span><br><span class="line">2376</span><br><span class="line">2377</span><br><span class="line">2378</span><br><span class="line">2379</span><br><span class="line">2380</span><br><span class="line">2381</span><br><span class="line">2382</span><br><span class="line">2383</span><br><span class="line">2384</span><br><span class="line">2385</span><br><span class="line">2386</span><br><span class="line">2387</span><br><span class="line">2388</span><br><span class="line">2389</span><br><span class="line">2390</span><br><span class="line">2391</span><br><span class="line">2392</span><br><span class="line">2393</span><br><span class="line">2394</span><br><span class="line">2395</span><br><span class="line">2396</span><br><span class="line">2397</span><br><span class="line">2398</span><br><span class="line">2399</span><br><span class="line">2400</span><br><span class="line">2401</span><br><span class="line">2402</span><br><span class="line">2403</span><br><span class="line">2404</span><br><span class="line">2405</span><br><span class="line">2406</span><br><span class="line">2407</span><br><span class="line">2408</span><br><span class="line">2409</span><br><span class="line">2410</span><br><span class="line">2411</span><br><span class="line">2412</span><br><span class="line">2413</span><br><span class="line">2414</span><br><span class="line">2415</span><br><span class="line">2416</span><br><span class="line">2417</span><br><span class="line">2418</span><br><span class="line">2419</span><br><span class="line">2420</span><br><span class="line">2421</span><br><span class="line">2422</span><br><span class="line">2423</span><br><span class="line">2424</span><br><span class="line">2425</span><br><span class="line">2426</span><br><span class="line">2427</span><br><span class="line">2428</span><br><span class="line">2429</span><br><span class="line">2430</span><br><span class="line">2431</span><br><span class="line">2432</span><br><span class="line">2433</span><br><span class="line">2434</span><br><span class="line">2435</span><br><span class="line">2436</span><br><span class="line">2437</span><br><span class="line">2438</span><br><span class="line">2439</span><br><span class="line">2440</span><br><span class="line">2441</span><br><span class="line">2442</span><br><span class="line">2443</span><br><span class="line">2444</span><br><span class="line">2445</span><br><span class="line">2446</span><br><span class="line">2447</span><br><span class="line">2448</span><br><span class="line">2449</span><br><span class="line">2450</span><br><span class="line">2451</span><br><span class="line">2452</span><br><span class="line">2453</span><br><span class="line">2454</span><br><span class="line">2455</span><br><span class="line">2456</span><br><span class="line">2457</span><br><span class="line">2458</span><br><span class="line">2459</span><br><span class="line">2460</span><br><span class="line">2461</span><br><span class="line">2462</span><br><span class="line">2463</span><br><span class="line">2464</span><br><span class="line">2465</span><br><span class="line">2466</span><br><span class="line">2467</span><br><span class="line">2468</span><br><span class="line">2469</span><br><span class="line">2470</span><br><span class="line">2471</span><br><span class="line">2472</span><br><span class="line">2473</span><br><span class="line">2474</span><br><span class="line">2475</span><br><span class="line">2476</span><br><span class="line">2477</span><br><span class="line">2478</span><br><span class="line">2479</span><br><span class="line">2480</span><br><span class="line">2481</span><br><span class="line">2482</span><br><span class="line">2483</span><br><span class="line">2484</span><br><span class="line">2485</span><br><span class="line">2486</span><br><span class="line">2487</span><br><span class="line">2488</span><br><span class="line">2489</span><br><span class="line">2490</span><br><span class="line">2491</span><br><span class="line">2492</span><br><span class="line">2493</span><br><span class="line">2494</span><br><span class="line">2495</span><br><span class="line">2496</span><br><span class="line">2497</span><br><span class="line">2498</span><br><span class="line">2499</span><br><span class="line">2500</span><br><span class="line">2501</span><br><span class="line">2502</span><br><span class="line">2503</span><br><span class="line">2504</span><br><span class="line">2505</span><br><span class="line">2506</span><br><span class="line">2507</span><br><span class="line">2508</span><br><span class="line">2509</span><br><span class="line">2510</span><br><span class="line">2511</span><br><span class="line">2512</span><br><span class="line">2513</span><br><span class="line">2514</span><br><span class="line">2515</span><br><span class="line">2516</span><br><span class="line">2517</span><br><span class="line">2518</span><br><span class="line">2519</span><br><span class="line">2520</span><br><span class="line">2521</span><br><span class="line">2522</span><br><span class="line">2523</span><br><span class="line">2524</span><br><span class="line">2525</span><br><span class="line">2526</span><br><span class="line">2527</span><br><span class="line">2528</span><br><span class="line">2529</span><br><span class="line">2530</span><br><span class="line">2531</span><br><span class="line">2532</span><br><span class="line">2533</span><br><span class="line">2534</span><br><span class="line">2535</span><br><span class="line">2536</span><br><span class="line">2537</span><br><span class="line">2538</span><br><span class="line">2539</span><br><span class="line">2540</span><br><span class="line">2541</span><br><span class="line">2542</span><br><span class="line">2543</span><br><span class="line">2544</span><br><span class="line">2545</span><br><span class="line">2546</span><br><span class="line">2547</span><br><span class="line">2548</span><br><span class="line">2549</span><br><span class="line">2550</span><br><span class="line">2551</span><br><span class="line">2552</span><br><span class="line">2553</span><br><span class="line">2554</span><br><span class="line">2555</span><br><span class="line">2556</span><br><span class="line">2557</span><br><span class="line">2558</span><br><span class="line">2559</span><br><span class="line">2560</span><br><span class="line">2561</span><br><span class="line">2562</span><br><span class="line">2563</span><br><span class="line">2564</span><br><span class="line">2565</span><br><span class="line">2566</span><br><span class="line">2567</span><br><span class="line">2568</span><br><span class="line">2569</span><br><span class="line">2570</span><br><span class="line">2571</span><br><span class="line">2572</span><br><span class="line">2573</span><br><span class="line">2574</span><br><span class="line">2575</span><br><span class="line">2576</span><br><span class="line">2577</span><br><span class="line">2578</span><br><span class="line">2579</span><br><span class="line">2580</span><br><span class="line">2581</span><br><span class="line">2582</span><br><span class="line">2583</span><br><span class="line">2584</span><br><span class="line">2585</span><br><span class="line">2586</span><br><span class="line">2587</span><br><span class="line">2588</span><br><span class="line">2589</span><br><span class="line">2590</span><br><span class="line">2591</span><br><span class="line">2592</span><br><span class="line">2593</span><br><span class="line">2594</span><br><span class="line">2595</span><br><span class="line">2596</span><br><span class="line">2597</span><br><span class="line">2598</span><br><span class="line">2599</span><br><span class="line">2600</span><br><span class="line">2601</span><br><span class="line">2602</span><br><span class="line">2603</span><br><span class="line">2604</span><br><span class="line">2605</span><br><span class="line">2606</span><br><span class="line">2607</span><br><span class="line">2608</span><br><span class="line">2609</span><br><span class="line">2610</span><br><span class="line">2611</span><br><span class="line">2612</span><br><span class="line">2613</span><br><span class="line">2614</span><br><span class="line">2615</span><br><span class="line">2616</span><br><span class="line">2617</span><br><span class="line">2618</span><br><span class="line">2619</span><br><span class="line">2620</span><br><span class="line">2621</span><br><span class="line">2622</span><br><span class="line">2623</span><br><span class="line">2624</span><br><span class="line">2625</span><br><span class="line">2626</span><br><span class="line">2627</span><br><span class="line">2628</span><br><span class="line">2629</span><br><span class="line">2630</span><br><span class="line">2631</span><br><span class="line">2632</span><br><span class="line">2633</span><br><span class="line">2634</span><br><span class="line">2635</span><br><span class="line">2636</span><br><span class="line">2637</span><br><span class="line">2638</span><br><span class="line">2639</span><br><span class="line">2640</span><br><span class="line">2641</span><br><span class="line">2642</span><br><span class="line">2643</span><br><span class="line">2644</span><br><span class="line">2645</span><br><span class="line">2646</span><br><span class="line">2647</span><br><span class="line">2648</span><br><span class="line">2649</span><br><span class="line">2650</span><br><span class="line">2651</span><br><span class="line">2652</span><br><span class="line">2653</span><br><span class="line">2654</span><br><span class="line">2655</span><br><span class="line">2656</span><br><span class="line">2657</span><br><span class="line">2658</span><br><span class="line">2659</span><br><span class="line">2660</span><br><span class="line">2661</span><br><span class="line">2662</span><br><span class="line">2663</span><br><span class="line">2664</span><br><span class="line">2665</span><br><span class="line">2666</span><br><span class="line">2667</span><br><span class="line">2668</span><br><span class="line">2669</span><br><span class="line">2670</span><br><span class="line">2671</span><br><span class="line">2672</span><br><span class="line">2673</span><br><span class="line">2674</span><br><span class="line">2675</span><br><span class="line">2676</span><br><span class="line">2677</span><br><span class="line">2678</span><br><span class="line">2679</span><br><span class="line">2680</span><br><span class="line">2681</span><br><span class="line">2682</span><br><span class="line">2683</span><br><span class="line">2684</span><br><span class="line">2685</span><br><span class="line">2686</span><br><span class="line">2687</span><br><span class="line">2688</span><br><span class="line">2689</span><br><span class="line">2690</span><br><span class="line">2691</span><br><span class="line">2692</span><br><span class="line">2693</span><br><span class="line">2694</span><br><span class="line">2695</span><br><span class="line">2696</span><br><span class="line">2697</span><br><span class="line">2698</span><br><span class="line">2699</span><br><span class="line">2700</span><br><span class="line">2701</span><br><span class="line">2702</span><br><span class="line">2703</span><br><span class="line">2704</span><br><span class="line">2705</span><br><span class="line">2706</span><br><span class="line">2707</span><br><span class="line">2708</span><br><span class="line">2709</span><br><span class="line">2710</span><br><span class="line">2711</span><br><span class="line">2712</span><br><span class="line">2713</span><br><span class="line">2714</span><br><span class="line">2715</span><br><span class="line">2716</span><br><span class="line">2717</span><br><span class="line">2718</span><br><span class="line">2719</span><br><span class="line">2720</span><br><span class="line">2721</span><br><span class="line">2722</span><br><span class="line">2723</span><br><span class="line">2724</span><br><span class="line">2725</span><br><span class="line">2726</span><br><span class="line">2727</span><br><span class="line">2728</span><br><span class="line">2729</span><br><span class="line">2730</span><br><span class="line">2731</span><br><span class="line">2732</span><br><span class="line">2733</span><br><span class="line">2734</span><br><span class="line">2735</span><br><span class="line">2736</span><br><span class="line">2737</span><br><span class="line">2738</span><br><span class="line">2739</span><br><span class="line">2740</span><br><span class="line">2741</span><br><span class="line">2742</span><br><span class="line">2743</span><br><span class="line">2744</span><br><span class="line">2745</span><br><span class="line">2746</span><br><span class="line">2747</span><br><span class="line">2748</span><br><span class="line">2749</span><br><span class="line">2750</span><br><span class="line">2751</span><br><span class="line">2752</span><br><span class="line">2753</span><br><span class="line">2754</span><br><span class="line">2755</span><br><span class="line">2756</span><br><span class="line">2757</span><br><span class="line">2758</span><br><span class="line">2759</span><br><span class="line">2760</span><br><span class="line">2761</span><br><span class="line">2762</span><br><span class="line">2763</span><br><span class="line">2764</span><br><span class="line">2765</span><br><span class="line">2766</span><br><span class="line">2767</span><br><span class="line">2768</span><br><span class="line">2769</span><br><span class="line">2770</span><br><span class="line">2771</span><br><span class="line">2772</span><br><span class="line">2773</span><br><span class="line">2774</span><br><span class="line">2775</span><br><span class="line">2776</span><br><span class="line">2777</span><br><span class="line">2778</span><br><span class="line">2779</span><br><span class="line">2780</span><br><span class="line">2781</span><br><span class="line">2782</span><br><span class="line">2783</span><br><span class="line">2784</span><br><span class="line">2785</span><br><span class="line">2786</span><br><span class="line">2787</span><br><span class="line">2788</span><br><span class="line">2789</span><br><span class="line">2790</span><br><span class="line">2791</span><br><span class="line">2792</span><br><span class="line">2793</span><br><span class="line">2794</span><br><span class="line">2795</span><br><span class="line">2796</span><br><span class="line">2797</span><br><span class="line">2798</span><br><span class="line">2799</span><br><span class="line">2800</span><br><span class="line">2801</span><br><span class="line">2802</span><br><span class="line">2803</span><br><span class="line">2804</span><br><span class="line">2805</span><br><span class="line">2806</span><br><span class="line">2807</span><br><span class="line">2808</span><br><span class="line">2809</span><br><span class="line">2810</span><br><span class="line">2811</span><br><span class="line">2812</span><br><span class="line">2813</span><br><span class="line">2814</span><br><span class="line">2815</span><br><span class="line">2816</span><br><span class="line">2817</span><br><span class="line">2818</span><br><span class="line">2819</span><br><span class="line">2820</span><br><span class="line">2821</span><br><span class="line">2822</span><br><span class="line">2823</span><br><span class="line">2824</span><br><span class="line">2825</span><br><span class="line">2826</span><br><span class="line">2827</span><br><span class="line">2828</span><br><span class="line">2829</span><br><span class="line">2830</span><br><span class="line">2831</span><br><span class="line">2832</span><br><span class="line">2833</span><br><span class="line">2834</span><br><span class="line">2835</span><br><span class="line">2836</span><br><span class="line">2837</span><br><span class="line">2838</span><br><span class="line">2839</span><br><span class="line">2840</span><br><span class="line">2841</span><br><span class="line">2842</span><br><span class="line">2843</span><br><span class="line">2844</span><br><span class="line">2845</span><br><span class="line">2846</span><br><span class="line">2847</span><br><span class="line">2848</span><br><span class="line">2849</span><br><span class="line">2850</span><br><span class="line">2851</span><br><span class="line">2852</span><br><span class="line">2853</span><br><span class="line">2854</span><br><span class="line">2855</span><br><span class="line">2856</span><br><span class="line">2857</span><br><span class="line">2858</span><br><span class="line">2859</span><br><span class="line">2860</span><br><span class="line">2861</span><br><span class="line">2862</span><br><span class="line">2863</span><br><span class="line">2864</span><br><span class="line">2865</span><br><span class="line">2866</span><br><span class="line">2867</span><br><span class="line">2868</span><br><span class="line">2869</span><br><span class="line">2870</span><br><span class="line">2871</span><br><span class="line">2872</span><br><span class="line">2873</span><br><span class="line">2874</span><br><span class="line">2875</span><br><span class="line">2876</span><br><span class="line">2877</span><br><span class="line">2878</span><br><span class="line">2879</span><br><span class="line">2880</span><br><span class="line">2881</span><br><span class="line">2882</span><br><span class="line">2883</span><br><span class="line">2884</span><br><span class="line">2885</span><br><span class="line">2886</span><br><span class="line">2887</span><br><span class="line">2888</span><br><span class="line">2889</span><br><span class="line">2890</span><br><span class="line">2891</span><br><span class="line">2892</span><br><span class="line">2893</span><br><span class="line">2894</span><br><span class="line">2895</span><br><span class="line">2896</span><br><span class="line">2897</span><br><span class="line">2898</span><br><span class="line">2899</span><br><span class="line">2900</span><br><span class="line">2901</span><br><span class="line">2902</span><br><span class="line">2903</span><br><span class="line">2904</span><br><span class="line">2905</span><br><span class="line">2906</span><br><span class="line">2907</span><br><span class="line">2908</span><br><span class="line">2909</span><br><span class="line">2910</span><br><span class="line">2911</span><br><span class="line">2912</span><br><span class="line">2913</span><br><span class="line">2914</span><br><span class="line">2915</span><br><span class="line">2916</span><br><span class="line">2917</span><br><span class="line">2918</span><br><span class="line">2919</span><br><span class="line">2920</span><br><span class="line">2921</span><br><span class="line">2922</span><br><span class="line">2923</span><br><span class="line">2924</span><br><span class="line">2925</span><br><span class="line">2926</span><br><span class="line">2927</span><br><span class="line">2928</span><br><span class="line">2929</span><br><span class="line">2930</span><br><span class="line">2931</span><br><span class="line">2932</span><br><span class="line">2933</span><br><span class="line">2934</span><br><span class="line">2935</span><br><span class="line">2936</span><br><span class="line">2937</span><br><span class="line">2938</span><br><span class="line">2939</span><br><span class="line">2940</span><br><span class="line">2941</span><br><span class="line">2942</span><br><span class="line">2943</span><br><span class="line">2944</span><br><span class="line">2945</span><br><span class="line">2946</span><br><span class="line">2947</span><br><span class="line">2948</span><br><span class="line">2949</span><br><span class="line">2950</span><br><span class="line">2951</span><br><span class="line">2952</span><br><span class="line">2953</span><br><span class="line">2954</span><br><span class="line">2955</span><br><span class="line">2956</span><br><span class="line">2957</span><br><span class="line">2958</span><br><span class="line">2959</span><br><span class="line">2960</span><br><span class="line">2961</span><br><span class="line">2962</span><br><span class="line">2963</span><br><span class="line">2964</span><br><span class="line">2965</span><br><span class="line">2966</span><br><span class="line">2967</span><br><span class="line">2968</span><br><span class="line">2969</span><br><span class="line">2970</span><br><span class="line">2971</span><br><span class="line">2972</span><br><span class="line">2973</span><br><span class="line">2974</span><br><span class="line">2975</span><br><span class="line">2976</span><br><span class="line">2977</span><br><span class="line">2978</span><br><span class="line">2979</span><br><span class="line">2980</span><br><span class="line">2981</span><br><span class="line">2982</span><br><span class="line">2983</span><br><span class="line">2984</span><br><span class="line">2985</span><br><span class="line">2986</span><br><span class="line">2987</span><br><span class="line">2988</span><br><span class="line">2989</span><br><span class="line">2990</span><br><span class="line">2991</span><br><span class="line">2992</span><br><span class="line">2993</span><br><span class="line">2994</span><br><span class="line">2995</span><br><span class="line">2996</span><br><span class="line">2997</span><br><span class="line">2998</span><br><span class="line">2999</span><br><span class="line">3000</span><br><span class="line">3001</span><br><span class="line">3002</span><br><span class="line">3003</span><br><span class="line">3004</span><br><span class="line">3005</span><br><span class="line">3006</span><br><span class="line">3007</span><br><span class="line">3008</span><br><span class="line">3009</span><br><span class="line">3010</span><br><span class="line">3011</span><br><span class="line">3012</span><br><span class="line">3013</span><br><span class="line">3014</span><br><span class="line">3015</span><br><span class="line">3016</span><br><span class="line">3017</span><br><span class="line">3018</span><br><span class="line">3019</span><br><span class="line">3020</span><br><span class="line">3021</span><br><span class="line">3022</span><br><span class="line">3023</span><br><span class="line">3024</span><br><span class="line">3025</span><br><span class="line">3026</span><br><span class="line">3027</span><br><span class="line">3028</span><br><span class="line">3029</span><br><span class="line">3030</span><br><span class="line">3031</span><br><span class="line">3032</span><br><span class="line">3033</span><br><span class="line">3034</span><br><span class="line">3035</span><br><span class="line">3036</span><br><span class="line">3037</span><br><span class="line">3038</span><br><span class="line">3039</span><br><span class="line">3040</span><br><span class="line">3041</span><br><span class="line">3042</span><br><span class="line">3043</span><br><span class="line">3044</span><br><span class="line">3045</span><br><span class="line">3046</span><br><span class="line">3047</span><br><span class="line">3048</span><br><span class="line">3049</span><br><span class="line">3050</span><br><span class="line">3051</span><br><span class="line">3052</span><br><span class="line">3053</span><br><span class="line">3054</span><br><span class="line">3055</span><br><span class="line">3056</span><br><span class="line">3057</span><br><span class="line">3058</span><br><span class="line">3059</span><br><span class="line">3060</span><br><span class="line">3061</span><br><span class="line">3062</span><br><span class="line">3063</span><br><span class="line">3064</span><br><span class="line">3065</span><br><span class="line">3066</span><br><span class="line">3067</span><br><span class="line">3068</span><br><span class="line">3069</span><br><span class="line">3070</span><br><span class="line">3071</span><br><span class="line">3072</span><br><span class="line">3073</span><br><span class="line">3074</span><br><span class="line">3075</span><br><span class="line">3076</span><br><span class="line">3077</span><br><span class="line">3078</span><br><span class="line">3079</span><br><span class="line">3080</span><br><span class="line">3081</span><br><span class="line">3082</span><br><span class="line">3083</span><br><span class="line">3084</span><br><span class="line">3085</span><br><span class="line">3086</span><br><span class="line">3087</span><br><span class="line">3088</span><br><span class="line">3089</span><br><span class="line">3090</span><br><span class="line">3091</span><br><span class="line">3092</span><br><span class="line">3093</span><br><span class="line">3094</span><br><span class="line">3095</span><br><span class="line">3096</span><br><span class="line">3097</span><br><span class="line">3098</span><br><span class="line">3099</span><br><span class="line">3100</span><br><span class="line">3101</span><br><span class="line">3102</span><br><span class="line">3103</span><br><span class="line">3104</span><br><span class="line">3105</span><br><span class="line">3106</span><br><span class="line">3107</span><br><span class="line">3108</span><br><span class="line">3109</span><br><span class="line">3110</span><br><span class="line">3111</span><br><span class="line">3112</span><br><span class="line">3113</span><br><span class="line">3114</span><br><span class="line">3115</span><br><span class="line">3116</span><br><span class="line">3117</span><br><span class="line">3118</span><br><span class="line">3119</span><br><span class="line">3120</span><br><span class="line">3121</span><br><span class="line">3122</span><br><span class="line">3123</span><br><span class="line">3124</span><br><span class="line">3125</span><br><span class="line">3126</span><br><span class="line">3127</span><br><span class="line">3128</span><br><span class="line">3129</span><br><span class="line">3130</span><br><span class="line">3131</span><br><span class="line">3132</span><br><span class="line">3133</span><br><span class="line">3134</span><br><span class="line">3135</span><br><span class="line">3136</span><br><span class="line">3137</span><br><span class="line">3138</span><br><span class="line">3139</span><br><span class="line">3140</span><br><span class="line">3141</span><br><span class="line">3142</span><br><span class="line">3143</span><br><span class="line">3144</span><br><span class="line">3145</span><br><span class="line">3146</span><br><span class="line">3147</span><br><span class="line">3148</span><br><span class="line">3149</span><br><span class="line">3150</span><br><span class="line">3151</span><br><span class="line">3152</span><br><span class="line">3153</span><br><span class="line">3154</span><br><span class="line">3155</span><br><span class="line">3156</span><br><span class="line">3157</span><br><span class="line">3158</span><br><span class="line">3159</span><br><span class="line">3160</span><br><span class="line">3161</span><br><span class="line">3162</span><br><span class="line">3163</span><br><span class="line">3164</span><br><span class="line">3165</span><br><span class="line">3166</span><br><span class="line">3167</span><br><span class="line">3168</span><br><span class="line">3169</span><br><span class="line">3170</span><br><span class="line">3171</span><br><span class="line">3172</span><br><span class="line">3173</span><br><span class="line">3174</span><br><span class="line">3175</span><br><span class="line">3176</span><br><span class="line">3177</span><br><span class="line">3178</span><br><span class="line">3179</span><br><span class="line">3180</span><br><span class="line">3181</span><br><span class="line">3182</span><br><span class="line">3183</span><br><span class="line">3184</span><br><span class="line">3185</span><br><span class="line">3186</span><br><span class="line">3187</span><br><span class="line">3188</span><br><span class="line">3189</span><br><span class="line">3190</span><br><span class="line">3191</span><br><span class="line">3192</span><br><span class="line">3193</span><br><span class="line">3194</span><br><span class="line">3195</span><br><span class="line">3196</span><br><span class="line">3197</span><br><span class="line">3198</span><br><span class="line">3199</span><br><span class="line">3200</span><br><span class="line">3201</span><br><span class="line">3202</span><br><span class="line">3203</span><br><span class="line">3204</span><br><span class="line">3205</span><br><span class="line">3206</span><br><span class="line">3207</span><br><span class="line">3208</span><br><span class="line">3209</span><br><span class="line">3210</span><br><span class="line">3211</span><br><span class="line">3212</span><br><span class="line">3213</span><br><span class="line">3214</span><br><span class="line">3215</span><br><span class="line">3216</span><br><span class="line">3217</span><br><span class="line">3218</span><br><span class="line">3219</span><br><span class="line">3220</span><br><span class="line">3221</span><br><span class="line">3222</span><br><span class="line">3223</span><br><span class="line">3224</span><br><span class="line">3225</span><br><span class="line">3226</span><br><span class="line">3227</span><br><span class="line">3228</span><br><span class="line">3229</span><br><span class="line">3230</span><br><span class="line">3231</span><br><span class="line">3232</span><br><span class="line">3233</span><br><span class="line">3234</span><br><span class="line">3235</span><br><span class="line">3236</span><br><span class="line">3237</span><br><span class="line">3238</span><br><span class="line">3239</span><br><span class="line">3240</span><br><span class="line">3241</span><br><span class="line">3242</span><br><span class="line">3243</span><br><span class="line">3244</span><br><span class="line">3245</span><br><span class="line">3246</span><br><span class="line">3247</span><br><span class="line">3248</span><br><span class="line">3249</span><br><span class="line">3250</span><br><span class="line">3251</span><br><span class="line">3252</span><br><span class="line">3253</span><br><span class="line">3254</span><br><span class="line">3255</span><br><span class="line">3256</span><br><span class="line">3257</span><br><span class="line">3258</span><br><span class="line">3259</span><br><span class="line">3260</span><br><span class="line">3261</span><br><span class="line">3262</span><br><span class="line">3263</span><br><span class="line">3264</span><br><span class="line">3265</span><br><span class="line">3266</span><br><span class="line">3267</span><br><span class="line">3268</span><br><span class="line">3269</span><br><span class="line">3270</span><br><span class="line">3271</span><br><span class="line">3272</span><br><span class="line">3273</span><br><span class="line">3274</span><br><span class="line">3275</span><br><span class="line">3276</span><br><span class="line">3277</span><br><span class="line">3278</span><br><span class="line">3279</span><br><span class="line">3280</span><br><span class="line">3281</span><br><span class="line">3282</span><br><span class="line">3283</span><br><span class="line">3284</span><br><span class="line">3285</span><br><span class="line">3286</span><br><span class="line">3287</span><br><span class="line">3288</span><br><span class="line">3289</span><br><span class="line">3290</span><br><span class="line">3291</span><br><span class="line">3292</span><br><span class="line">3293</span><br><span class="line">3294</span><br><span class="line">3295</span><br><span class="line">3296</span><br><span class="line">3297</span><br><span class="line">3298</span><br><span class="line">3299</span><br><span class="line">3300</span><br><span class="line">3301</span><br><span class="line">3302</span><br><span class="line">3303</span><br><span class="line">3304</span><br><span class="line">3305</span><br><span class="line">3306</span><br><span class="line">3307</span><br><span class="line">3308</span><br><span class="line">3309</span><br><span class="line">3310</span><br><span class="line">3311</span><br><span class="line">3312</span><br><span class="line">3313</span><br><span class="line">3314</span><br><span class="line">3315</span><br><span class="line">3316</span><br><span class="line">3317</span><br><span class="line">3318</span><br><span class="line">3319</span><br><span class="line">3320</span><br><span class="line">3321</span><br><span class="line">3322</span><br><span class="line">3323</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*!</span></span><br><span class="line"><span class="comment"> * Vue.js v2.6.11</span></span><br><span class="line"><span class="comment"> * (c) 2014-2019 Evan You</span></span><br><span class="line"><span class="comment"> * Released under the MIT License.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// init</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">global, factory</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">typeof</span> exports === <span class="string">'object'</span> &amp;&amp; <span class="keyword">typeof</span> <span class="built_in">module</span> !== <span class="string">'undefined'</span> ? <span class="built_in">module</span>.exports = factory() :</span><br><span class="line">    <span class="keyword">typeof</span> define === <span class="string">'function'</span> &amp;&amp; define.amd ? define(factory) :</span><br><span class="line">    (global = global || self, global.Vue = factory());</span><br><span class="line">  &#125;(<span class="keyword">this</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="string">'use strict'</span>;</span><br><span class="line">    <span class="comment">/*  if (typeof exports === 'object' &amp;&amp; typeof module !== 'undefined') &#123;  // 检查 CommonJS  即 CJS</span></span><br><span class="line"><span class="comment">            module.exports = factory()</span></span><br><span class="line"><span class="comment">        &#125; else &#123;</span></span><br><span class="line"><span class="comment">            if (typeof define === 'function' &amp;&amp; define.amd) &#123; // AMD 异步模块定义 检查 JavaScript 管理库 require.js 的存在  即检查 AJS, 这两种检查都是 JS 的模块化管理 (在 ES6 的 import 和 export 出现之前已经非常流行)</span></span><br><span class="line"><span class="comment">                define(factory)</span></span><br><span class="line"><span class="comment">            &#125; else &#123;</span></span><br><span class="line"><span class="comment">                global = global || self</span></span><br><span class="line"><span class="comment">                global.Vue = factory()</span></span><br><span class="line"><span class="comment">            &#125;</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">        从一个 ( 开始的 (第8行)一整个立即执行函数, 相当于 Window.Vue = factory()</span></span><br><span class="line"><span class="comment">        factory() 是从第 12 行开始的匿名函数(this, 之后的这个), 该匿名函数没有自执行, 设计参数 Window, 并传入 Window 对象, 不污染全局环境, 也不会被别的代码污染</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="comment">/* 核心代码开始 */</span></span><br><span class="line">  </span><br><span class="line">    <span class="comment">// 冻结 &#123;&#125; 这个空对象并赋值给 emptyObject, 这个对象上无法进行修改与添加</span></span><br><span class="line">    <span class="keyword">var</span> emptyObject = <span class="built_in">Object</span>.freeze(&#123;&#125;);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// These helpers produce better VM code in JS engines due to their</span></span><br><span class="line">    <span class="comment">// explicitness and function inlining.</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 工具代码，方便之后的代码的语义化，看到函数名直接知道这个函数做了什么，而不再是根据 === 来判断函数到底在干什么</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* 判断是否为 undefined */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">isUndef</span> (<span class="params">v</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> v === <span class="literal">undefined</span> || v === <span class="literal">null</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/* 判断是否已被赋值 */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">isDef</span> (<span class="params">v</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> v !== <span class="literal">undefined</span> &amp;&amp; v !== <span class="literal">null</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/* 判断是否为 true */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">isTrue</span> (<span class="params">v</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> v === <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/* 判断是否为 false */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">isFalse</span> (<span class="params">v</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> v === <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Check if value is primitive.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/* 判断是否为原始类型</span></span><br><span class="line"><span class="comment">   JS 中有 string, number, symbol, boolean 四种原始类型 */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">isPrimitive</span> (<span class="params">value</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> (</span><br><span class="line">        <span class="keyword">typeof</span> value === <span class="string">'string'</span> ||</span><br><span class="line">        <span class="keyword">typeof</span> value === <span class="string">'number'</span> ||</span><br><span class="line">        <span class="comment">// $flow-disable-line</span></span><br><span class="line">        <span class="keyword">typeof</span> value === <span class="string">'symbol'</span> ||</span><br><span class="line">        <span class="keyword">typeof</span> value === <span class="string">'boolean'</span></span><br><span class="line">      )</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Quick object check - this is primarily used to tell</span></span><br><span class="line"><span class="comment">     * Objects from primitive values when we know the value</span></span><br><span class="line"><span class="comment">     * is a JSON-compliant type.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/* 判断对象是否有值, null 将返回 false */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">isObject</span> (<span class="params">obj</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> obj !== <span class="literal">null</span> &amp;&amp; <span class="keyword">typeof</span> obj === <span class="string">'object'</span></span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Get the raw type string of a value, e.g., [object Object].</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/* 判断值的类型, 我们一般用的都是 Object.prototype.toString.call(value), 把这个方法给 _toString */</span></span><br><span class="line">    <span class="keyword">var</span> _toString = <span class="built_in">Object</span>.prototype.toString;</span><br><span class="line">    <span class="comment">/* 切割 _toString 的返回值, 如 [object String] 提取出 String 并返回 */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">toRawType</span> (<span class="params">value</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> _toString.call(value).slice(<span class="number">8</span>, <span class="number">-1</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Strict object type check. Only returns true</span></span><br><span class="line"><span class="comment">     * for plain JavaScript objects.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/* 判断是否为普通对象, 因为 JS 中一切都可以被当作对象, 数字是 Number 对象, 字符串是 String 对象, 这个函数判断是否为纯粹的 Object 对象, 这种对象通过 &#123;&#125; (即字面量创建) 或 new Object() 或 Object.create(null) 创建, Object.create(null), 以 null 为原型创建对象 */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">isPlainObject</span> (<span class="params">obj</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> _toString.call(obj) === <span class="string">'[object Object]'</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/* 判断是否为正则对象 RegExp 原生引用类型 */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">isRegExp</span> (<span class="params">v</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> _toString.call(v) === <span class="string">'[object RegExp]'</span></span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Check if val is a valid array index.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/* 判断 val 是否为有效的数组索引, 必须为正数, 非无穷, 而且为整数, 连起来就是 非无穷的正整数 */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">isValidArrayIndex</span> (<span class="params">val</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> n = <span class="built_in">parseFloat</span>(<span class="built_in">String</span>(val));</span><br><span class="line">      <span class="keyword">return</span> n &gt;= <span class="number">0</span> &amp;&amp; <span class="built_in">Math</span>.floor(n) === n &amp;&amp; <span class="built_in">isFinite</span>(val)</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/* 判断是否为 Promise 对象, 先判断 val 是否被赋值, 再看看 val 上是否有 then 和 catch 方法 */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">isPromise</span> (<span class="params">val</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> (</span><br><span class="line">        isDef(val) &amp;&amp;</span><br><span class="line">        <span class="keyword">typeof</span> val.then === <span class="string">'function'</span> &amp;&amp;</span><br><span class="line">        <span class="keyword">typeof</span> val.catch === <span class="string">'function'</span></span><br><span class="line">      )</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Convert a value to a string that is actually rendered.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/* 自定义了一个 toString 方法, 先判断是否为 空值, 如果不是, 判断是否为数组或是纯粹对象, 如果是就调用 JSON.stringify 来转换为字符串, 否则就直接 String() 转换为字符串, 如 字符串、数值、函数等, 都会把自己的内容直接打印出来, 不需要做转换 </span></span><br><span class="line"><span class="comment">    JSON.stringify(val, null, 2) , 第二个参数如果是函数, 则每个 val 的每个属性都会经过该函数的转化和处理, 如果第二个参数是数组, 只有包含在这个数组中的属性名才会被序列化到最终的 JSON 字符串中, 如果第二个参数为 null 或未提供, 则 val 的全部属性都被序列化,</span></span><br><span class="line"><span class="comment">    第三个参数指定缩进用的空格, 默认为 0, 上限为 10, 也可以传入字符串, 将会把字符串的长度作为值</span></span><br><span class="line"><span class="comment">    例如: JSON.stringify([123], null, 0) 转换后</span></span><br><span class="line"><span class="comment">    [123]</span></span><br><span class="line"><span class="comment">    JSON.stringify([123], null, 1) 转换后</span></span><br><span class="line"><span class="comment">    [</span></span><br><span class="line"><span class="comment">     123</span></span><br><span class="line"><span class="comment">    ] </span></span><br><span class="line"><span class="comment">    JSON.stringify([123], null, 2) 转换后 </span></span><br><span class="line"><span class="comment">    [</span></span><br><span class="line"><span class="comment">      123</span></span><br><span class="line"><span class="comment">    ]</span></span><br><span class="line"><span class="comment">    只要不为 0, 默认前后加上换行符</span></span><br><span class="line"><span class="comment">    MDN 地址: https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">toString</span> (<span class="params">val</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> val == <span class="literal">null</span></span><br><span class="line">        ? <span class="string">''</span></span><br><span class="line">        : <span class="built_in">Array</span>.isArray(val) || (isPlainObject(val) &amp;&amp; val.toString === _toString)</span><br><span class="line">          ? <span class="built_in">JSON</span>.stringify(val, <span class="literal">null</span>, <span class="number">2</span>)</span><br><span class="line">          : <span class="built_in">String</span>(val)</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Convert an input value to a number for persistence.</span></span><br><span class="line"><span class="comment">     * If the conversion fails, return original string.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/* 转换成 Number, 先转换成浮点数, 判断一下是否为NaN, 是就返回 NaN, 否则返回转换后的数值, 感觉好像 return 的这个判断没有什么意义。。直接 return n 好像效果一致</span></span><br><span class="line"><span class="comment">    本身的注释好像写了，如果转换失败，返回原始值, 但这个什么时候才会转换失败啊。感觉除了 NaN 和数值就不会有别的值了。</span></span><br><span class="line"><span class="comment">    不过还是写一下, 注意 isNaN(undefined) 是 true</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">toNumber</span> (<span class="params">val</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> n = <span class="built_in">parseFloat</span>(val);</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">isNaN</span>(n) ? val : n</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Make a map and return a function for checking if a key</span></span><br><span class="line"><span class="comment">     * is in that map.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/* 英文翻译是 制作一个映射并返回一个函数用于检测一个键是否在该映射中</span></span><br><span class="line"><span class="comment">    1.创建一个空对象</span></span><br><span class="line"><span class="comment">    2.把传入的要检测的键名(字符串类型)以 , 分割成数组</span></span><br><span class="line"><span class="comment">    3.循环这个数组并将其放入创建的空对象(映射)中, 并将其值设为 true</span></span><br><span class="line"><span class="comment">    4.判断是否传入了检测小写的要求, 如果要求小写, 则返回一个函数, 这个返回的函数会自动将传入的值变为小写, 再检测这个映射中是否有被传入的值同名的键(小写的), 如果不要求小写, 返回的函数就不会自动将传入的值变为小写</span></span><br><span class="line"><span class="comment">    5. 返回的函数被调用时, 如果 map 中有对应的键名, 就返回 true, 否则返回 undefined</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">makeMap</span> (<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">      str,</span></span></span><br><span class="line"><span class="function"><span class="params">      expectsLowerCase</span></span></span><br><span class="line"><span class="function"><span class="params">    </span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> map = <span class="built_in">Object</span>.create(<span class="literal">null</span>);</span><br><span class="line">      <span class="keyword">var</span> list = str.split(<span class="string">','</span>);</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; list.length; i++) &#123;</span><br><span class="line">        map[list[i]] = <span class="literal">true</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> expectsLowerCase</span><br><span class="line">        ? <span class="function"><span class="keyword">function</span> (<span class="params">val</span>) </span>&#123; <span class="keyword">return</span> map[val.toLowerCase()]; &#125;</span><br><span class="line">        : <span class="function"><span class="keyword">function</span> (<span class="params">val</span>) </span>&#123; <span class="keyword">return</span> map[val]; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Check if a tag is a built-in tag.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">        创建一个函数用于判断传入的标记是否为内置标签  到时候 config 中 isReservedTag 大概会用到</span></span><br><span class="line"><span class="comment">        isBuiltInTag(val) 返回值为 true 或 undefined, 这样调用时会返回这个 map 中是否有 val 这个键名 ? 应该是为了防止命名冲突, 现在这个 map 中有 slot 和 component 两个键名</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">var</span> isBuiltInTag = makeMap(<span class="string">'slot,component'</span>, <span class="literal">true</span>);</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Check if an attribute is a reserved attribute.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/* 创建一个函数用于判断传入的属性是否为保留属性</span></span><br><span class="line"><span class="comment">        isReservedAttribute(val) 返回值为 true 或 undefined, 这样调用时会返回这个 map 中是否有 val 这个键名, 同上, 应该也是为了方式命名冲突, 现在这个 map 中有 key, ref, slot, slot-scope, is 五个键名</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">var</span> isReservedAttribute = makeMap(<span class="string">'key,ref,slot,slot-scope,is'</span>);</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Remove an item from an array.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/* 移除数组中的某项, 先判断如果数组有长度, 获取要删除项的索引, 如果该项存在于该数组中, 用 splice 删掉它 */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">remove</span> (<span class="params">arr, item</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (arr.length) &#123;</span><br><span class="line">        <span class="keyword">var</span> index = arr.indexOf(item);</span><br><span class="line">        <span class="keyword">if</span> (index &gt; <span class="number">-1</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> arr.splice(index, <span class="number">1</span>)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Check whether an object has the property.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/* 自定义了 hasOwnProperty 方法, 和上面自定义的 toString 方法一样, 都是为了写起来更方便吧。。</span></span><br><span class="line"><span class="comment">    然后它们都是 调用了 Object.prototype 上的方法</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">var</span> hasOwnProperty = <span class="built_in">Object</span>.prototype.hasOwnProperty;</span><br><span class="line">    <span class="comment">/* 判断一个对象本身是否有这个属性, 如果有, 就返回 true, 如果没有, 就返回 false, 即使它的原型链上能找到这个属性 */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">hasOwn</span> (<span class="params">obj, key</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> hasOwnProperty.call(obj, key)</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Create a cached version of a pure function.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/*  柯里化 高级函数</span></span><br><span class="line"><span class="comment">        创建了一个用于创建函数的纯函数模板</span></span><br><span class="line"><span class="comment">        先创建一个空对象，用于保存之后要用到的函数</span></span><br><span class="line"><span class="comment">        返回一个函数, 同时闭包中保留 cache 作为缓存, 调用这个函数时, 如果被传入这个函数的值的名字在上面的空对象上定义了, 那么就返回这个空对象上的值, 如果没有, 把一开始传入的函数执行一次, 把返回值放到这个空对象上, 名字为传入的 str</span></span><br><span class="line"><span class="comment">        其实就是在 cache 对象上保存了一堆函数执行后的结果</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">cached</span> (<span class="params">fn</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> cache = <span class="built_in">Object</span>.create(<span class="literal">null</span>);</span><br><span class="line">      <span class="keyword">return</span> (<span class="function"><span class="keyword">function</span> <span class="title">cachedFn</span> (<span class="params">str</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> hit = cache[str];</span><br><span class="line">        <span class="keyword">return</span> hit || (cache[str] = fn(str))</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Camelize a hyphen-delimited string.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/* 传入的字符串如果有连字符 - , 把它删了并且改成驼峰命名, 内层匿名函数 return 的值将会替换 _ 匹配到的内容 */</span></span><br><span class="line">    <span class="keyword">var</span> camelizeRE = <span class="regexp">/-(\w)/g</span>;</span><br><span class="line">    <span class="keyword">var</span> camelize = cached(<span class="function"><span class="keyword">function</span> (<span class="params">str</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> str.replace(camelizeRE, <span class="function"><span class="keyword">function</span> (<span class="params">_, c</span>) </span>&#123; <span class="keyword">return</span> c ? c.toUpperCase() : <span class="string">''</span>; &#125;)</span><br><span class="line">    &#125;);</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Capitalize a string.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/* 把字符串首字母变成大写 */</span></span><br><span class="line">    <span class="keyword">var</span> capitalize = cached(<span class="function"><span class="keyword">function</span> (<span class="params">str</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> str.charAt(<span class="number">0</span>).toUpperCase() + str.slice(<span class="number">1</span>)</span><br><span class="line">    &#125;);</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Hyphenate a camelCase string.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/* \b 表示匹配单词之间的空白或者 - 之类的打断字符的位置，注意是位置，比如 'a b'.replace(/\b/g, '-') 返回的是 '-a- -b-', a的前后都不是字符，匹配成功, b的前后也都不是字符, 匹配成功</span></span><br><span class="line"><span class="comment">    而 \B 则表示匹配连着的两个字符的位置。如 /\B/.test('ab') 返回 true </span></span><br><span class="line"><span class="comment">    那么下面的 /\B([A-Z])/g 意思就是匹配驼峰命名的位置，如 'myValue' 将会被匹配 y(V) ，于是接下来就会被替换成 '-$1' , $1 表示捕获组 1, 就是括号中的内容, 这里是 v 就会被替换成 'my-Value' 再转小写，变成 'my-value'，完成驼峰命名到 - 连接符的转换</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">var</span> hyphenateRE = <span class="regexp">/\B([A-Z])/g</span>;</span><br><span class="line">    <span class="keyword">var</span> hyphenate = cached(<span class="function"><span class="keyword">function</span> (<span class="params">str</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> str.replace(hyphenateRE, <span class="string">'-$1'</span>).toLowerCase()</span><br><span class="line">    &#125;);</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Simple bind polyfill for environments that do not support it,</span></span><br><span class="line"><span class="comment">     * e.g., PhantomJS 1.x. Technically, we don't need this anymore</span></span><br><span class="line"><span class="comment">     * since native bind is now performant enough in most browsers.</span></span><br><span class="line"><span class="comment">     * But removing it would mean breaking code that was able to run in</span></span><br><span class="line"><span class="comment">     * PhantomJS 1.x, so this must be kept for backward compatibility.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/* 整个 polyfillBind 函数的作用是 bind 的兼容写法, 主要是为了一些没有原生 bind 的环境, 比如 PhantomJS 1.x, 这个环境不支持原生的 bind */</span></span><br><span class="line">    <span class="comment">/* istanbul ignore next */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">polyfillBind</span> (<span class="params">fn, ctx</span>) </span>&#123;</span><br><span class="line">          <span class="comment">/* 高级函数, 用于绑定函数作用域, 作用同 bind, 闭包保存了被存入的作用域和要执行函数, 返回一个已经修改了作用域的函数 */</span></span><br><span class="line">      <span class="function"><span class="keyword">function</span> <span class="title">boundFn</span> (<span class="params">a</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> l = <span class="built_in">arguments</span>.length;</span><br><span class="line">        <span class="keyword">return</span> l</span><br><span class="line">          ? l &gt; <span class="number">1</span></span><br><span class="line">            ? fn.apply(ctx, <span class="built_in">arguments</span>)</span><br><span class="line">            : fn.call(ctx, a)</span><br><span class="line">          : fn.call(ctx)</span><br><span class="line">      &#125;</span><br><span class="line">  </span><br><span class="line">      boundFn._length = fn.length;</span><br><span class="line">      <span class="keyword">return</span> boundFn</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 原生绑定</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">nativeBind</span> (<span class="params">fn, ctx</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> fn.bind(ctx)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// bind 方法的兼容写法</span></span><br><span class="line">    <span class="keyword">var</span> bind = <span class="built_in">Function</span>.prototype.bind</span><br><span class="line">      ? nativeBind</span><br><span class="line">      : polyfillBind;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Convert an Array-like object to a real Array.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/* 把类数组转换成真正的数组 */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">toArray</span> (<span class="params">list, start</span>) </span>&#123;</span><br><span class="line">      start = start || <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">var</span> i = list.length - start;</span><br><span class="line">      <span class="keyword">var</span> ret = <span class="keyword">new</span> <span class="built_in">Array</span>(i);</span><br><span class="line">      <span class="keyword">while</span> (i--) &#123;</span><br><span class="line">        ret[i] = list[i + start];</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> ret</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Mix properties into target object.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">      将目标对象与另一个对象混合后返回新的目标对象</span></span><br><span class="line"><span class="comment">      另一个对象上的同名属性将会覆盖目标对象上的同名属性</span></span><br><span class="line"><span class="comment">      如果目标对象上不存在这个属性, 则添上</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">extend</span> (<span class="params">to, _from</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> _from) &#123;</span><br><span class="line">        to[key] = _from[key];</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> to</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Merge an Array of Objects into a single Object.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">      把数组里每个对象的属性都合并到同一个对象中</span></span><br><span class="line"><span class="comment">      如 [&#123; a: 1 &#125;,&#123; b: 2 &#125;] =&gt; &#123; a: 1, b: 2&#125;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">toObject</span> (<span class="params">arr</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> res = &#123;&#125;;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (arr[i]) &#123;</span><br><span class="line">          extend(res, arr[i]);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> res</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/* eslint-disable no-unused-vars */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Perform no operation.</span></span><br><span class="line"><span class="comment">     * Stubbing args to make Flow happy without leaving useless transpiled code</span></span><br><span class="line"><span class="comment">     * with ...rest (https://flow.org/blog/2017/05/07/Strict-Function-Call-Arity/).</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/* 空函数 在这里插入的参数，是为了避免 Flow 使用 rest 操作符(…) 产生无用的转换代码。*/</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">noop</span> (<span class="params">a, b, c</span>) </span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Always return false.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/* 返回 false */</span></span><br><span class="line">    <span class="keyword">var</span> no = <span class="function"><span class="keyword">function</span> (<span class="params">a, b, c</span>) </span>&#123; <span class="keyword">return</span> <span class="literal">false</span>; &#125;;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/* eslint-enable no-unused-vars */</span></span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Return the same value.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/* 返回自身 */</span></span><br><span class="line">    <span class="keyword">var</span> identity = <span class="function"><span class="keyword">function</span> (<span class="params">_</span>) </span>&#123; <span class="keyword">return</span> _; &#125;;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Generate a string containing static keys from compiler modules.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">      字面作用是把传入的 modules 中的静态属性拼接成 ',' 分隔的字符串</span></span><br><span class="line"><span class="comment">      实际作用是从编译器模块生成包含静态键的字符串</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">genStaticKeys</span> (<span class="params">modules</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> modules.reduce(<span class="function"><span class="keyword">function</span> (<span class="params">keys, m</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> keys.concat(m.staticKeys || [])</span><br><span class="line">      &#125;, []).join(<span class="string">','</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Check if two values are loosely equal - that is,</span></span><br><span class="line"><span class="comment">     * if they are plain objects, do they have the same shape?</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">      这个函数判断 a 和 b 是否相等, 译为浅相等 ?</span></span><br><span class="line"><span class="comment">      当 a 、 b 都为对象时, 判断是否为数组, 如果是数组, 判断长度是否相等, 如果相等, 判断两个数组的每项是否都全等(递归), 全等就返回 true 否则 false. </span></span><br><span class="line"><span class="comment">      当 a 、 b 都为对象而非数组时, 如果它们都是 Date 类型, 调用 getTime() 比较时间戳是否相等,相等返回 true</span></span><br><span class="line"><span class="comment">      当 a 、 b 都为对象而非数组时, 且它们不是 Date 类型, 获取它们的 keys(以它们的键名组成的数组), 判断它们的键名是否一样多, 一样多就逐项比较相等(递归), 当然比较的时候 a 、 b 中的键名必须相同且键值相等才会让这一项返回 true 之后才继续下一项, 最后都返回 true 才返回 true, 否则 false</span></span><br><span class="line"><span class="comment">      当 a 、 b 都不为对象时, 把它们转为字符串比较, 全等就 true, 否则 false</span></span><br><span class="line"><span class="comment">      如果 a 、 b 一个是对象 一个不是对象, 直接 false</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">      istanbul 是个计算代码覆盖率的工具</span></span><br><span class="line"><span class="comment">      /* istanbul ignore next *(不加点东西注释就失效了, 就这样写吧)/ 是 istanbul 提供的注释语法，允许它之后的代码不计入覆盖率。</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">looseEqual</span> (<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (a === b) &#123; <span class="keyword">return</span> <span class="literal">true</span> &#125;</span><br><span class="line">      <span class="keyword">var</span> isObjectA = isObject(a);</span><br><span class="line">      <span class="keyword">var</span> isObjectB = isObject(b);</span><br><span class="line">      <span class="keyword">if</span> (isObjectA &amp;&amp; isObjectB) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">          <span class="keyword">var</span> isArrayA = <span class="built_in">Array</span>.isArray(a);</span><br><span class="line">          <span class="keyword">var</span> isArrayB = <span class="built_in">Array</span>.isArray(b);</span><br><span class="line">          <span class="keyword">if</span> (isArrayA &amp;&amp; isArrayB) &#123;</span><br><span class="line">            <span class="keyword">return</span> a.length === b.length &amp;&amp; a.every(<span class="function"><span class="keyword">function</span> (<span class="params">e, i</span>) </span>&#123;</span><br><span class="line">              <span class="keyword">return</span> looseEqual(e, b[i])</span><br><span class="line">            &#125;)</span><br><span class="line">          &#125; <span class="keyword">else</span> <span class="keyword">if</span> (a <span class="keyword">instanceof</span> <span class="built_in">Date</span> &amp;&amp; b <span class="keyword">instanceof</span> <span class="built_in">Date</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> a.getTime() === b.getTime()</span><br><span class="line">          &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!isArrayA &amp;&amp; !isArrayB) &#123;</span><br><span class="line">            <span class="keyword">var</span> keysA = <span class="built_in">Object</span>.keys(a);</span><br><span class="line">            <span class="keyword">var</span> keysB = <span class="built_in">Object</span>.keys(b);</span><br><span class="line">            <span class="keyword">return</span> keysA.length === keysB.length &amp;&amp; keysA.every(<span class="function"><span class="keyword">function</span> (<span class="params">key</span>) </span>&#123;</span><br><span class="line">              <span class="keyword">return</span> looseEqual(a[key], b[key])</span><br><span class="line">            &#125;)</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">/* istanbul ignore next */</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">          <span class="comment">/* istanbul ignore next */</span></span><br><span class="line">          <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!isObjectA &amp;&amp; !isObjectB) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">String</span>(a) === <span class="built_in">String</span>(b)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Return the first index at which a loosely equal value can be</span></span><br><span class="line"><span class="comment">     * found in the array (if value is a plain object, the array must</span></span><br><span class="line"><span class="comment">     * contain an object of the same shape), or -1 if it is not present.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">      判断数组中是否有某项和 val 相等, 它们可以是对象、数组等复杂类型, 也可以是字符串、数值等基础类型</span></span><br><span class="line"><span class="comment">      如果有数组中能找到和 val 相等项, 返回该项索引, 否则返回 -1</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">looseIndexOf</span> (<span class="params">arr, val</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (looseEqual(arr[i], val)) &#123; <span class="keyword">return</span> i &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Ensure a function is called only once.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">      通过闭包使传入的函数一旦被调用就无法再次被调用, 即只能调用一次</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">once</span> (<span class="params">fn</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> called = <span class="literal">false</span>;</span><br><span class="line">      <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!called) &#123;</span><br><span class="line">          called = <span class="literal">true</span>;</span><br><span class="line">          fn.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/* 服务端渲染 */</span></span><br><span class="line">    <span class="keyword">var</span> SSR_ATTR = <span class="string">'data-server-rendered'</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">      直译 有用的类型? 数组里包含 组件、指令、过滤器</span></span><br><span class="line"><span class="comment">      里面三个都是全局函数名</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">var</span> ASSET_TYPES = [</span><br><span class="line">      <span class="string">'component'</span>,</span><br><span class="line">      <span class="string">'directive'</span>,</span><br><span class="line">      <span class="string">'filter'</span></span><br><span class="line">    ];</span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">    生命周期的钩子, 官网给出八个常用钩子, 实际上这里有十二个</span></span><br><span class="line"><span class="comment">    activated 和 deactivated 是配合keep-alive 使用的两个钩子, 有点类似 beforeDestroy 和 destroyed, 但如果我们需要一个实例(比如路由跳转时, 不用的组件会被销毁)销毁后再次出现的话, 用 beforeDestroy 和 destroyed 太浪费性能了。它们用于重复激活一个实例时。</span></span><br><span class="line"><span class="comment">    errorCaptured 2.5 版本新增的, 处理异常的钩子函数</span></span><br><span class="line"><span class="comment">    serverPrefetch 在 vue-v2.6 的版本中, 处理 ssr (服务端)的函数</span></span><br><span class="line"><span class="comment">     */</span> </span><br><span class="line">    <span class="keyword">var</span> LIFECYCLE_HOOKS = [</span><br><span class="line">      <span class="string">'beforeCreate'</span>,</span><br><span class="line">      <span class="string">'created'</span>,</span><br><span class="line">      <span class="string">'beforeMount'</span>,</span><br><span class="line">      <span class="string">'mounted'</span>,</span><br><span class="line">      <span class="string">'beforeUpdate'</span>,</span><br><span class="line">      <span class="string">'updated'</span>,</span><br><span class="line">      <span class="string">'beforeDestroy'</span>,</span><br><span class="line">      <span class="string">'destroyed'</span>,</span><br><span class="line">      <span class="string">'activated'</span>,</span><br><span class="line">      <span class="string">'deactivated'</span>,</span><br><span class="line">      <span class="string">'errorCaptured'</span>,</span><br><span class="line">      <span class="string">'serverPrefetch'</span></span><br><span class="line">    ];</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/*  */</span></span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">/* 全局配置 */</span></span><br><span class="line">    <span class="keyword">var</span> config = (&#123;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Option merge strategies (used in core/util/options)</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">      <span class="comment">/* 自定义合并策略的选项, 关于 $flow-disable-line 见下方 */</span></span><br><span class="line">      <span class="comment">// $flow-disable-line</span></span><br><span class="line">      optionMergeStrategies: <span class="built_in">Object</span>.create(<span class="literal">null</span>),</span><br><span class="line">  </span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Whether to suppress warnings.</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">      <span class="comment">/* 是否关闭警告, 默认不关闭, 如果为 true, 将不会有各种报错信息 */</span></span><br><span class="line">      silent: <span class="literal">false</span>,</span><br><span class="line">  </span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Show production mode tip message on boot?</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">      <span class="comment">/* </span></span><br><span class="line"><span class="comment">        开发模式下是否在控制台显示生产提示，即是否打印一条 You are running Vue in development mode. 设置为 false 即可关闭该提示。</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">      productionTip: <span class="string">"development"</span> !== <span class="string">'production'</span>,</span><br><span class="line">  </span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Whether to enable devtools</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">      <span class="comment">/* 是否允许 vue-devtools 检查代码. 浏览器环境下为true */</span></span><br><span class="line">      devtools: <span class="string">"development"</span> !== <span class="string">'production'</span>,</span><br><span class="line">  </span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Whether to record perf</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">      <span class="comment">/* </span></span><br><span class="line"><span class="comment">        是否开启性能追踪，只有在开发模式和支持 performance.mark API 的浏览器上才有效</span></span><br><span class="line"><span class="comment">        设置为 true 以在浏览器开发工具的性能/时间线面板中启用对组件初始化、编译、渲染和打补丁的性能追踪。</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">      performance: <span class="literal">false</span>,</span><br><span class="line">  </span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Error handler for watcher errors</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">      <span class="comment">/* </span></span><br><span class="line"><span class="comment">        指定组件的渲染和观察期间未捕获错误的处理函数。这个处理函数被调用时，可获取错误信息和 Vue 实例 用法</span></span><br><span class="line"><span class="comment">        Vue.config.errorHandler = function (err, vm, info) &#123;</span></span><br><span class="line"><span class="comment">          // handle error</span></span><br><span class="line"><span class="comment">          // `info` 是 Vue 特定的错误信息，比如错误所在的生命周期钩子</span></span><br><span class="line"><span class="comment">          // 只在 2.2.0+ 可用</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">        从 2.2.0 起，这个钩子也会捕获组件生命周期钩子里的错误。同样的，当这个钩子是 undefined 时，被捕获的错误会通过 console.error 输出而避免应用崩溃。</span></span><br><span class="line"><span class="comment">        从 2.4.0 起，这个钩子也会捕获 Vue 自定义事件处理函数内部的错误了。</span></span><br><span class="line"><span class="comment">        从 2.6.0 起，这个钩子也会捕获 v-on DOM 监听器内部抛出的错误。另外，如果任何被覆盖的钩子或处理函数返回一个 Promise 链 (例如 async 函数)，则来自其 Promise 链的错误也会被处理。</span></span><br><span class="line"><span class="comment">        错误追踪服务 Sentry 和 Bugsnag 都通过此选项提供了官方支持。</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">      errorHandler: <span class="literal">null</span>,</span><br><span class="line">  </span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Warn handler for watcher warns</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">      <span class="comment">/* </span></span><br><span class="line"><span class="comment">        给 Vue 运行时的警告赋予一个自定义处理函数。注意这只会在开发者环境下生效，在生产环境下它会被忽略。 用法</span></span><br><span class="line"><span class="comment">        Vue.config.warnHandler = function (msg, vm, trace) &#123;</span></span><br><span class="line"><span class="comment">          // `trace` 是组件的继承关系追踪</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">      warnHandler: <span class="literal">null</span>,</span><br><span class="line">  </span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Ignore certain custom elements</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">      <span class="comment">/* </span></span><br><span class="line"><span class="comment">        忽略某些自定义元素 用法</span></span><br><span class="line"><span class="comment">        Vue.config.ignoredElements = [</span></span><br><span class="line"><span class="comment">          'my-custom-web-component',</span></span><br><span class="line"><span class="comment">          'another-web-component',</span></span><br><span class="line"><span class="comment">          // 用一个 `RegExp` 忽略所有“ion-”开头的元素</span></span><br><span class="line"><span class="comment">          // 仅在 2.5+ 支持</span></span><br><span class="line"><span class="comment">          /^ion-/</span></span><br><span class="line"><span class="comment">        ]</span></span><br><span class="line"><span class="comment">        须使 Vue 忽略在 Vue 之外的自定义元素 (e.g. 使用了 Web Components APIs, 它是一套不同的技术, 和 Vue 使用很像, 也是组件化, MDN https://developer.mozilla.org/zh-CN/docs/Web/Web_Components)。否则，它会假设你忘记注册全局组件或者拼错了组件名称，从而抛出一个关于 Unknown custom element 的警告。</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">      ignoredElements: [],</span><br><span class="line">  </span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Custom user key aliases for v-on</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">      <span class="comment">/* </span></span><br><span class="line"><span class="comment">        $flow-disable-line</span></span><br><span class="line"><span class="comment">        $flow-disable-line 表示它在下一行禁用了 Flow JS 的错误报告, 在 .flowconfig 中的 option 里有写到 suppress_comment= \\(.\\|\n\\)*\\$flow-disable-line, 它会被后端语言 编译(大概吧, 因为这不是前端的写法, tmd 我觉得 $ 前面得加4个 '\' 才对), 而后端语言的正则里 \\\\ 表示一个 \, 比前端多了一层, 所以这里也一样每个比前端正则多写一层。。</span></span><br><span class="line"><span class="comment">        以 java 为例, \\ 中的第一个\表示 java 的转义字符\由编译器解析，第二个\是正则表达式\由正则表达式引擎解析。</span></span><br><span class="line"><span class="comment">        如果是 JS, 正则就应该写成 new RegExp('\(.\|\n\)*\\$flow-disable-line')</span></span><br><span class="line"><span class="comment">        字符串里只有一个 \ 就和没有没啥区别所以还能删一点,</span></span><br><span class="line"><span class="comment">        new RegExp('(.|\n)*\\$flow-disable-line')</span></span><br><span class="line"><span class="comment">        字符串会先把 \\$ 变成 \$ 然后传到正则中, 这样$ 就不是特殊字符了。</span></span><br><span class="line"><span class="comment">        接着把转义符去了, 表示匹配 /(.|\n)*$flow-disable-line/ 注意 . 号表示匹配换行符 \n 之外的任何单字符</span></span><br><span class="line"><span class="comment">        在线查看 vue 的 .flowconfig 文件地址 https://github.com/vuejs/vue/blob/dev/.flowconfig#L23</span></span><br><span class="line"><span class="comment">        然后 .flowconfig 官网配置网址 https://flow.org/en/docs/config/options/ 中, 会发现在v0.127.0版本中，删除了指定禁止注释语法的选项。$FlowFixMe，$FlowIssue，$FlowExpectedError，和 $FlowIgnore 成为唯一禁止注释的标准。也就是说新版的 FlowJS 中, 下面这注释没啥用了</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">      <span class="comment">/* </span></span><br><span class="line"><span class="comment">        给 v-on 自定义键位别名 用法</span></span><br><span class="line"><span class="comment">        Vue.config.keyCodes = &#123;</span></span><br><span class="line"><span class="comment">          v: 86,</span></span><br><span class="line"><span class="comment">          f1: 112,</span></span><br><span class="line"><span class="comment">          // camelCase(驼峰写法) 不可用</span></span><br><span class="line"><span class="comment">          mediaPlayPause: 179,</span></span><br><span class="line"><span class="comment">          // 取而代之的是 kebab-case 且用双引号括起来</span></span><br><span class="line"><span class="comment">          "media-play-pause": 179,</span></span><br><span class="line"><span class="comment">          up: [38, 87]</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">        &lt;input type="text" @keyup.media-play-pause="method"&gt;</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">      <span class="comment">// $flow-disable-line</span></span><br><span class="line">      keyCodes: <span class="built_in">Object</span>.create(<span class="literal">null</span>),</span><br><span class="line">  </span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Check if a tag is reserved so that it cannot be registered as a</span></span><br><span class="line"><span class="comment">       * component. This is platform-dependent and may be overwritten.</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">      <span class="comment">/* </span></span><br><span class="line"><span class="comment">        翻译 检查标签是否已保留，如果有，便不能将其注册为组件。这与平台有关，可能会被覆盖</span></span><br><span class="line"><span class="comment">        现在是值为 no 函数, 到下面它会变成别的, 应该会用到上面的 makeMap 变成 Map, 然后里面有下面这些默认的标签名和用户自定义的标签名</span></span><br><span class="line"><span class="comment">        规定的是一些 html 和 svg 它们下面的一些标签名，我们不能定义为组件名。比如 div html 这些</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">      isReservedTag: no,</span><br><span class="line">  </span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Check if an attribute is reserved so that it cannot be used as a component</span></span><br><span class="line"><span class="comment">       * prop. This is platform-dependent and may be overwritten.</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">      <span class="comment">/* </span></span><br><span class="line"><span class="comment">        检查属性是否已保留，以便不能用作组件属性。这与平台有关，可能会被覆盖。</span></span><br><span class="line"><span class="comment">        现在是值为 no 函数, 到下面它会变成别的, 应该会用到上面的 makeMap 变成 Map, 然后里面有下面这些默认的属性名和用户自定义的属性名</span></span><br><span class="line"><span class="comment">        规定的是标签下的一些默认属性名，我们不能定义为属性名。比如 style class 这些</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">      isReservedAttr: no,</span><br><span class="line">  </span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Check if a tag is an unknown element.</span></span><br><span class="line"><span class="comment">       * Platform-dependent.</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">      <span class="comment">// 检查标签是否为未知元素。平台相关</span></span><br><span class="line">      isUnknownElement: no,</span><br><span class="line">  </span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Get the namespace of an element</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">      <span class="comment">// 获取元素的名称空间</span></span><br><span class="line">      getTagNamespace: noop,</span><br><span class="line">  </span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Parse the real tag name for the specific platform.</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">      <span class="comment">// 解析特定平台的真实标签名称。</span></span><br><span class="line">      parsePlatformTagName: identity,</span><br><span class="line">  </span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Check if an attribute must be bound using property, e.g. value</span></span><br><span class="line"><span class="comment">       * Platform-dependent.</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">      <span class="comment">// 检查是否必须使用属性来绑定属性，例如 value</span></span><br><span class="line">      mustUseProp: no,</span><br><span class="line">  </span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Perform updates asynchronously. Intended to be used by Vue Test Utils</span></span><br><span class="line"><span class="comment">       * This will significantly reduce performance if set to false.</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">      <span class="comment">// 异步执行更新。打算由 Vue Test Utils 使用, 如果设置为false，这将大大降低性能。</span></span><br><span class="line">      <span class="keyword">async</span>: <span class="literal">true</span>,</span><br><span class="line">  </span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * Exposed for legacy reasons</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">      <span class="comment">// 由于遗留原因而暴露</span></span><br><span class="line">      _lifecycleHooks: LIFECYCLE_HOOKS</span><br><span class="line">    &#125;);</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/*  */</span></span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * unicode letters used for parsing html tags, component names and property paths.</span></span><br><span class="line"><span class="comment">     * using https://www.w3.org/TR/html53/semantics-scripting.html#potentialcustomelementname</span></span><br><span class="line"><span class="comment">     * skipping \u10000-\uEFFFF due to it freezing up PhantomJS</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">      用于解析html标签，组件名称和属性路径的 unicode字母。 </span></span><br><span class="line"><span class="comment">      不懂, 为啥这正则这样写的, 这样写不就是只匹配自己么, 也就是只匹配 'a-zA-Z\u00B7\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u037D\u037F-\u1FFF\u200C-\u200D\u203F-\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD'</span></span><br><span class="line"><span class="comment">      没事了, 下面用到了 .source 属性, 会返回 / / 中间内容的字符串</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">var</span> unicodeRegExp = <span class="regexp">/a-zA-Z\u00B7\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u037D\u037F-\u1FFF\u200C-\u200D\u203F-\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD/</span>;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Check if a string starts with $ or _</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">      是否为内部定义属性</span></span><br><span class="line"><span class="comment">      Vue 中默认 $ 为只读属性, _ 为可读可写</span></span><br><span class="line"><span class="comment">      判断字符串是否以 $ 或者 _ 开头</span></span><br><span class="line"><span class="comment">      '/u0024' $</span></span><br><span class="line"><span class="comment">      '/u005F' _</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">isReserved</span> (<span class="params">str</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> c = (str + <span class="string">''</span>).charCodeAt(<span class="number">0</span>);</span><br><span class="line">      <span class="keyword">return</span> c === <span class="number">0x24</span> || c === <span class="number">0x5F</span></span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Define a property.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/* 设置对象属性的描述对象, 这个属性可读可写可删可改, 是否可枚举需要自己传参, 默认不可枚举, 因为 !!undefined === false */</span></span><br><span class="line">    <span class="comment">// 在 Vue 中, 有很多互相引用的地方, 通过这个函数让新添加的对象变成不可枚举, 从而让递归可以结束, 如 __ob__</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">def</span> (<span class="params">obj, key, val, enumerable</span>) </span>&#123;</span><br><span class="line">      <span class="built_in">Object</span>.defineProperty(obj, key, &#123;</span><br><span class="line">        value: val,</span><br><span class="line">        enumerable: !!enumerable,</span><br><span class="line">        writable: <span class="literal">true</span>,</span><br><span class="line">        configurable: <span class="literal">true</span></span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Parse simple path.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">      作用是解析一个简单路径</span></span><br><span class="line"><span class="comment">      正则对象有 source 属性, 返回正则的字符串形式, 如 /a-z/.source 返回 'a-z'</span></span><br><span class="line"><span class="comment">      于是上面的正则就会变成下面这样并赋值给 bailRE</span></span><br><span class="line"><span class="comment">      /[^a-zA-Z\u00B7\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u037D\u037F-\u1FFF\u200C-\u200D\u203F-\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD.$_\d]/</span></span><br><span class="line"><span class="comment">      \d 匹配数字</span></span><br><span class="line"><span class="comment">      如果路径不是以上面的 a-zA-Z...这些合法字符开头的, 就直接返回, 如果是合法字符开头, 把地址以 . 分割成数组并存在闭包中, 之后返回一个函数, 这个函数接受一个对象, 如果它不为空, 就遍历之前分割路径完成的数组, 每次遍历, 把它赋值为它自身的, 与数组当前项同名的键的键值并返回, 本身传入的对象应该很深, 所以可以这样写, 如下所示, 对象先变成 a, 再变成 b, 再变成 c</span></span><br><span class="line"><span class="comment">      &#123;</span></span><br><span class="line"><span class="comment">        a: &#123;</span></span><br><span class="line"><span class="comment">          b: &#123;</span></span><br><span class="line"><span class="comment">            c: &#123;&#125;</span></span><br><span class="line"><span class="comment">          &#125;</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">      &#125;</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">var</span> bailRE = <span class="keyword">new</span> <span class="built_in">RegExp</span>((<span class="string">"[^"</span> + (unicodeRegExp.source) + <span class="string">".$_\\d]"</span>));</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">parsePath</span> (<span class="params">path</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (bailRE.test(path)) &#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">var</span> segments = path.split(<span class="string">'.'</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">obj</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; segments.length; i++) &#123;</span><br><span class="line">          <span class="keyword">if</span> (!obj) &#123; <span class="keyword">return</span> &#125;</span><br><span class="line">          obj = obj[segments[i]];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> obj</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/*  */</span></span><br><span class="line">  </span><br><span class="line">    <span class="comment">// can we use __proto__?</span></span><br><span class="line">    <span class="comment">/* 判断能否使用 __proto__ , 将会在改写数组响应式方法的时候决定是在它本身添加方法还是在其原型链上新添对象 */</span></span><br><span class="line">    <span class="keyword">var</span> hasProto = <span class="string">'__proto__'</span> <span class="keyword">in</span> &#123;&#125;;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">// Browser environment sniffing</span></span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">      以下都是环境检测</span></span><br><span class="line"><span class="comment">      inBrowser 判断是否有 window</span></span><br><span class="line"><span class="comment">      inWeex 是否为 Weex 环境, 它可以用来开发移动应用</span></span><br><span class="line"><span class="comment">      weexPlatform 如果为 Weex 环境, 把 Weex 环境变量的 platform 转成小写并赋值</span></span><br><span class="line"><span class="comment">      UA 如果在浏览器环境下, 同时存在 navigator API, 就把这个浏览器代理信息赋值给 UA</span></span><br><span class="line"><span class="comment">      isIE 用 IE 标识和 UA 匹配一下看看是 IE 🐎</span></span><br><span class="line"><span class="comment">      isIE9 用 IE9 标识和 UA 匹配一下看看是 IE9 🐎</span></span><br><span class="line"><span class="comment">      isEdge 用 Edge 标识和 UA 匹配一下看看是 Edge 🐎</span></span><br><span class="line"><span class="comment">      isAndroid 用 android 标识和 UA 或者 weexPlatform 匹配一下看看是安卓 🐎</span></span><br><span class="line"><span class="comment">      isIOS 是 ios 🐎, 匹配方式同 安卓</span></span><br><span class="line"><span class="comment">      isChrome 判断是谷歌🐎 匹配 UA 同时得不是 Edge (因为 Edge 换了谷歌内核, 标识估计也丢进去了)</span></span><br><span class="line"><span class="comment">      isPhantomJS 是 PhantomJS 🐎 PhantomJS是一个无界面的、可脚本编程的WebKit浏览器引擎，其快速，原生支持各种Web标准： DOM 处理, CSS 选择器, JSON, Canvas, 和 SVG。</span></span><br><span class="line"><span class="comment">      isFF 是火狐 🐎</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    */</span> </span><br><span class="line">    <span class="keyword">var</span> inBrowser = <span class="keyword">typeof</span> <span class="built_in">window</span> !== <span class="string">'undefined'</span>;</span><br><span class="line">    <span class="keyword">var</span> inWeex = <span class="keyword">typeof</span> WXEnvironment !== <span class="string">'undefined'</span> &amp;&amp; !!WXEnvironment.platform;</span><br><span class="line">    <span class="keyword">var</span> weexPlatform = inWeex &amp;&amp; WXEnvironment.platform.toLowerCase();</span><br><span class="line">    <span class="keyword">var</span> UA = inBrowser &amp;&amp; <span class="built_in">window</span>.navigator.userAgent.toLowerCase();</span><br><span class="line">    <span class="keyword">var</span> isIE = UA &amp;&amp; <span class="regexp">/msie|trident/</span>.test(UA);</span><br><span class="line">    <span class="keyword">var</span> isIE9 = UA &amp;&amp; UA.indexOf(<span class="string">'msie 9.0'</span>) &gt; <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> isEdge = UA &amp;&amp; UA.indexOf(<span class="string">'edge/'</span>) &gt; <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> isAndroid = (UA &amp;&amp; UA.indexOf(<span class="string">'android'</span>) &gt; <span class="number">0</span>) || (weexPlatform === <span class="string">'android'</span>);</span><br><span class="line">    <span class="keyword">var</span> isIOS = (UA &amp;&amp; <span class="regexp">/iphone|ipad|ipod|ios/</span>.test(UA)) || (weexPlatform === <span class="string">'ios'</span>);</span><br><span class="line">    <span class="keyword">var</span> isChrome = UA &amp;&amp; <span class="regexp">/chrome\/\d+/</span>.test(UA) &amp;&amp; !isEdge;</span><br><span class="line">    <span class="keyword">var</span> isPhantomJS = UA &amp;&amp; <span class="regexp">/phantomjs/</span>.test(UA);</span><br><span class="line">    <span class="keyword">var</span> isFF = UA &amp;&amp; UA.match(<span class="regexp">/firefox\/(\d+)/</span>);</span><br><span class="line">  </span><br><span class="line">    <span class="comment">// Firefox has a "watch" function on Object.prototype...</span></span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">      火狐的对象上有个特殊的方法 watch, 看看当前浏览器有没有 watch 方法</span></span><br><span class="line"><span class="comment">      卧槽, 对象外面包一层括号就能用 . 了</span></span><br><span class="line"><span class="comment">      不然就会变成 &#123;&#125;['watch']</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">var</span> nativeWatch = (&#123;&#125;).watch;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">      检查是否支持 passive, 它是Chrome提出的一个新的浏览器特性：Web开发者通过一个新的属性passive来告诉浏览器，当前页面内注册的事件监听器内部是否会调用preventDefault函数来阻止事件的默认行为，以便浏览器根据这个信息更好地做出决策来优化页面性能。当属性passive的值为true的时候，代表该监听器内部不会调用preventDefault函数来阻止默认滑动行为，Chrome浏览器称这类型的监听器为被动（passive）监听器。目前Chrome主要利用该特性来优化页面的滑动性能，所以Passive Event Listeners特性当前仅支持mousewheel/touch相关事件</span></span><br><span class="line"><span class="comment">      </span></span><br><span class="line"><span class="comment">      Passive Event Listeners特性是为了提高页面的滑动流畅度而设计的，页面滑动流畅度的提升，直接影响到用户对这个页面最直观的感受。这个不难理解，想象一下你想要滑动某个页面浏览内容，当你用鼠标滚轮或者用手指触摸屏幕上下滑动的时候，页面并没有按你的预期进行滚动，此时你内心往往会感觉到一丝不爽，甚至想放弃该页面。Facebook之前做了一项试验，他们将页面滑动的响应刷新率从60FPS降低到30FPS的时候，发现用户的参与度急速下降。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">      简单用法</span></span><br><span class="line"><span class="comment">      document.addEventListener('mousewheel', handler, &#123; passive: true &#125;)</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">      分别用了 async 函数和 while 循环分别充当 sleep 函数作为测试函数，测试在加与不加 passive 下的浏览器表现。 </span></span><br><span class="line"><span class="comment">        1.在不加passive的情况下，使用async函数不会阻塞浏览器的默认滚动行为。</span></span><br><span class="line"><span class="comment">        2.在不加passive的情况下，使用while循环函数会阻塞浏览器的默认滚动行为。</span></span><br><span class="line"><span class="comment">        3.在加passive的情况下，使用async函数表现没有变化。</span></span><br><span class="line"><span class="comment">        4.在加passive的情况下，使用while循环函数不会阻塞浏览器的默认滚动行为。</span></span><br><span class="line"><span class="comment">        5.在加passive的情况下，调用preventDefault函数会报错，滚动正常。</span></span><br><span class="line"><span class="comment">        结论：当监听滚动的函数可能影响滚动时，可以检测浏览器是否支持passive以优化浏览器表现。</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">var</span> supportsPassive = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (inBrowser) &#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> opts = &#123;&#125;;</span><br><span class="line">        <span class="comment">// defineProperty 的第三个参数外面包括号的原因是 FlowJS 当时检测类型无法通过, 因为它找不到 value 的值, 接着代码就因为报错卡住不执行了, 不过加了 () 之后为啥可以我也不知道看 FlowJS 代码才知道(可能是加了之后变成表达式而不是对象 FlowJS 就不会对它进行检查了), 下面那个 issue 中 gaperton 提出了这种解决方法, 这种办法能不报错, 让代码继续执行, 否则到这里就卡了, 这大概也是尤大在这里写了一个 try 的原因吧, 为了报错时代码继续执行下去</span></span><br><span class="line">        <span class="built_in">Object</span>.defineProperty(opts, <span class="string">'passive'</span>, (&#123;</span><br><span class="line">          <span class="keyword">get</span>: function <span class="keyword">get</span> () &#123;</span><br><span class="line">            <span class="comment">/* istanbul ignore next */</span></span><br><span class="line">            supportsPassive = <span class="literal">true</span>;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)); <span class="comment">// https://github.com/facebook/flow/issues/285</span></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        当前 addEventListener 的第三个参数可选择的选项, 如果第三个参数不是对象, 而是布尔值, 默认为 capture 赋值</span></span><br><span class="line"><span class="comment">        capture 表示在上面阶段执行函数, 为 true 时, 在捕获阶段, 默认为 false, 在冒泡阶段</span></span><br><span class="line"><span class="comment">        passive 在上面已经说明了, 由于不知道 listener 是否会调用 preventDefault, 浏览器只能在执行完整个监听函数之后才能决定是否滚动页面, 从而造成卡顿, 即使你的回调函数不做任何操作(如 function () &#123;&#125;). passive 就是直接告诉浏览器这个函数是否会调用 preventDefault, 从而加速页面(因为大部分的滚动事件回调函数都不会用到 preventDefault, 但浏览器却必须监听, 导致性能变差) 实际效果见 http://cloud.video.taobao.com/play/u/1629222031/p/1/e/6/t/1/39477440.mp4</span></span><br><span class="line"><span class="comment">        once 表示 listener 在添加之后最多只调用一次。如果是 true, listener 会在其被调用之后自动移除。</span></span><br><span class="line"><span class="comment">        addEventListener(type, listener, &#123;</span></span><br><span class="line"><span class="comment">            capture: false,</span></span><br><span class="line"><span class="comment">            passive: false,</span></span><br><span class="line"><span class="comment">            once: false</span></span><br><span class="line"><span class="comment">        &#125;)</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="built_in">window</span>.addEventListener(<span class="string">'test-passive'</span>, <span class="literal">null</span>, opts);</span><br><span class="line">      &#125; <span class="keyword">catch</span> (e) &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">// this needs to be lazy-evaled because vue may be required before</span></span><br><span class="line">    <span class="comment">// vue-server-renderer can set VUE_ENV</span></span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">      检测 vue 是否为服务端渲染, 而且避免 webpack 去填充 process, 因为 vue 可以自己设置 VUE_ENV</span></span><br><span class="line"><span class="comment">      global 在浏览器中无法访问, 在 Node.js 中它是全局变量, webpack 依赖于 node 环境</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">var</span> _isServer;</span><br><span class="line">    <span class="keyword">var</span> isServerRendering = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (_isServer === <span class="literal">undefined</span>) &#123;</span><br><span class="line">        <span class="comment">/* 如果不是浏览器不是 Weex 且 global 存在 */</span></span><br><span class="line">        <span class="comment">/* istanbul ignore if */</span></span><br><span class="line">        <span class="keyword">if</span> (!inBrowser &amp;&amp; !inWeex &amp;&amp; <span class="keyword">typeof</span> global !== <span class="string">'undefined'</span>) &#123;</span><br><span class="line">          <span class="comment">// detect presence of vue-server-renderer and avoid</span></span><br><span class="line">          <span class="comment">// 检测vue-server-renderer的存在并避免 webpack 去填充 process</span></span><br><span class="line">          <span class="comment">// Webpack shimming the process</span></span><br><span class="line">          _isServer = global[<span class="string">'process'</span>] &amp;&amp; global[<span class="string">'process'</span>].env.VUE_ENV === <span class="string">'server'</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          _isServer = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> _isServer</span><br><span class="line">    &#125;;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">// detect devtools</span></span><br><span class="line">    <span class="comment">// 检测 devtools</span></span><br><span class="line">    <span class="keyword">var</span> devtools = inBrowser &amp;&amp; <span class="built_in">window</span>.__VUE_DEVTOOLS_GLOBAL_HOOK__;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">      判断是否为系统函数, 这些函数不是使用 JS 实现的, 打印它们将会返回 [native code] 比如</span></span><br><span class="line"><span class="comment">      Function.prototype.bind // ƒ bind() &#123; [native code] &#125;</span></span><br><span class="line"><span class="comment">      至于为什么返回这个, V8 引擎中可以找到这么一行 return 'function () &#123; [native code] &#125;';</span></span><br><span class="line"><span class="comment">      下面用于区分 Symbol、Reflect、Set 是系统函数, 还是用户自定义了一个同名变量, 如果当前浏览器原生支持, 这几个 ES6 新增加的对象, 就用原生对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/* istanbul ignore next */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">isNative</span> (<span class="params">Ctor</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">typeof</span> Ctor === <span class="string">'function'</span> &amp;&amp; <span class="regexp">/native code/</span>.test(Ctor.toString())</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*  */</span></span><br><span class="line">    <span class="keyword">var</span> hasSymbol =</span><br><span class="line">      <span class="keyword">typeof</span> <span class="built_in">Symbol</span> !== <span class="string">'undefined'</span> &amp;&amp; isNative(<span class="built_in">Symbol</span>) &amp;&amp;</span><br><span class="line">      <span class="keyword">typeof</span> <span class="built_in">Reflect</span> !== <span class="string">'undefined'</span> &amp;&amp; isNative(<span class="built_in">Reflect</span>.ownKeys);</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">var</span> _Set;</span><br><span class="line">    <span class="comment">/* istanbul ignore if */</span> <span class="comment">// $flow-disable-line</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="built_in">Set</span> !== <span class="string">'undefined'</span> &amp;&amp; isNative(<span class="built_in">Set</span>)) &#123;</span><br><span class="line">      <span class="comment">// use native Set when available.</span></span><br><span class="line">      _Set = <span class="built_in">Set</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// a non-standard Set polyfill that only works with primitive keys.</span></span><br><span class="line">      <span class="comment">/* </span></span><br><span class="line"><span class="comment">        如果原生不支持 Set, 就自定义一个非全局的 Set 对象(不会污染到全局) 并赋值给 _Set </span></span><br><span class="line"><span class="comment">        非标准 Set polyfill，仅适用于原始类型的键</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">      _Set = <span class="comment">/*@__PURE__*/</span>(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">Set</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">          <span class="keyword">this</span>.set = <span class="built_in">Object</span>.create(<span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">Set</span>.prototype.has = <span class="function"><span class="keyword">function</span> <span class="title">has</span> (<span class="params">key</span>) </span>&#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="keyword">this</span>.set[key] === <span class="literal">true</span></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="built_in">Set</span>.prototype.add = <span class="function"><span class="keyword">function</span> <span class="title">add</span> (<span class="params">key</span>) </span>&#123;</span><br><span class="line">          <span class="keyword">this</span>.set[key] = <span class="literal">true</span>;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="built_in">Set</span>.prototype.clear = <span class="function"><span class="keyword">function</span> <span class="title">clear</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">          <span class="keyword">this</span>.set = <span class="built_in">Object</span>.create(<span class="literal">null</span>);</span><br><span class="line">        &#125;;</span><br><span class="line">  </span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Set</span>;</span><br><span class="line">      &#125;());</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/*  */</span></span><br><span class="line">    <span class="comment">/* 估计是, Flow 的检测机制问题, 函数变量如果要改变必须开始就指定为函数, 不允许从比如 Number 转 Function */</span></span><br><span class="line">    <span class="keyword">var</span> warn = noop;</span><br><span class="line">    <span class="keyword">var</span> tip = noop;</span><br><span class="line">    <span class="keyword">var</span> generateComponentTrace = (noop); <span class="comment">// work around flow check</span></span><br><span class="line">    <span class="comment">// 解决 flow 检查, 不加括号估计就报错了? </span></span><br><span class="line">    <span class="keyword">var</span> formatComponentName = (noop);</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/* VueJs 日志信息模块代码 */</span> </span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">var</span> hasConsole = <span class="keyword">typeof</span> <span class="built_in">console</span> !== <span class="string">'undefined'</span>;</span><br><span class="line">      <span class="comment">/* </span></span><br><span class="line"><span class="comment">        匹配这样的 r, R, a_r, a_R, a-r, a-R, 因为 \w 也会匹配 _, 所以前面设置了一个非捕获组 ?:, 它将不会出现在结果数组中, 并且前面的 ^ 保证了, -r 或 _r 这种以 _ 或 - 开头的不会被匹配到 </span></span><br><span class="line"><span class="comment">        匹配字符串开始的位置后的英文字符或 - 或 _ 位置之后的英文字符</span></span><br><span class="line"><span class="comment">        之后把匹配到的英文字符变大写, 再把 - 或 _ 删了</span></span><br><span class="line"><span class="comment">        看起来是转了个大驼峰命名 ? </span></span><br><span class="line"><span class="comment">        看了一下每个需要转化的变量(如 classify\hyphenate\camelize)都有它自己的正则规则, 名字都叫 xxxxRE, 把每个都区分了而不是共用, 共用可能比较混乱吧 ? </span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line">      <span class="keyword">var</span> classifyRE = <span class="regexp">/(?:^|[-_])(\w)/g</span>;</span><br><span class="line">      <span class="keyword">var</span> classify = <span class="function"><span class="keyword">function</span> (<span class="params">str</span>) </span>&#123; <span class="keyword">return</span> str</span><br><span class="line">        .replace(classifyRE, <span class="function"><span class="keyword">function</span> (<span class="params">c</span>) </span>&#123; <span class="keyword">return</span> c.toUpperCase(); &#125;)</span><br><span class="line">        .replace(<span class="regexp">/[-_]/g</span>, <span class="string">''</span>); &#125;;</span><br><span class="line">  </span><br><span class="line">      warn = <span class="function"><span class="keyword">function</span> (<span class="params">msg, vm</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// generateComponentTrace 翻译出来是生成组件追踪? 它会追踪到项目组件警告的踪迹, 是个定位功能 </span></span><br><span class="line">        <span class="keyword">var</span> trace = vm ? generateComponentTrace(vm) : <span class="string">''</span>;</span><br><span class="line">        <span class="comment">// 判断是否在配置项里自定义了 warnHandler, 如果定义了用自定义的, 否则如果没定义同时用户没设置不需要报错信息(也就是 silent 不为 false), 则控制台打印 warn 警告信息</span></span><br><span class="line">        <span class="keyword">if</span> (config.warnHandler) &#123;</span><br><span class="line">          config.warnHandler.call(<span class="literal">null</span>, msg, vm, trace);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (hasConsole &amp;&amp; (!config.silent)) &#123;</span><br><span class="line">          <span class="built_in">console</span>.error((<span class="string">"[Vue warn]: "</span> + msg + trace));</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="comment">// 如果 silent 不为 false, 则把提示打印在控制台</span></span><br><span class="line">      tip = <span class="function"><span class="keyword">function</span> (<span class="params">msg, vm</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (hasConsole &amp;&amp; (!config.silent)) &#123;</span><br><span class="line">          <span class="built_in">console</span>.warn(<span class="string">"[Vue tip]: "</span> + msg + (</span><br><span class="line">            vm ? generateComponentTrace(vm) : <span class="string">''</span></span><br><span class="line">          ));</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="comment">// 函数作用是返回组件名称的标签, 没定名字就返回 &lt;Anonymous&gt;(匿名), 如果它的根路径等于自身, 返回 &lt;Root&gt;</span></span><br><span class="line">      formatComponentName = <span class="function"><span class="keyword">function</span> (<span class="params">vm, includeFile</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (vm.$root === vm) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="string">'&lt;Root&gt;'</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">          typeof vm === 'function' &amp;&amp; vm.cid != null</span></span><br><span class="line"><span class="comment">          ? vm.options 相当于 ( typeof vm === 'function' &amp;&amp; vm.cid != null) ? vm.options, 是前面的整体包裹, 而不是只包括了 vm.cid 而变成这样 (vm.cid != null) ? vm.options</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="keyword">var</span> options = <span class="keyword">typeof</span> vm === <span class="string">'function'</span> &amp;&amp; vm.cid != <span class="literal">null</span></span><br><span class="line">          ? vm.options</span><br><span class="line">          : vm._isVue</span><br><span class="line">            ? vm.$options || vm.constructor.options</span><br><span class="line">            : vm;</span><br><span class="line">        <span class="keyword">var</span> name = options.name || options._componentTag;</span><br><span class="line">        <span class="keyword">var</span> file = options.__file;</span><br><span class="line">        <span class="keyword">if</span> (!name &amp;&amp; file) &#123;</span><br><span class="line">          <span class="comment">// 不匹配 \.vue 和 /.vue 这种 .vue 前面带 / 和 \ 的</span></span><br><span class="line">          <span class="keyword">var</span> match = file.match(<span class="regexp">/([^/\\]+)\.vue$/</span>);</span><br><span class="line">          name = match &amp;&amp; match[<span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">  </span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">          <span class="comment">// classify 是之前的大驼峰转换方法</span></span><br><span class="line">          (name ? (<span class="string">"&lt;"</span> + (classify(name)) + <span class="string">"&gt;"</span>) : <span class="string">"&lt;Anonymous&gt;"</span>) +</span><br><span class="line">          (file &amp;&amp; includeFile !== <span class="literal">false</span> ? (<span class="string">" at "</span> + file) : <span class="string">''</span>)</span><br><span class="line">        )</span><br><span class="line">      &#125;;</span><br><span class="line"></span><br><span class="line">      <span class="comment">/* </span></span><br><span class="line"><span class="comment">        将数字n转成二进制,实现累加，比用 for 循环减少累加次数</span></span><br><span class="line"><span class="comment">        这个函数重复 str n 次并返回, 它用了位运算</span></span><br><span class="line"><span class="comment">        模拟一下, 传入 'a', 7</span></span><br><span class="line"><span class="comment">        转二进制方法</span></span><br><span class="line"><span class="comment">        new Number(7).toString(2) === '111'</span></span><br><span class="line"><span class="comment">        或者 var a = 7</span></span><br><span class="line"><span class="comment">        a.toString(2) === '111'</span></span><br><span class="line"><span class="comment">        直接 7.toString(2) 是不行的, 规则 NumberObject.toString(radix)</span></span><br><span class="line"><span class="comment">        而赋值给 a 后, 调用方法的时候将会自动把 7 包装成 Number 对象</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        第一轮</span></span><br><span class="line"><span class="comment">        7 % 2 === 1 // true  res = 'a'</span></span><br><span class="line"><span class="comment">        7 &gt; 1 // true  str = 'aa'</span></span><br><span class="line"><span class="comment">        7 &gt;&gt; 1 === 3 // new Number(3).toString(2) === '11'</span></span><br><span class="line"><span class="comment">        第二轮</span></span><br><span class="line"><span class="comment">        3 % 2 === 1 // true res = 'a' + 'aa'</span></span><br><span class="line"><span class="comment">        3 &gt; 1 // true str = 'aa' + 'aa'</span></span><br><span class="line"><span class="comment">        3 &gt;&gt; 1 === 1 // new Number(1).toString(2) === '1'</span></span><br><span class="line"><span class="comment">        第三轮</span></span><br><span class="line"><span class="comment">        1 % 2 === 1 // true res = 'aaa' + 'aaaa'</span></span><br><span class="line"><span class="comment">        1 &gt; 1 // false</span></span><br><span class="line"><span class="comment">        1 &gt;&gt; 1 === 0 </span></span><br><span class="line"><span class="comment">        第四轮</span></span><br><span class="line"><span class="comment">        n === 0 // 跳出循环</span></span><br><span class="line"><span class="comment">        return 'aaaaaaa'</span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line">      <span class="keyword">var</span> repeat = <span class="function"><span class="keyword">function</span> (<span class="params">str, n</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> res = <span class="string">''</span>;</span><br><span class="line">        <span class="keyword">while</span> (n) &#123;</span><br><span class="line">          <span class="keyword">if</span> (n % <span class="number">2</span> === <span class="number">1</span>) &#123; res += str; &#125;</span><br><span class="line">          <span class="keyword">if</span> (n &gt; <span class="number">1</span>) &#123; str += str; &#125;</span><br><span class="line">          <span class="comment">// 它是 n = n &gt;&gt; 1 的简写, 所以你不能写 3 &gt;&gt;= 1, 那就报错, 等号左边无效</span></span><br><span class="line">          n &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="comment">/* </span></span><br><span class="line"><span class="comment">        组件树规则 </span></span><br><span class="line"><span class="comment">        Vue 的 constructor 是 Vue(options)</span></span><br><span class="line"><span class="comment">        组件的 constructor 是 VueComponent(options)</span></span><br><span class="line"><span class="comment">        如果传入的 vm 是 组件的组件的组件, 也就是说它是</span></span><br><span class="line"><span class="comment">        vmc1 =&gt; vmc2 =&gt; vmc3 =&gt; Vue</span></span><br><span class="line"><span class="comment">        模拟一下</span></span><br><span class="line"><span class="comment">        1. vmc1 进入循环, tree.length === 0, cRS === 0 跳出 if, tree.push(vmc1), vm = vmc2, 此时 tree = [vmc1]</span></span><br><span class="line"><span class="comment">        2. vmc2 进入循环, tree.length &gt; 0, last = vmc1, last.ctor === vmc2.ctor, cRS = 1, vm = vmc3, 再次执行 while, 此时 tree = [vmc1]</span></span><br><span class="line"><span class="comment">        3. vmc3 进入循环, tree.length &gt; 0, last = vmc1, last.ctor === vmc3.ctor, cRS = 2, vm = Vue, 再次执行 while, 此时 tree = [vmc1]</span></span><br><span class="line"><span class="comment">        4. Vue 进入循环, tree.length &gt; 0, last = vmc1, last.ctor !== Vue.ctor, cRS &gt; 0, tree[0] = [vmc1, 2], cRS = 0, if 结束, tree.push(Vue), vm = Vue.$parent(undefined), 因此不再进入 while 循环, 此时 tree = [[vmc1, 2], Vue]</span></span><br><span class="line"><span class="comment">        5.执行 return, 返回</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        found in</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        ----&gt; &lt;vmc1&gt; ... (2 recursive calls)</span></span><br><span class="line"><span class="comment">               &lt;Root&gt;</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">      generateComponentTrace = <span class="function"><span class="keyword">function</span> (<span class="params">vm</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 如果参数vm存在 Vue 结构属性并且存在父组件</span></span><br><span class="line">        <span class="keyword">if</span> (vm._isVue &amp;&amp; vm.$parent) &#123;</span><br><span class="line">          <span class="keyword">var</span> tree = [];</span><br><span class="line">          <span class="comment">// currentRecursiveSequence 当前递归序列</span></span><br><span class="line">          <span class="keyword">var</span> currentRecursiveSequence = <span class="number">0</span>;</span><br><span class="line">          <span class="comment">// 生成树结构</span></span><br><span class="line">          <span class="keyword">while</span> (vm) &#123;</span><br><span class="line">            <span class="keyword">if</span> (tree.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">              <span class="keyword">var</span> last = tree[tree.length - <span class="number">1</span>];</span><br><span class="line">              <span class="keyword">if</span> (last.constructor === vm.constructor) &#123;</span><br><span class="line">                currentRecursiveSequence++;</span><br><span class="line">                vm = vm.$parent;</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">              &#125; <span class="keyword">else</span> <span class="keyword">if</span> (currentRecursiveSequence &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                tree[tree.length - <span class="number">1</span>] = [last, currentRecursiveSequence];</span><br><span class="line">                currentRecursiveSequence = <span class="number">0</span>;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            tree.push(vm);</span><br><span class="line">            vm = vm.$parent;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="comment">/* </span></span><br><span class="line"><span class="comment">            \n 表示回车</span></span><br><span class="line"><span class="comment">            recursive calls 递归调用</span></span><br><span class="line"><span class="comment">           */</span></span><br><span class="line">          <span class="keyword">return</span> <span class="string">'\n\nfound in\n\n'</span> + tree</span><br><span class="line">            .map(<span class="function"><span class="keyword">function</span> (<span class="params">vm, i</span>) </span>&#123; <span class="keyword">return</span> (<span class="string">""</span> + (i === <span class="number">0</span> ? <span class="string">'---&gt; '</span> : repeat(<span class="string">' '</span>, <span class="number">5</span> + i * <span class="number">2</span>)) + (<span class="built_in">Array</span>.isArray(vm)</span><br><span class="line">                ? ((formatComponentName(vm[<span class="number">0</span>])) + <span class="string">"... ("</span> + (vm[<span class="number">1</span>]) + <span class="string">" recursive calls)"</span>)</span><br><span class="line">                : formatComponentName(vm))); &#125;)</span><br><span class="line">            .join(<span class="string">'\n'</span>)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="keyword">return</span> (<span class="string">"\n\n(found in "</span> + (formatComponentName(vm)) + <span class="string">")"</span>)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/*  */</span></span><br><span class="line">    <span class="comment">// Vue 中的每个实例对象都有自己的 id</span></span><br><span class="line">    <span class="keyword">var</span> uid = <span class="number">0</span>;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * A dep is an observable that can have multiple</span></span><br><span class="line"><span class="comment">     * directives subscribing to it.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">      Dep 构造函数。</span></span><br><span class="line"><span class="comment">      dep 可观察的, 可以有多个订阅它的指令。</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">var</span> Dep = <span class="function"><span class="keyword">function</span> <span class="title">Dep</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">this</span>.id = uid++;</span><br><span class="line">      <span class="keyword">this</span>.subs = []; <span class="comment">// 这里保存了一个个 Watcher 实例</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// 添加订阅</span></span><br><span class="line">    Dep.prototype.addSub = <span class="function"><span class="keyword">function</span> <span class="title">addSub</span> (<span class="params">sub</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">this</span>.subs.push(sub);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// 移除订阅</span></span><br><span class="line">    Dep.prototype.removeSub = <span class="function"><span class="keyword">function</span> <span class="title">removeSub</span> (<span class="params">sub</span>) </span>&#123;</span><br><span class="line">      remove(<span class="keyword">this</span>.subs, sub);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">      设置某个 Watcher 的依赖</span></span><br><span class="line"><span class="comment">      这里添加了 Dep.target 是否存在的判断，目的是判断是不是 Watcher 的构造函数调用</span></span><br><span class="line"><span class="comment">      也就是说判断他是 Watcher 的 this.get 调用的，而不是普通调用</span></span><br><span class="line"><span class="comment">    */</span>  </span><br><span class="line">    Dep.prototype.depend = <span class="function"><span class="keyword">function</span> <span class="title">depend</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="comment">// Dep.target 是一个全局可访问的渲染 Watcher</span></span><br><span class="line">      <span class="keyword">if</span> (Dep.target) &#123;</span><br><span class="line">        <span class="comment">// 调用 add 方法, 把要进行渲染的 Watcher 与当前 Dep 实例关联起来, Vue 中存在非常多的相互引用</span></span><br><span class="line">        Dep.target.addDep(<span class="keyword">this</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    Dep.prototype.notify = <span class="function"><span class="keyword">function</span> <span class="title">notify</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="comment">// stabilize the subscriber list first</span></span><br><span class="line">      <span class="keyword">var</span> subs = <span class="keyword">this</span>.subs.slice();</span><br><span class="line">      <span class="keyword">if</span> (!config.async) &#123;</span><br><span class="line">        <span class="comment">// subs aren't sorted in scheduler if not running async</span></span><br><span class="line">        <span class="comment">// we need to sort them now to make sure they fire in correct</span></span><br><span class="line">        <span class="comment">// order</span></span><br><span class="line">        <span class="comment">/*   </span></span><br><span class="line"><span class="comment">          如果配置项中未运行异步，则子程序不会在调度程序中排序</span></span><br><span class="line"><span class="comment">          我们需要立即对它们进行排序，以确保其正确发射</span></span><br><span class="line"><span class="comment">          这相当于控制事件执行顺序, 将其排序以保证按顺序执行。</span></span><br><span class="line"><span class="comment">          排序</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        subs.sort(<span class="function"><span class="keyword">function</span> (<span class="params">a, b</span>) </span>&#123; <span class="keyword">return</span> a.id - b.id; &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, l = subs.length; i &lt; l; i++) &#123;</span><br><span class="line">        <span class="comment">// 调用 subs 数组中每一个 Watcher 的 update 方法, 更新视图</span></span><br><span class="line">        subs[i].update();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">// The current target watcher being evaluated.</span></span><br><span class="line">    <span class="comment">// This is globally unique because only one watcher</span></span><br><span class="line">    <span class="comment">// can be evaluated at a time.</span></span><br><span class="line">    <span class="comment">/* 当前全局的渲染 Watcher, 它是全局唯一的，因为一次只能调用一个观察者。每当 Watcher 需要被渲染的时候，它就即将成为全局 Watcher, 当渲染结束后, 从全局中离开, 但仍存在 */</span></span><br><span class="line">    Dep.target = <span class="literal">null</span>;</span><br><span class="line">    <span class="comment">// Dep.target 栈, 即存放需要挂在到全局上的 Watcher 对象的栈</span></span><br><span class="line">    <span class="keyword">var</span> targetStack = [];</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">pushTarget</span> (<span class="params">target</span>) </span>&#123;</span><br><span class="line">      targetStack.push(target);</span><br><span class="line">      Dep.target = target;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">popTarget</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      targetStack.pop();</span><br><span class="line">      Dep.target = targetStack[targetStack.length - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/*  */</span></span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">      Vue 核心 Vnode 构造函数</span></span><br><span class="line"><span class="comment">      Vnode 表示虚拟节点, 把 DOM 标签, 属性, 内容都变成对象的属性, 用 JS 对象来描述真实 DOM</span></span><br><span class="line"><span class="comment">      什么用？</span></span><br><span class="line"><span class="comment">      1、兼容性强，不受执行环境的影响。VNode 因为是 JS 对象，不管 Node 还是 浏览器，都可以统一操作， 从而获得了服务端渲染、原生渲染、手写渲染函数等能力</span></span><br><span class="line"><span class="comment">      2、减少操作 DOM。任何页面的变化，都只使用 VNode 进行操作对比，只需要在最后一步挂载更新DOM，不需要频繁操作DOM，从而提高页面性能</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">      用法 比如用 Vnode 描述这样一个 template</span></span><br><span class="line"><span class="comment">      &lt;div class="parent" style="height:0" href="2222"&gt;</span></span><br><span class="line"><span class="comment">        111111</span></span><br><span class="line"><span class="comment">      &lt;/div&gt;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">      可以得到</span></span><br><span class="line"><span class="comment">      &#123;    </span></span><br><span class="line"><span class="comment">        tag: 'div',    </span></span><br><span class="line"><span class="comment">        data: &#123;        </span></span><br><span class="line"><span class="comment">          attrs: &#123; href:"2222" &#125;</span></span><br><span class="line"><span class="comment">          staticClass: "parent",        </span></span><br><span class="line"><span class="comment">          staticStyle: &#123;            </span></span><br><span class="line"><span class="comment">            height: "0"</span></span><br><span class="line"><span class="comment">          &#125;</span></span><br><span class="line"><span class="comment">        &#125;,    </span></span><br><span class="line"><span class="comment">        children: [&#123;        </span></span><br><span class="line"><span class="comment">          tag: undefined,        </span></span><br><span class="line"><span class="comment">          text: "111111"</span></span><br><span class="line"><span class="comment">        &#125;]</span></span><br><span class="line"><span class="comment">      &#125;</span></span><br><span class="line"><span class="comment">      这个 JS 对象，就已经囊括了整个模板的所有信息，完全可以根据这个对象来构造真实DOM了</span></span><br><span class="line"><span class="comment">      VNode存放什么信息</span></span><br><span class="line"><span class="comment">      新建一个 vNode 的时候，包含了非常多的属性，每个属性都是节点的描述的一部分</span></span><br><span class="line"><span class="comment">      我们只捡一些属性来探索一下，了解主体即可</span></span><br><span class="line"><span class="comment">      1、普通属性</span></span><br><span class="line"><span class="comment">        1、data</span></span><br><span class="line"><span class="comment">        1、存储节点的属性，class，style 等</span></span><br><span class="line"><span class="comment">        2、存储绑定的事件</span></span><br><span class="line"><span class="comment">        3、....其他</span></span><br><span class="line"><span class="comment">      2、elm</span></span><br><span class="line"><span class="comment">        真实 DOM 节点</span></span><br><span class="line"><span class="comment">        生成 VNode 的时候，并不存在真实 DOM</span></span><br><span class="line"><span class="comment">        elm 会在需要创建 DOM 时完成赋值，具体函数在 createElm 中</span></span><br><span class="line"><span class="comment">        赋值语句就是一句（简化了源码）vNode.elm = document.createElement(tag)  </span></span><br><span class="line"><span class="comment">      3、context</span></span><br><span class="line"><span class="comment">        渲染这个模板的上下文对象</span></span><br><span class="line"><span class="comment">        意思就是，template 里面的动态数据要从这个 context 中获取，而 context 就是 Vue 实例</span></span><br><span class="line"><span class="comment">        如果是页面，那么 context 就是本页面的实例，如果是组件，context 则是组件的实例</span></span><br><span class="line"><span class="comment">      4 isStatic</span></span><br><span class="line"><span class="comment">        是否是静态节点</span></span><br><span class="line"><span class="comment">        当一个节点被标记为静态节点的时候，说明这个节点可以不用去更新它了，当数据变化的时候，可以忽略去比对他，以提高比对效率</span></span><br><span class="line"><span class="comment">      组件相关属性</span></span><br><span class="line"><span class="comment">        1、parent</span></span><br><span class="line"><span class="comment">          这个parent 表示是组件的外壳节点</span></span><br><span class="line"><span class="comment">          额，什么是外壳节点，举个栗子先吧, 在页面中使用组件</span></span><br><span class="line"><span class="comment">          components: &#123; test: &#123; template: '&lt;h2&gt;wdnmd&lt;/h2&gt;' &#125; &#125;</span></span><br><span class="line"><span class="comment">          &lt;div&gt;</span></span><br><span class="line"><span class="comment">            &#123;&#123; name &#125;&#125; &lt;test&gt;&lt;/test&gt;</span></span><br><span class="line"><span class="comment">          &lt;/div&gt;</span></span><br><span class="line"><span class="comment">          这时候会发现, test 其实有两个 VNode</span></span><br><span class="line"><span class="comment">            1. 页面给组件 test 生成的 </span></span><br><span class="line"><span class="comment">            &#123;</span></span><br><span class="line"><span class="comment">              tag: 'test',</span></span><br><span class="line"><span class="comment">              children: undefined</span></span><br><span class="line"><span class="comment">            &#125;</span></span><br><span class="line"><span class="comment">            2. 组件内部生成的</span></span><br><span class="line"><span class="comment">            &#123;</span></span><br><span class="line"><span class="comment">              tag: 'h2',</span></span><br><span class="line"><span class="comment">              children: [</span></span><br><span class="line"><span class="comment">                &#123; tag: undefined, text: 'wdnmd' &#125;</span></span><br><span class="line"><span class="comment">              ]</span></span><br><span class="line"><span class="comment">            &#125;</span></span><br><span class="line"><span class="comment">          这两种 VNode 都是正确的, 最后尤大判定第一个 VNode 是 第二个 VNode 的爸爸，也就是外壳节点 第二个组件还有一个 parent 属性, 指向第一个 VNode</span></span><br><span class="line"><span class="comment">        2 componentInstance</span></span><br><span class="line"><span class="comment">          这个顾名思义，就是组件生成的实例，保存在这里</span></span><br><span class="line"><span class="comment">          上面 test 组件的外壳节点中的 componentInstance</span></span><br><span class="line"><span class="comment">        3 componentOptions</span></span><br><span class="line"><span class="comment">          这个就存储一些 父子组件 PY 交易的证据</span></span><br><span class="line"><span class="comment">          比如 props，事件，slot 什么的，打印看下</span></span><br><span class="line"><span class="comment">          componentOptions:</span></span><br><span class="line"><span class="comment">           Ctor: VueComponents</span></span><br><span class="line"><span class="comment">           children: [Vnode]</span></span><br><span class="line"><span class="comment">           listeners: &#123;event: f&#125;</span></span><br><span class="line"><span class="comment">           propsData: &#123;name: '111'&#125;</span></span><br><span class="line"><span class="comment">           tag: 'test'</span></span><br><span class="line"><span class="comment">          其中 children 保存的就是 slot，listeners 保存 事件，propsData 保存 props</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">var</span> VNode = <span class="function"><span class="keyword">function</span> <span class="title">VNode</span> (<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">      tag, <span class="regexp">//</span> 标签名</span></span></span><br><span class="line"><span class="function"><span class="params">      data,</span></span></span><br><span class="line"><span class="function"><span class="params">      children, <span class="regexp">//</span> 子元素</span></span></span><br><span class="line"><span class="function"><span class="params">      text, <span class="regexp">//</span> 文本内容</span></span></span><br><span class="line"><span class="function"><span class="params">      elm, <span class="regexp">//</span> Dom 节点</span></span></span><br><span class="line"><span class="function"><span class="params">      context,</span></span></span><br><span class="line"><span class="function"><span class="params">      componentOptions,</span></span></span><br><span class="line"><span class="function"><span class="params">      asyncFactory</span></span></span><br><span class="line"><span class="function"><span class="params">    </span>) </span>&#123;</span><br><span class="line">      <span class="keyword">this</span>.tag = tag;</span><br><span class="line">      <span class="keyword">this</span>.data = data;</span><br><span class="line">      <span class="keyword">this</span>.children = children;</span><br><span class="line">      <span class="keyword">this</span>.text = text;</span><br><span class="line">      <span class="keyword">this</span>.elm = elm;</span><br><span class="line">      <span class="keyword">this</span>.ns = <span class="literal">undefined</span>;</span><br><span class="line">      <span class="keyword">this</span>.context = context;</span><br><span class="line">      <span class="keyword">this</span>.fnContext = <span class="literal">undefined</span>;</span><br><span class="line">      <span class="keyword">this</span>.fnOptions = <span class="literal">undefined</span>;</span><br><span class="line">      <span class="keyword">this</span>.fnScopeId = <span class="literal">undefined</span>;</span><br><span class="line">      <span class="keyword">this</span>.key = data &amp;&amp; data.key; <span class="comment">// 短路写法. data 存在就返回 data.key, 否则返回 undefined</span></span><br><span class="line">      <span class="keyword">this</span>.componentOptions = componentOptions;</span><br><span class="line">      <span class="keyword">this</span>.componentInstance = <span class="literal">undefined</span>;</span><br><span class="line">      <span class="keyword">this</span>.parent = <span class="literal">undefined</span>;</span><br><span class="line">      <span class="keyword">this</span>.raw = <span class="literal">false</span>;</span><br><span class="line">      <span class="keyword">this</span>.isStatic = <span class="literal">false</span>; <span class="comment">// 是否静态节点</span></span><br><span class="line">      <span class="keyword">this</span>.isRootInsert = <span class="literal">true</span>;</span><br><span class="line">      <span class="keyword">this</span>.isComment = <span class="literal">false</span>; <span class="comment">// 是否注释节点</span></span><br><span class="line">      <span class="keyword">this</span>.isCloned = <span class="literal">false</span>; <span class="comment">// 是否克隆节点</span></span><br><span class="line">      <span class="keyword">this</span>.isOnce = <span class="literal">false</span>;</span><br><span class="line">      <span class="keyword">this</span>.asyncFactory = asyncFactory;</span><br><span class="line">      <span class="keyword">this</span>.asyncMeta = <span class="literal">undefined</span>;</span><br><span class="line">      <span class="keyword">this</span>.isAsyncPlaceholder = <span class="literal">false</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">      如果没有设置 get, set 默认设置的是数据属性描述符对象, 否则设置的是访问器属性描述符对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">var</span> prototypeAccessors = &#123; <span class="attr">child</span>: &#123; <span class="attr">configurable</span>: <span class="literal">true</span> &#125; &#125;;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">// DEPRECATED: alias for componentInstance for backwards compat.</span></span><br><span class="line">    <span class="comment">// 已弃用：向后兼容的 componentInstance 的别名</span></span><br><span class="line">    <span class="comment">/* istanbul ignore next */</span></span><br><span class="line">    prototypeAccessors.child.get = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">this</span>.componentInstance</span><br><span class="line">    &#125;;</span><br><span class="line">  </span><br><span class="line">    <span class="built_in">Object</span>.defineProperties( VNode.prototype, prototypeAccessors );</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">var</span> createEmptyVNode = <span class="function"><span class="keyword">function</span> (<span class="params">text</span>) </span>&#123;</span><br><span class="line">      <span class="comment">/* </span></span><br><span class="line"><span class="comment">        void 返回值永远是 undefined, 可以说, 使用 void 就是为了得到 undefined, 这在源码中非常常见</span></span><br><span class="line"><span class="comment">        为什么不直接使用 undefined? </span></span><br><span class="line"><span class="comment">        1. undefined 并不是 JS 保留字, 所以你有时候不能放心使用 undefined, 在这一点上 null 就不一样, 它是保留字, 可以放心的被使用</span></span><br><span class="line"><span class="comment">        2. void 0 比 undefined 少几个字符, 这应该不太算是好处, 牺牲了可读性</span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line">      <span class="keyword">if</span> ( text === <span class="keyword">void</span> <span class="number">0</span> ) text = <span class="string">''</span>;</span><br><span class="line">  </span><br><span class="line">      <span class="keyword">var</span> node = <span class="keyword">new</span> VNode();</span><br><span class="line">      node.text = text;</span><br><span class="line">      node.isComment = <span class="literal">true</span>;</span><br><span class="line">      <span class="keyword">return</span> node</span><br><span class="line">    &#125;;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">createTextVNode</span> (<span class="params">val</span>) </span>&#123;</span><br><span class="line">      <span class="comment">/*</span></span><br><span class="line"><span class="comment">        VNode 长这样</span></span><br><span class="line"><span class="comment">        var VNode = function VNode (</span></span><br><span class="line"><span class="comment">        tag,</span></span><br><span class="line"><span class="comment">        data,</span></span><br><span class="line"><span class="comment">        children,</span></span><br><span class="line"><span class="comment">        text,</span></span><br><span class="line"><span class="comment">        elm,</span></span><br><span class="line"><span class="comment">        context,</span></span><br><span class="line"><span class="comment">        componentOptions,</span></span><br><span class="line"><span class="comment">        asyncFactory</span></span><br><span class="line"><span class="comment">      )</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">      创建文本节点</span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> VNode(<span class="literal">undefined</span>, <span class="literal">undefined</span>, <span class="literal">undefined</span>, <span class="built_in">String</span>(val))</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">// optimized shallow clone</span></span><br><span class="line">    <span class="comment">// used for static nodes and slot nodes because they may be reused across</span></span><br><span class="line">    <span class="comment">// multiple renders, cloning them avoids errors when DOM manipulations rely</span></span><br><span class="line">    <span class="comment">// on their elm reference.</span></span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">      优化的浅拷贝</span></span><br><span class="line"><span class="comment">      用于静态节点和插槽节点，因为它们可以在多个节点之间重用</span></span><br><span class="line"><span class="comment">      多个渲染，拷贝它们可以避免在 DOM 操作依赖于它们的 elm 时出错</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">cloneVNode</span> (<span class="params">vnode</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> cloned = <span class="keyword">new</span> VNode(</span><br><span class="line">        vnode.tag,</span><br><span class="line">        vnode.data,</span><br><span class="line">        <span class="comment">// #7975</span></span><br><span class="line">        <span class="comment">// clone children array to avoid mutating original in case of cloning</span></span><br><span class="line">        <span class="comment">// a child.</span></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">          拷贝 children 数组以避免在拷贝 child 的情况下变异原始对象。</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        vnode.children &amp;&amp; vnode.children.slice(),</span><br><span class="line">        vnode.text,</span><br><span class="line">        vnode.elm,</span><br><span class="line">        vnode.context,</span><br><span class="line">        vnode.componentOptions,</span><br><span class="line">        vnode.asyncFactory</span><br><span class="line">      );</span><br><span class="line">      cloned.ns = vnode.ns;</span><br><span class="line">      cloned.isStatic = vnode.isStatic;</span><br><span class="line">      cloned.key = vnode.key;</span><br><span class="line">      cloned.isComment = vnode.isComment;</span><br><span class="line">      cloned.fnContext = vnode.fnContext;</span><br><span class="line">      cloned.fnOptions = vnode.fnOptions;</span><br><span class="line">      cloned.fnScopeId = vnode.fnScopeId;</span><br><span class="line">      cloned.asyncMeta = vnode.asyncMeta;</span><br><span class="line">      cloned.isCloned = <span class="literal">true</span>;</span><br><span class="line">      <span class="keyword">return</span> cloned</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * not type checking this file because flow doesn't play well with</span></span><br><span class="line"><span class="comment">     * dynamically accessing methods on Array prototype</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">      不要类型检查此文件，因为 flow 不能与动态访问数组原型上的方法很好地配合</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 创建新的数组原型，插入到被响应化的数组的原型链上，用于劫持响应式的数组方法</span></span><br><span class="line"><span class="comment">    * 本来 arr =&gt; Array.prototype =&gt; Object.prototype =&gt; ...</span></span><br><span class="line"><span class="comment">    * 现在 arr =&gt; arrayProto =&gt; Array.prototype =&gt; Object.prototype</span></span><br><span class="line"><span class="comment">    * 这是切片编程，切开插点东西进去</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">var</span> arrayProto = <span class="built_in">Array</span>.prototype;</span><br><span class="line">    <span class="keyword">var</span> arrayMethods = <span class="built_in">Object</span>.create(arrayProto);</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">var</span> methodsToPatch = [</span><br><span class="line">      <span class="string">'push'</span>,</span><br><span class="line">      <span class="string">'pop'</span>,</span><br><span class="line">      <span class="string">'shift'</span>,</span><br><span class="line">      <span class="string">'unshift'</span>,</span><br><span class="line">      <span class="string">'splice'</span>,</span><br><span class="line">      <span class="string">'sort'</span>,</span><br><span class="line">      <span class="string">'reverse'</span></span><br><span class="line">    ];</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Intercept mutating methods and emit events</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">      拦截变异方法并发出事件</span></span><br><span class="line"><span class="comment">      遍历会改变数组成员的数组方法，将其响应式化</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    methodsToPatch.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">method</span>) </span>&#123;</span><br><span class="line">      <span class="comment">// cache original method</span></span><br><span class="line">      <span class="comment">// 保存原本方法，等一下因为等一下原生方法就要被覆盖找不到了，这个变量将在新值响应式化过程中调用</span></span><br><span class="line">      <span class="keyword">var</span> original = arrayProto[method];</span><br><span class="line">      <span class="comment">/*</span></span><br><span class="line"><span class="comment">        function def (obj, key, val, enumerable) &#123;</span></span><br><span class="line"><span class="comment">          Object.defineProperty(obj, key, &#123;</span></span><br><span class="line"><span class="comment">            value: val,</span></span><br><span class="line"><span class="comment">            enumerable: !!enumerable,</span></span><br><span class="line"><span class="comment">            writable: true,</span></span><br><span class="line"><span class="comment">            configurable: true</span></span><br><span class="line"><span class="comment">          &#125;);</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">        这里通过 def 来重新定义 method, 并且可以将 method 设为不可枚举的属性。</span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line">      def(arrayMethods, method, <span class="function"><span class="keyword">function</span> <span class="title">mutator</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 保存传入的参数</span></span><br><span class="line">        <span class="keyword">var</span> args = [], len = <span class="built_in">arguments</span>.length;</span><br><span class="line">        <span class="keyword">while</span> ( len-- ) args[ len ] = <span class="built_in">arguments</span>[ len ];</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 传入调用方法时原本的上下文对象, 调用原生数组方法，并拿到原生方法的返回值，到时候用于返回</span></span><br><span class="line">        <span class="keyword">var</span> result = original.apply(<span class="keyword">this</span>, args);</span><br><span class="line">        <span class="comment">// 拿到该数组上定义的 ob 实例</span></span><br><span class="line">        <span class="keyword">var</span> ob = <span class="keyword">this</span>.__ob__;</span><br><span class="line">        <span class="comment">// 定义插入的值, 里面存放要被插入数组的值，本身是一个数组</span></span><br><span class="line">        <span class="keyword">var</span> inserted;</span><br><span class="line">        <span class="keyword">switch</span> (method) &#123;</span><br><span class="line">          <span class="comment">// push 的短路写法，不写 break, 继续执行下一个选项的代码块</span></span><br><span class="line">          <span class="keyword">case</span> <span class="string">'push'</span>:</span><br><span class="line">          <span class="keyword">case</span> <span class="string">'unshift'</span>:</span><br><span class="line">            inserted = args;</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">          <span class="keyword">case</span> <span class="string">'splice'</span>:</span><br><span class="line">            <span class="comment">// splice(startIndex, delNum, newItem) 有三个参数，开始下标，删除数目，新插入的值。</span></span><br><span class="line">            inserted = args.slice(<span class="number">2</span>);</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 如果存在新插入的值的数组，遍历它，并将其中的每一项都响应式化</span></span><br><span class="line">        <span class="keyword">if</span> (inserted) &#123; ob.observeArray(inserted); &#125;</span><br><span class="line">        <span class="comment">// notify change</span></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">          通知更新 Watch 更新</span></span><br><span class="line"><span class="comment">          拿到 ob 实例上的 Dep 实例, 调用 notify, 将会通知该 Dep 实例上的 subs 数组中的所有 Watcher 执行 update 方法</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        ob.dep.notify();</span><br><span class="line">        <span class="comment">// 返回调用原数组方法的结果。</span></span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/*  */</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">      Object.getOwnPropertyNames(obj) 方法返回对象的所有自身属性的属性名（包括不可枚举的属性）组成的数组，但不会获取原型链上的属性。</span></span><br><span class="line"><span class="comment">      不可枚举是指</span></span><br><span class="line"><span class="comment">      // 不可枚举方法</span></span><br><span class="line"><span class="comment">      Object.defineProperty(obj, 'myMethod', &#123;</span></span><br><span class="line"><span class="comment">        enumerable: false,</span></span><br><span class="line"><span class="comment">        value: function() &#123;&#125;</span></span><br><span class="line"><span class="comment">      &#125;);</span></span><br><span class="line"><span class="comment">      Object.getOwnPropertyNames(obj) // ['myMethod']</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">      // 返回对象自身的属性名，不包括不可枚举属性</span></span><br><span class="line"><span class="comment">      Object.keys(obj) // []</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">var</span> arrayKeys = <span class="built_in">Object</span>.getOwnPropertyNames(arrayMethods);</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * In some cases we may want to disable observation inside a component's</span></span><br><span class="line"><span class="comment">     * update computation.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">      在某些情况下，我们可能希望禁用组件更新计算中的观察。</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">var</span> shouldObserve = <span class="literal">true</span>;</span><br><span class="line">    <span class="comment">// 修改组件中是否需要更新的状态</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">toggleObserving</span> (<span class="params">value</span>) </span>&#123;</span><br><span class="line">      shouldObserve = value;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Observer class that is attached to each observed</span></span><br><span class="line"><span class="comment">     * object. Once attached, the observer converts the target</span></span><br><span class="line"><span class="comment">     * object's property keys into getter/setters that</span></span><br><span class="line"><span class="comment">     * collect dependencies and dispatch updates.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">      附加到每个观察对象的 Observer 类。附加后，观察者将目标对象的属性键转换为用于收集依赖性和调度更新的 getter / setter。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">      Vue 核心 Observer 实例</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">var</span> Observer = <span class="function"><span class="keyword">function</span> <span class="title">Observer</span> (<span class="params">value</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">this</span>.value = value;</span><br><span class="line">      <span class="comment">// 新建 dep 数据，到时候存放依赖</span></span><br><span class="line">      <span class="keyword">this</span>.dep = <span class="keyword">new</span> Dep();</span><br><span class="line">      <span class="comment">// vm 实例数量</span></span><br><span class="line">      <span class="keyword">this</span>.vmCount = <span class="number">0</span>;</span><br><span class="line">      <span class="comment">/*</span></span><br><span class="line"><span class="comment">        给 value 添加 __ob__ 属性，值就是该 Observer 实例</span></span><br><span class="line"><span class="comment">        Vue.$data 中每个对象都有 __ob__ 属性,包括 Vue.$data 对象本身</span></span><br><span class="line"><span class="comment">        通过 def 来设置新值，不设置第四个参数相当于 enumerable: !!undefined</span></span><br><span class="line"><span class="comment">        即 enumerable: false, 不可枚举，将不会被 Object.keys() 遍历，因此不会无限递归</span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line">      def(value, <span class="string">'__ob__'</span>, <span class="keyword">this</span>);</span><br><span class="line">      <span class="keyword">if</span> (<span class="built_in">Array</span>.isArray(value)) &#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">          全文只用了这一次 hasProto</span></span><br><span class="line"><span class="comment">          // can we use __proto__?</span></span><br><span class="line"><span class="comment">          var hasProto = '__proto__' in &#123;&#125;; </span></span><br><span class="line"><span class="comment">          </span></span><br><span class="line"><span class="comment">          判断是否为数组，不是的话调用 walk() 添加 getter 和 setter </span></span><br><span class="line"><span class="comment">          如果是数组，调用 observeArray() 遍历数组，为数组内每个对象添加 getter 和 setter </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">          卧槽, 原来数组也能用 Object.defineProperty() 加属性啊。。</span></span><br><span class="line"><span class="comment">                  </span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="comment">// 这个 if 用于将数组方法改写。</span></span><br><span class="line">        <span class="keyword">if</span> (hasProto) &#123;</span><br><span class="line">          <span class="comment">// 如果有 __proto__ 则在被响应式化的数组原型链上新建一个数组原型，用于劫持数组的 7 个修改数组的方法</span></span><br><span class="line">          protoAugment(value, arrayMethods);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="comment">// 如果没有，就直接在该数组本身上改写那 7 个方法。</span></span><br><span class="line">          copyAugment(value, arrayMethods, arrayKeys);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 将数组内的每一项响应式化</span></span><br><span class="line">        <span class="keyword">this</span>.observeArray(value);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 不是数组就调用 walk</span></span><br><span class="line">        <span class="keyword">this</span>.walk(value);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Walk through all properties and convert them into</span></span><br><span class="line"><span class="comment">     * getter/setters. This method should only be called when</span></span><br><span class="line"><span class="comment">     * value type is Object.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">      遍历所有属性并将它们转换为 getter / setter。仅当值类型为Object 时才应调用此方法。</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    Observer.prototype.walk = <span class="function"><span class="keyword">function</span> <span class="title">walk</span> (<span class="params">obj</span>) </span>&#123;</span><br><span class="line">      <span class="comment">/*</span></span><br><span class="line"><span class="comment">        Object.keys() 用于获取对象自身所有的可枚举的属性值，但不包括原型中的属性，然后返回一个由属性名组成的数组。注意它同 for..in 一样不能保证属性按对象原来的顺序输出。</span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line">      <span class="keyword">var</span> keys = <span class="built_in">Object</span>.keys(obj);</span><br><span class="line">      <span class="comment">// 遍历对象的属性，并将其响应式化</span></span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; keys.length; i++) &#123;</span><br><span class="line">        defineReactive$$<span class="number">1</span>(obj, keys[i]);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Observe a list of Array items.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">      观察数组项列表。</span></span><br><span class="line"><span class="comment">      遍历传入的数组的每一项，递归调用 observe 方法，尝试创建新的 Observer 实例</span></span><br><span class="line"><span class="comment">      等一下可以看到 observe 如果传入一个基本类型值，它将什么都不做</span></span><br><span class="line"><span class="comment">      因此数组中的基本类型值将不会被响应式化，这可能是考虑到性能问题，数组一般很长</span></span><br><span class="line"><span class="comment">      并且我们几乎不用 a[index] = newVal 来操作数组。</span></span><br><span class="line"><span class="comment">      所以没有必要将基本类型值响应式化</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    Observer.prototype.observeArray = <span class="function"><span class="keyword">function</span> <span class="title">observeArray</span> (<span class="params">items</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, l = items.length; i &lt; l; i++) &#123;</span><br><span class="line">        <span class="comment">// 递归</span></span><br><span class="line">        observe(items[i]);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">// helpers</span></span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Augment a target Object or Array by intercepting</span></span><br><span class="line"><span class="comment">     * the prototype chain using __proto__</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">// 改写 target 数组的原型链</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">protoAugment</span> (<span class="params">target, src</span>) </span>&#123;</span><br><span class="line">      <span class="comment">/* eslint-disable no-proto */</span></span><br><span class="line">      target.__proto__ = src;</span><br><span class="line">      <span class="comment">/* eslint-enable no-proto */</span></span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Augment a target Object or Array by defining</span></span><br><span class="line"><span class="comment">     * hidden properties.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">// 如果不存在 __proto__, 直接在 target 上重写数组方法来覆盖原型链上得到的方法</span></span><br><span class="line">    <span class="comment">/* istanbul ignore next */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">copyAugment</span> (<span class="params">target, src, keys</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, l = keys.length; i &lt; l; i++) &#123;</span><br><span class="line">        <span class="keyword">var</span> key = keys[i];</span><br><span class="line">        def(target, key, src[key]);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Attempt to create an observer instance for a value,</span></span><br><span class="line"><span class="comment">     * returns the new observer if successfully observed,</span></span><br><span class="line"><span class="comment">     * or the existing observer if the value already has one.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 尝试为某个值创建一个观察者实例，如果成功观察到该观察者，则返回新的观察者</span></span><br><span class="line"><span class="comment">     * 如果该值已有一个观察者，则返回现有的观察者。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">observe</span> (<span class="params">value, asRootData</span>) </span>&#123;</span><br><span class="line">      <span class="comment">// 如果值不是对象或值是 VNode 什么都不做。</span></span><br><span class="line">      <span class="keyword">if</span> (!isObject(value) || value <span class="keyword">instanceof</span> VNode) &#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">var</span> ob;</span><br><span class="line">      <span class="comment">// hasOwn(obj, prop) 就是 obj.hasOwnProperty(prop) 方法，为了写起来更短，定义了这么一个方法</span></span><br><span class="line">      <span class="comment">// 判断该对象上是否有 __ob__ 属性，并且该属性是 Ob 实例，那么就返回它</span></span><br><span class="line">      <span class="keyword">if</span> (hasOwn(value, <span class="string">'__ob__'</span>) &amp;&amp; value.__ob__ <span class="keyword">instanceof</span> Observer) &#123;</span><br><span class="line">        ob = value.__ob__;</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (</span><br><span class="line">        <span class="comment">// 否则判断一下</span></span><br><span class="line">        shouldObserve &amp;&amp; <span class="comment">// 是否需要被观察，这属性是上面定义的，默认为 true</span></span><br><span class="line">        !isServerRendering() &amp;&amp; <span class="comment">// 是否为服务端渲染</span></span><br><span class="line">        (<span class="built_in">Array</span>.isArray(value) || isPlainObject(value)) &amp;&amp; <span class="comment">// value 为数组或普通对象</span></span><br><span class="line">        <span class="built_in">Object</span>.isExtensible(value) &amp;&amp; <span class="comment">// value 是否可拓展，即是否可以为 value 添加新属性，默认可拓展。Object.preventExtensions，Object.seal 或 Object.freeze 方法都可以标记一个对象为不可扩展（non-extensible）。</span></span><br><span class="line">        !value._isVue <span class="comment">// value._isVue 是个是否渲染的标志，默认情况下没有该值，因此 value.!_isVue 始终为 true，在 Vue init 时，会将 _isVue 改为 true，防止被 observe</span></span><br><span class="line">      ) &#123;</span><br><span class="line">        <span class="comment">// 满足上面的条件就新建一个 Ob 实例</span></span><br><span class="line">        ob = <span class="keyword">new</span> Observer(value);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// asRootData 是否为根属性，它是个布尔值，在 Vue init 的时候会将其设置为 true</span></span><br><span class="line">      <span class="keyword">if</span> (asRootData &amp;&amp; ob) &#123;</span><br><span class="line">        <span class="comment">// 如果是根属性，即 $data 的 Ob, 就给它一个计数, 作为标志, 每有一个实例, 计数就加一</span></span><br><span class="line">        ob.vmCount++; <span class="comment">// 统计有多少个 vm 实例</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> ob</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Define a reactive property on an Object.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">      在对象上定义反应性属性。</span></span><br><span class="line"><span class="comment">      Vue 核心 双向绑定，其中传入的 val ，是一个闭包，将一直存在于该函数作用域内, 并且也只有该函数能使用</span></span><br><span class="line"><span class="comment">      这个闭包解决了 Object.defineProperty 的访问器必须依赖于某个全局的值的问题(平常写的时候这个被依赖的值很有可能是在全局都能访问的)</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">defineReactive$$1</span> (<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">      obj, <span class="regexp">//</span> 要响应式的对象</span></span></span><br><span class="line"><span class="function"><span class="params">      key, <span class="regexp">//</span> 要响应式的键名</span></span></span><br><span class="line"><span class="function"><span class="params">      val, <span class="regexp">//</span> 要响应式原本的键值，现在，它变成了访问器属性的容器</span></span></span><br><span class="line"><span class="function"><span class="params">      customSetter,</span></span></span><br><span class="line"><span class="function"><span class="params">      shallow</span></span></span><br><span class="line"><span class="function"><span class="params">    </span>) </span>&#123;</span><br><span class="line">      <span class="comment">// 新建一个 Dep 实例</span></span><br><span class="line">      <span class="keyword">var</span> dep = <span class="keyword">new</span> Dep();</span><br><span class="line">      <span class="comment">// 获取 obj 对象上 key 的描述属性，如果是不可修改的，就什么都不做，直接 return</span></span><br><span class="line">      <span class="keyword">var</span> property = <span class="built_in">Object</span>.getOwnPropertyDescriptor(obj, key);</span><br><span class="line">      <span class="keyword">if</span> (property &amp;&amp; property.configurable === <span class="literal">false</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">      &#125;</span><br><span class="line">  </span><br><span class="line">      <span class="comment">// cater for pre-defined getter/setters</span></span><br><span class="line">      <span class="comment">// 获取已定义的 setters / setter 方法(修改 $ 前缀的属性时会触发)，由于等会儿会修改 get 和 set, 先将其保存一份</span></span><br><span class="line">      <span class="keyword">var</span> getter = property &amp;&amp; property.get;</span><br><span class="line">      <span class="keyword">var</span> setter = property &amp;&amp; property.set;</span><br><span class="line">      <span class="comment">// 如果没有 get 或有 set, 同时只传了两个参数, 那就直接返回该对象的键值。</span></span><br><span class="line">      <span class="keyword">if</span> ((!getter || setter) &amp;&amp; <span class="built_in">arguments</span>.length === <span class="number">2</span>) &#123;</span><br><span class="line">        val = obj[key];</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 递归子属性，shallow 默认为 undefined, 在设置 $ 前缀的属性是会变成 true, 也就是说那时候不需要递归子属性</span></span><br><span class="line">      <span class="keyword">var</span> childOb = !shallow &amp;&amp; observe(val);</span><br><span class="line">      <span class="comment">// Vue2.0 双向绑定</span></span><br><span class="line">      <span class="built_in">Object</span>.defineProperty(obj, key, &#123;</span><br><span class="line">        enumerable: <span class="literal">true</span>,</span><br><span class="line">        configurable: <span class="literal">true</span>,</span><br><span class="line">        <span class="comment">// 依赖收集</span></span><br><span class="line">        <span class="keyword">get</span>: function reactiveGetter () &#123;</span><br><span class="line">          <span class="comment">// 是否有已定义的 getter, 如果有就调用它, 没有就把闭包的 val 赋值给 value</span></span><br><span class="line">          <span class="keyword">var</span> value = getter ? getter.call(obj) : val;</span><br><span class="line">          <span class="comment">// 是否存在 Dep.target, 因为有时候获取属性并不需要更新视图或计算属性、watch，就不需要收集该依赖。比如 console.log(this.name) 时，就没有 target, 不需要收集该依赖</span></span><br><span class="line">          <span class="comment">// 如果存在 Dep.target, 说明是全局 Watcher 在获取该属性，需要进行依赖收集</span></span><br><span class="line">          <span class="keyword">if</span> (Dep.target) &#123;</span><br><span class="line">          <span class="comment">/*</span></span><br><span class="line"><span class="comment">            Dep.target 全局变量指向的就是当前正在解析指令 Complie 的 Watcher</span></span><br><span class="line"><span class="comment">            会执行 dep.addSub(Dep.target), 将 Watcher 添加到 Dep 对象的 Watcher 列表中, 互相引用</span></span><br><span class="line"><span class="comment">          */</span></span><br><span class="line">            <span class="comment">// 依赖收集, 将当前 Watcher 添加到 subs 数组中</span></span><br><span class="line">            dep.depend();</span><br><span class="line">            <span class="comment">// 如果存在子 Ob</span></span><br><span class="line">            <span class="keyword">if</span> (childOb) &#123;</span><br><span class="line">              <span class="comment">// 子 Ob 的 subs 也收录当前 Watcher</span></span><br><span class="line">              childOb.dep.depend();</span><br><span class="line">              <span class="comment">// 如果 value 是数组</span></span><br><span class="line">              <span class="keyword">if</span> (<span class="built_in">Array</span>.isArray(value)) &#123;</span><br><span class="line">                <span class="comment">// 调用 dependArray, 调用数组中, 值为对象或数组的 __ob__ 的 dep 的 depend, 也收录当前 Watcher</span></span><br><span class="line">                dependArray(value);</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">return</span> value</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">// 派发更新</span></span><br><span class="line">        <span class="keyword">set</span>: function reactiveSetter (newVal) &#123;</span><br><span class="line">          <span class="comment">// 是否有已定义的 getter, 如果有就调用它, 没有就把 val 赋值给 value</span></span><br><span class="line">          <span class="keyword">var</span> value = getter ? getter.call(obj) : val;</span><br><span class="line">          <span class="comment">/* eslint-disable no-self-compare */</span></span><br><span class="line">          <span class="comment">// 如果 新值 === 旧值, 就直接返回, 后面括号中的内容是为了验证 NaN, 因为两个 NaN 不相等, console.log(NaN == NaN) // false</span></span><br><span class="line">          <span class="keyword">if</span> (newVal === value || (newVal !== newVal &amp;&amp; value !== value)) &#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">          &#125;</span><br><span class="line">          <span class="comment">/* eslint-enable no-self-compare */</span></span><br><span class="line">          <span class="comment">// 如果传入了自定义 Setter, 那就调用它</span></span><br><span class="line">          <span class="keyword">if</span> (customSetter) &#123;</span><br><span class="line">            customSetter();</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="comment">// #7981: for accessor properties without setter</span></span><br><span class="line">          <span class="comment">// 用于只写了 getter 不带 setter 的访问器属性</span></span><br><span class="line">          <span class="keyword">if</span> (getter &amp;&amp; !setter) &#123; <span class="keyword">return</span> &#125;</span><br><span class="line">          <span class="comment">// 如果有 setter, 调用一下，传入上下文和新值</span></span><br><span class="line">          <span class="keyword">if</span> (setter) &#123;</span><br><span class="line">            setter.call(obj, newVal);</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// 如果没有 setter, 将新值赋给 val (也就是最开始说的闭包的值)</span></span><br><span class="line">            val = newVal;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="comment">// 为新值调用 observe, 返回的 Ob 赋值给 childOb</span></span><br><span class="line">          childOb = !shallow &amp;&amp; observe(newVal);</span><br><span class="line">          <span class="comment">// 派发更新, 通知 该 Dep 上的 subs 数组内的每一个 Watcher</span></span><br><span class="line">          dep.notify();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Set a property on an object. Adds the new property and</span></span><br><span class="line"><span class="comment">     * triggers change notification if the property doesn't</span></span><br><span class="line"><span class="comment">     * already exist.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 在对象上设置属性。添加新属性，如果该属性尚不存在，则触发更改通知。</span></span><br><span class="line"><span class="comment">     * 就是我们使用的 $set 属性, 用于给对象或数组新增响应式属性</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">set</span> (<span class="params">target, key, val</span>) </span>&#123;</span><br><span class="line">      <span class="comment">// target 是否为 undefined 或原始类型</span></span><br><span class="line">      <span class="keyword">if</span> (isUndef(target) || isPrimitive(target)</span><br><span class="line">      ) &#123;</span><br><span class="line">        warn((<span class="string">"Cannot set reactive property on undefined, null, or primitive value: "</span> + ((target))));</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 如果 target 是数组, 并且 key 是有效的数组索引，即 key 是 非无穷的正整数</span></span><br><span class="line">      <span class="keyword">if</span> (<span class="built_in">Array</span>.isArray(target) &amp;&amp; isValidArrayIndex(key)) &#123;</span><br><span class="line">        <span class="comment">// 修改 target 的 length</span></span><br><span class="line">        target.length = <span class="built_in">Math</span>.max(target.length, key);</span><br><span class="line">        <span class="comment">// 在索引为 key 的位置添加新值</span></span><br><span class="line">        target.splice(key, <span class="number">1</span>, val);</span><br><span class="line">        <span class="keyword">return</span> val</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 如果 key 是 target 的属性并且 key 不是个对象, 也就是说键名重复了</span></span><br><span class="line">      <span class="keyword">if</span> (key <span class="keyword">in</span> target &amp;&amp; !(key <span class="keyword">in</span> <span class="built_in">Object</span>.prototype)) &#123;</span><br><span class="line">        <span class="comment">// 直接赋新值后返回</span></span><br><span class="line">        target[key] = val;</span><br><span class="line">        <span class="keyword">return</span> val</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 获取 target 属性的 Ob</span></span><br><span class="line">      <span class="keyword">var</span> ob = (target).__ob__;</span><br><span class="line">      <span class="comment">// 如果为 target 是 Vue 实例，或 ob.vmCount 有值, 就证明 Ob 是 Vue 实例属性的 Ob, 即 $data 的 Ob, 也就是说 target 是 $data, 就抛出警告, 不要在运行时 set data, 而是在初始化时设置 data, 并 return</span></span><br><span class="line">      <span class="comment">// 也就是说，在 Vue 初始化完成后，不允许通过 set 新增 $data 或 Vue 实例的属性</span></span><br><span class="line">      <span class="keyword">if</span> (target._isVue || (ob &amp;&amp; ob.vmCount)) &#123;</span><br><span class="line">        warn(</span><br><span class="line">          <span class="string">'Avoid adding reactive properties to a Vue instance or its root $data '</span> +</span><br><span class="line">          <span class="string">'at runtime - declare it upfront in the data option.'</span></span><br><span class="line">        );</span><br><span class="line">        <span class="keyword">return</span> val</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 如果 target 没有 ob, 就只把 target[key] 赋上新值, 并返回, 不做响应式处理, 因为它可能是数组里的某项或用户通过 = 赋值的值, 他们不应该被响应式化</span></span><br><span class="line">      <span class="keyword">if</span> (!ob) &#123;</span><br><span class="line">        target[key] = val;</span><br><span class="line">        <span class="keyword">return</span> val</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 如果存在 ob, 就通过 ob.value 拿到 Ob 所在的属性的引用, 并响应式处理新值</span></span><br><span class="line">      defineReactive$$<span class="number">1</span>(ob.value, key, val);</span><br><span class="line">      <span class="comment">// 通知 ob 的 dep 更新视图, 收集依赖</span></span><br><span class="line">      ob.dep.notify();</span><br><span class="line">      <span class="comment">// 返回新值</span></span><br><span class="line">      <span class="keyword">return</span> val</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Delete a property and trigger change if necessary.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 删除属性，并在必要时触发更改。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">del</span> (<span class="params">target, key</span>) </span>&#123;</span><br><span class="line">      <span class="comment">// target 是否为 undefined 或原始类型</span></span><br><span class="line">      <span class="keyword">if</span> (isUndef(target) || isPrimitive(target)</span><br><span class="line">      ) &#123;</span><br><span class="line">        warn((<span class="string">"Cannot delete reactive property on undefined, null, or primitive value: "</span> + ((target))));</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 删除数组下标为 key 的索引</span></span><br><span class="line">      <span class="keyword">if</span> (<span class="built_in">Array</span>.isArray(target) &amp;&amp; isValidArrayIndex(key)) &#123;</span><br><span class="line">        target.splice(key, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">var</span> ob = (target).__ob__;</span><br><span class="line">      <span class="comment">// target 是 Vue 或 ob 是 $data</span></span><br><span class="line">      <span class="keyword">if</span> (target._isVue || (ob &amp;&amp; ob.vmCount)) &#123;</span><br><span class="line">        warn(</span><br><span class="line">          <span class="string">'Avoid deleting properties on a Vue instance or its root $data '</span> +</span><br><span class="line">          <span class="string">'- just set it to null.'</span></span><br><span class="line">        );</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// target 上没有 key 就直接返回, 没有这个属性当然就相当于删除了</span></span><br><span class="line">      <span class="keyword">if</span> (!hasOwn(target, key)) &#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 删除该属性</span></span><br><span class="line">      <span class="keyword">delete</span> target[key];</span><br><span class="line">      <span class="comment">// 如果 target 上没有 Ob, 跳出</span></span><br><span class="line">      <span class="keyword">if</span> (!ob) &#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 如果有 Ob, 通知一下</span></span><br><span class="line">      ob.dep.notify();</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Collect dependencies on array elements when the array is touched, since</span></span><br><span class="line"><span class="comment">     * we cannot intercept array element access like property getters.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 触摸数组时，请收集对数组元素的依赖关系</span></span><br><span class="line"><span class="comment">     * 因为我们无法像属性获取器那样拦截数组元素的访问。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">dependArray</span> (<span class="params">value</span>) </span>&#123;</span><br><span class="line">      <span class="comment">// 定义 e = undefined</span></span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">var</span> e = (<span class="keyword">void</span> <span class="number">0</span>), i = <span class="number">0</span>, l = value.length; i &lt; l; i++) &#123;</span><br><span class="line">        e = value[i];</span><br><span class="line">        <span class="comment">// 由于数组中的基础类型值实际上并没有 __ob__, 因为没有对数组内的基本类型值做响应式处理</span></span><br><span class="line">        <span class="comment">// 如果存在 e, 就看看 e.__ob__, 如果也存在, 就收集依赖</span></span><br><span class="line">        <span class="comment">// 相当于 e?.__ob__?.dep.depend()</span></span><br><span class="line">        e &amp;&amp; e.__ob__ &amp;&amp; e.__ob__.dep.depend();</span><br><span class="line">        <span class="comment">// 如果是数组, 递归</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">Array</span>.isArray(e)) &#123;</span><br><span class="line">          dependArray(e);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/*  */</span></span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Option overwriting strategies are functions that handle</span></span><br><span class="line"><span class="comment">     * how to merge a parent option value and a child option</span></span><br><span class="line"><span class="comment">     * value into the final value.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 选项覆盖策略是处理如何将父选项值和子选项值合并到最终值中的函数。</span></span><br><span class="line"><span class="comment">     * 拿到选项覆盖策略的值</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">var</span> strats = config.optionMergeStrategies;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Options with restrictions</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 有限制的选项</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    &#123;</span><br><span class="line">      strats.el = strats.propsData = <span class="function"><span class="keyword">function</span> (<span class="params">parent, child, vm, key</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!vm) &#123;</span><br><span class="line">          <span class="comment">// 选项键只能在实例中使用 new 关键字创建</span></span><br><span class="line">          warn(</span><br><span class="line">            <span class="string">"option \""</span> + key + <span class="string">"\" can only be used during instance "</span> +</span><br><span class="line">            <span class="string">'creation with the `new` keyword.'</span></span><br><span class="line">          );</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> defaultStrat(parent, child)</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Helper that recursively merges two data objects together.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 递归地将两个数据对象合并在一起的 Helper</span></span><br><span class="line"><span class="comment">     * 合并两个对象的方法，被复制的属性是深拷贝</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">mergeData</span> (<span class="params">to, from</span>) </span>&#123;</span><br><span class="line">      <span class="comment">// 如果没有 from, 返回 to</span></span><br><span class="line">      <span class="keyword">if</span> (!<span class="keyword">from</span>) &#123; <span class="keyword">return</span> to &#125;</span><br><span class="line">      <span class="keyword">var</span> key, toVal, fromVal;</span><br><span class="line">      <span class="comment">// 获取对象的键名数组。先判断一下是否有原生 Symbol, 有就用 Reflect, 没有就用 Object, 可以看到, 其实 Vue2.0 就已经在用 ES6 了, 只不过到 Vue3.0 全都改成 ES6 了</span></span><br><span class="line">      <span class="keyword">var</span> keys = hasSymbol</span><br><span class="line">        ? <span class="built_in">Reflect</span>.ownKeys(<span class="keyword">from</span>)</span><br><span class="line">        : <span class="built_in">Object</span>.keys(<span class="keyword">from</span>);</span><br><span class="line">      </span><br><span class="line">      <span class="comment">// 遍历对象</span></span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; keys.length; i++) &#123;</span><br><span class="line">        key = keys[i];</span><br><span class="line">        <span class="comment">// in case the object is already observed...</span></span><br><span class="line">        <span class="comment">// 如果 key 为 __ob__, 跳过</span></span><br><span class="line">        <span class="keyword">if</span> (key === <span class="string">'__ob__'</span>) &#123; <span class="keyword">continue</span> &#125;</span><br><span class="line">        toVal = to[key];</span><br><span class="line">        fromVal = <span class="keyword">from</span>[key];</span><br><span class="line">        <span class="comment">// 如果 to 对象没有 key, 通过 set 设置响应式的 key 到 to 上</span></span><br><span class="line">        <span class="keyword">if</span> (!hasOwn(to, key)) &#123;</span><br><span class="line">          <span class="keyword">set</span>(to, key, fromVal);</span><br><span class="line">        &#125; else if (</span><br><span class="line">          // 否则如果 toVal 和 fromVal 不同且同时为普通对象, 递归</span><br><span class="line">          toVal !== fromVal &amp;&amp;</span><br><span class="line">          isPlainObject(toVal) &amp;&amp;</span><br><span class="line">          isPlainObject(fromVal)</span><br><span class="line">        ) &#123;</span><br><span class="line">          mergeData(toVal, fromVal);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 最后返回合并后的对象</span></span><br><span class="line">      <span class="keyword">return</span> to</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Data</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">// 以下的合并策略里会对 vm 进行判断，只要是看你是不是用了 new 操作符</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">mergeDataOrFn</span> (<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">      parentVal,</span></span></span><br><span class="line"><span class="function"><span class="params">      childVal,</span></span></span><br><span class="line"><span class="function"><span class="params">      vm</span></span></span><br><span class="line"><span class="function"><span class="params">    </span>) </span>&#123;</span><br><span class="line">      <span class="comment">// 没有 vm, 说明是 Vue.extend 合并</span></span><br><span class="line">      <span class="keyword">if</span> (!vm) &#123;</span><br><span class="line">        <span class="comment">// in a Vue.extend merge, both should be functions</span></span><br><span class="line">        <span class="comment">// 在 Vue.extend 合并中，两者都应该是函数</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 如果 parentVal 或 childVal 哪一方为 undefined, 直接返回另一方</span></span><br><span class="line">        <span class="keyword">if</span> (!childVal) &#123;</span><br><span class="line">          <span class="keyword">return</span> parentVal</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!parentVal) &#123;</span><br><span class="line">          <span class="keyword">return</span> childVal</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// when parentVal &amp; childVal are both present,</span></span><br><span class="line">        <span class="comment">// we need to return a function that returns the</span></span><br><span class="line">        <span class="comment">// merged result of both functions... no need to</span></span><br><span class="line">        <span class="comment">// check if parentVal is a function here because</span></span><br><span class="line">        <span class="comment">// it has to be a function to pass previous merges.</span></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 当 parentVal 和 childVal 都存在时</span></span><br><span class="line"><span class="comment">         * 我们需要返回一个函数，该函数返回两个函数的合并结果...</span></span><br><span class="line"><span class="comment">         * 此处无需检查 parentVal 是否为函数，因为它必须是传递先前合并的函数。</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="comment">// 返回一个可以合并 Data 的函数</span></span><br><span class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">mergedDataFn</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">          <span class="keyword">return</span> mergeData(</span><br><span class="line">          <span class="comment">// 如果 childVal 为函数，调用它，获取返回值，如果 parentVal 为函数, 也调用它，获取返回值，大概是 data() &#123;return&#123;&#125;&#125; 这样的函数</span></span><br><span class="line">            <span class="keyword">typeof</span> childVal === <span class="string">'function'</span> ? childVal.call(<span class="keyword">this</span>, <span class="keyword">this</span>) : childVal,</span><br><span class="line">            <span class="keyword">typeof</span> parentVal === <span class="string">'function'</span> ? parentVal.call(<span class="keyword">this</span>, <span class="keyword">this</span>) : parentVal</span><br><span class="line">          )</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 如果存在vm</span></span><br><span class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">mergedInstanceDataFn</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">          <span class="comment">// instance merge</span></span><br><span class="line">          <span class="comment">// 实例合并</span></span><br><span class="line">          <span class="keyword">var</span> instanceData = <span class="keyword">typeof</span> childVal === <span class="string">'function'</span></span><br><span class="line">            ? childVal.call(vm, vm)</span><br><span class="line">            : childVal;</span><br><span class="line">          <span class="keyword">var</span> defaultData = <span class="keyword">typeof</span> parentVal === <span class="string">'function'</span></span><br><span class="line">            ? parentVal.call(vm, vm)</span><br><span class="line">            : parentVal;</span><br><span class="line">          <span class="comment">// 那么这两个函数应该是 data()&#123; return &#123;&#125; &#125; 这种形式的或 data: &#123;&#125;, 所以需要接受一下返回值</span></span><br><span class="line">          <span class="comment">// 如果存在 instanceData, 合并，得到合并后的对象</span></span><br><span class="line">          <span class="keyword">if</span> (instanceData) &#123;</span><br><span class="line">            <span class="keyword">return</span> mergeData(instanceData, defaultData)</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// 否则返回原来的对象</span></span><br><span class="line">            <span class="keyword">return</span> defaultData</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// data 的数据合并策略</span></span><br><span class="line">    strats.data = <span class="function"><span class="keyword">function</span> (<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">      parentVal,</span></span></span><br><span class="line"><span class="function"><span class="params">      childVal,</span></span></span><br><span class="line"><span class="function"><span class="params">      vm</span></span></span><br><span class="line"><span class="function"><span class="params">    </span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (!vm) &#123;</span><br><span class="line">        <span class="keyword">if</span> (childVal &amp;&amp; <span class="keyword">typeof</span> childVal !== <span class="string">'function'</span>) &#123;</span><br><span class="line">          warn(</span><br><span class="line">            <span class="string">'The "data" option should be a function '</span> +</span><br><span class="line">            <span class="string">'that returns a per-instance value in component '</span> +</span><br><span class="line">            <span class="string">'definitions.'</span>,</span><br><span class="line">            vm</span><br><span class="line">          );</span><br><span class="line">  </span><br><span class="line">          <span class="keyword">return</span> parentVal</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 如果没有 vm, 那就不传</span></span><br><span class="line">        <span class="keyword">return</span> mergeDataOrFn(parentVal, childVal)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 如果有 vm, 把 vm 传过去</span></span><br><span class="line">      <span class="keyword">return</span> mergeDataOrFn(parentVal, childVal, vm)</span><br><span class="line">    &#125;;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Hooks and props are merged as arrays.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * hooks 和 props 合并为数组</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">// hook 的合并策略</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">mergeHook</span> (<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">      parentVal,</span></span></span><br><span class="line"><span class="function"><span class="params">      childVal</span></span></span><br><span class="line"><span class="function"><span class="params">    </span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> res = childVal</span><br><span class="line">        ? parentVal</span><br><span class="line">          ? parentVal.concat(childVal)</span><br><span class="line">          : <span class="built_in">Array</span>.isArray(childVal)</span><br><span class="line">            ? childVal</span><br><span class="line">            : [childVal]</span><br><span class="line">        : parentVal;</span><br><span class="line">      <span class="keyword">return</span> res</span><br><span class="line">        ? dedupeHooks(res) <span class="comment">// 去重</span></span><br><span class="line">        : res</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 遍历 hooks, 去重</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">dedupeHooks</span> (<span class="params">hooks</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> res = [];</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; hooks.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (res.indexOf(hooks[i]) === <span class="number">-1</span>) &#123;</span><br><span class="line">          res.push(hooks[i]);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> res</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 遍历生命周期钩子的数组</span></span><br><span class="line">    <span class="comment">// strat 为 strategy (策略)简写</span></span><br><span class="line">    LIFECYCLE_HOOKS.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">hook</span>) </span>&#123;</span><br><span class="line">      <span class="comment">// 给每个钩子定义合并策略</span></span><br><span class="line">      strats[hook] = mergeHook;</span><br><span class="line">    &#125;);</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Assets</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * When a vm is present (instance creation), we need to do</span></span><br><span class="line"><span class="comment">     * a three-way merge between constructor options, instance</span></span><br><span class="line"><span class="comment">     * options and parent options.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 存在 vm 时（创建实例），我们需要在构造函数选项, 实例选项和父选项之间进行三向合并。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">mergeAssets</span> (<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">      parentVal,</span></span></span><br><span class="line"><span class="function"><span class="params">      childVal,</span></span></span><br><span class="line"><span class="function"><span class="params">      vm,</span></span></span><br><span class="line"><span class="function"><span class="params">      key</span></span></span><br><span class="line"><span class="function"><span class="params">    </span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> res = <span class="built_in">Object</span>.create(parentVal || <span class="literal">null</span>);</span><br><span class="line">      <span class="keyword">if</span> (childVal) &#123;</span><br><span class="line">        <span class="comment">// 报警告用的</span></span><br><span class="line">        assertObjectType(key, childVal, vm);</span><br><span class="line">        <span class="comment">// 合并，浅拷贝</span></span><br><span class="line">        <span class="keyword">return</span> extend(res, childVal)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// var ASSET_TYPES = ['component', 'directive', 'filter']</span></span><br><span class="line">    ASSET_TYPES.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">type</span>) </span>&#123;</span><br><span class="line">      strats[type + <span class="string">'s'</span>] = mergeAssets;</span><br><span class="line">    &#125;);</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Watchers.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * Watchers hashes should not overwrite one</span></span><br><span class="line"><span class="comment">     * another, so we merge them as arrays.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 观察者哈希值不应相互覆盖，因此我们将它们合并为数组。</span></span><br><span class="line"><span class="comment">     * watch 的合并策略</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    strats.watch = <span class="function"><span class="keyword">function</span> (<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">      parentVal,</span></span></span><br><span class="line"><span class="function"><span class="params">      childVal,</span></span></span><br><span class="line"><span class="function"><span class="params">      vm,</span></span></span><br><span class="line"><span class="function"><span class="params">      key</span></span></span><br><span class="line"><span class="function"><span class="params">    </span>) </span>&#123;</span><br><span class="line">      <span class="comment">// work around Firefox's Object.prototype.watch...</span></span><br><span class="line">      <span class="keyword">if</span> (parentVal === nativeWatch) &#123; parentVal = <span class="literal">undefined</span>; &#125;</span><br><span class="line">      <span class="keyword">if</span> (childVal === nativeWatch) &#123; childVal = <span class="literal">undefined</span>; &#125;</span><br><span class="line">      <span class="comment">/* istanbul ignore if */</span></span><br><span class="line">      <span class="comment">// 返回一个继承自 parentVal 的对象</span></span><br><span class="line">      <span class="keyword">if</span> (!childVal) &#123; <span class="keyword">return</span> <span class="built_in">Object</span>.create(parentVal || <span class="literal">null</span>) &#125;</span><br><span class="line">      &#123;</span><br><span class="line">        assertObjectType(key, childVal, vm);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (!parentVal) &#123; <span class="keyword">return</span> childVal &#125;</span><br><span class="line">      <span class="keyword">var</span> ret = &#123;&#125;;</span><br><span class="line">      <span class="comment">// 新建对象用以合并，浅拷贝</span></span><br><span class="line">      extend(ret, parentVal);</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">var</span> key$<span class="number">1</span> <span class="keyword">in</span> childVal) &#123;</span><br><span class="line">        <span class="keyword">var</span> parent = ret[key$<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">var</span> child = childVal[key$<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">if</span> (parent &amp;&amp; !<span class="built_in">Array</span>.isArray(parent)) &#123;</span><br><span class="line">          parent = [parent];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 如果 childVal 里的键名与 parentVal 一样, 把 child 数组逐项添加到 parent 数组的最后</span></span><br><span class="line">        ret[key$<span class="number">1</span>] = parent</span><br><span class="line">          ? parent.concat(child)</span><br><span class="line">          : <span class="built_in">Array</span>.isArray(child) ? child : [child];</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> ret</span><br><span class="line">    &#125;;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Other object hashes.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 其他对象散列的合并策略，新建一个对象，先合并父元素，再合并子元素，如果有重复的键名，子元素覆盖父元素</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    strats.props =</span><br><span class="line">    strats.methods =</span><br><span class="line">    strats.inject =</span><br><span class="line">    strats.computed = <span class="function"><span class="keyword">function</span> (<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">      parentVal,</span></span></span><br><span class="line"><span class="function"><span class="params">      childVal,</span></span></span><br><span class="line"><span class="function"><span class="params">      vm,</span></span></span><br><span class="line"><span class="function"><span class="params">      key</span></span></span><br><span class="line"><span class="function"><span class="params">    </span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (childVal &amp;&amp; <span class="string">"development"</span> !== <span class="string">'production'</span>) &#123;</span><br><span class="line">        <span class="comment">// assertObjectType 是警告提示的作用</span></span><br><span class="line">        assertObjectType(key, childVal, vm);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (!parentVal) &#123; <span class="keyword">return</span> childVal &#125;</span><br><span class="line">      <span class="keyword">var</span> ret = <span class="built_in">Object</span>.create(<span class="literal">null</span>);</span><br><span class="line">      extend(ret, parentVal);</span><br><span class="line">      <span class="keyword">if</span> (childVal) &#123; extend(ret, childVal); &#125;</span><br><span class="line">      <span class="keyword">return</span> ret</span><br><span class="line">    &#125;;</span><br><span class="line">    strats.provide = mergeDataOrFn;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Default strategy.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 默认策略</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">var</span> defaultStrat = <span class="function"><span class="keyword">function</span> (<span class="params">parentVal, childVal</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> childVal === <span class="literal">undefined</span></span><br><span class="line">        ? parentVal</span><br><span class="line">        : childVal</span><br><span class="line">    &#125;;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Validate component names</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 验证组件名是否正确</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">checkComponents</span> (<span class="params">options</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> options.components) &#123;</span><br><span class="line">        validateComponentName(key);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">validateComponentName</span> (<span class="params">name</span>) </span>&#123;</span><br><span class="line">      <span class="comment">// 不正确报警告</span></span><br><span class="line">      <span class="keyword">if</span> (!<span class="keyword">new</span> <span class="built_in">RegExp</span>((<span class="string">"^[a-zA-Z][\\-\\.0-9_"</span> + (unicodeRegExp.source) + <span class="string">"]*$"</span>)).test(name)) &#123;</span><br><span class="line">        warn(</span><br><span class="line">          <span class="string">'Invalid component name: "'</span> + name + <span class="string">'". Component names '</span> +</span><br><span class="line">          <span class="string">'should conform to valid custom element name in html5 specification.'</span></span><br><span class="line">        );</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 不要用原本 Vue 预留的标签名去注册组件，如 slot、component ，也不要用 HTML 定义的标签名去注册组件</span></span><br><span class="line">      <span class="keyword">if</span> (isBuiltInTag(name) || config.isReservedTag(name)) &#123;</span><br><span class="line">        warn(</span><br><span class="line">          <span class="string">'Do not use built-in or reserved HTML elements as component '</span> +</span><br><span class="line">          <span class="string">'id: '</span> + name</span><br><span class="line">        );</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Ensure all props option syntax are normalized into the</span></span><br><span class="line"><span class="comment">     * Object-based format.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 确保所有 props 选项语法均已标准化为基于对象的格式。</span></span><br><span class="line"><span class="comment">     * 就是把 props 的每一项都改成对象的形式, 不管我们是写 props: ['list'] 还是 props: &#123;list: Array&#125; 还是 props: &#123;list: &#123;type: Array&#125;&#125; (都会变成这种形式), 它们最后的效果是一致的</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">normalizeProps</span> (<span class="params">options, vm</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> props = options.props;</span><br><span class="line">      <span class="keyword">if</span> (!props) &#123; <span class="keyword">return</span> &#125;</span><br><span class="line">      <span class="keyword">var</span> res = &#123;&#125;;</span><br><span class="line">      <span class="keyword">var</span> i, val, name;</span><br><span class="line">      <span class="comment">// 如果 props 是数组，遍历它, 如果某项不是字符串，警告，是字符串就把 - 后的第一个字母大写并且去掉 - , 并且把解析后的内容缓存起来, 下次可以直接获取。</span></span><br><span class="line">      <span class="keyword">if</span> (<span class="built_in">Array</span>.isArray(props)) &#123;</span><br><span class="line">        i = props.length;</span><br><span class="line">        <span class="keyword">while</span> (i--) &#123;</span><br><span class="line">          val = props[i];</span><br><span class="line">          <span class="keyword">if</span> (<span class="keyword">typeof</span> val === <span class="string">'string'</span>) &#123;</span><br><span class="line">            name = camelize(val);</span><br><span class="line">            <span class="comment">// 给该项设置 type: null, 即接受所有的值，正常情况下我们 props 如果不是写成数组, 一般会写个 type: String 这样的内容</span></span><br><span class="line">            res[name] = &#123; <span class="attr">type</span>: <span class="literal">null</span> &#125;;</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            warn(<span class="string">'props must be strings when using array syntax.'</span>);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 如果 props 是对象, 遍历它的属性, 同上将其做驼峰处理。接着判断一下键值为是否为对象, 是对象就直接赋值, 不是就将键值用对象包裹, 成为该对象上的 type 属性的值</span></span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isPlainObject(props)) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> props) &#123;</span><br><span class="line">          val = props[key];</span><br><span class="line">          name = camelize(key);</span><br><span class="line">          res[name] = isPlainObject(val)</span><br><span class="line">            ? val</span><br><span class="line">            : &#123; <span class="attr">type</span>: val &#125;;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// props 不是数组也不是对象就报错</span></span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        warn(</span><br><span class="line">          <span class="string">"Invalid value for option \"props\": expected an Array or an Object, "</span> +</span><br><span class="line">          <span class="string">"but got "</span> + (toRawType(props)) + <span class="string">"."</span>,</span><br><span class="line">          vm</span><br><span class="line">        );</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 设置 props 最终的属性</span></span><br><span class="line">      options.props = res;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Normalize all injections into Object-based format</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 将所有注入标准化为基于对象的格式</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">normalizeInject</span> (<span class="params">options, vm</span>) </span>&#123;</span><br><span class="line">      <span class="comment">// 获取初始化传递的 options 的 inject 属性的引用</span></span><br><span class="line">      <span class="keyword">var</span> inject = options.inject;</span><br><span class="line">      <span class="keyword">if</span> (!inject) &#123; <span class="keyword">return</span> &#125;</span><br><span class="line">      <span class="comment">// 移除 options.inject 对原属性的引用, 并新建一个空对象</span></span><br><span class="line">      <span class="keyword">var</span> normalized = options.inject = &#123;&#125;;</span><br><span class="line">      <span class="comment">// 如果 inject 是数组, 遍历并以特定格式在 normalized 定义属性</span></span><br><span class="line">      <span class="keyword">if</span> (<span class="built_in">Array</span>.isArray(inject)) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; inject.length; i++) &#123;</span><br><span class="line">          normalized[inject[i]] = &#123; <span class="attr">from</span>: inject[i] &#125;;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 如果 inject 是对象, 遍历对象的属性</span></span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isPlainObject(inject)) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> inject) &#123;</span><br><span class="line">          <span class="keyword">var</span> val = inject[key];</span><br><span class="line">          <span class="comment">// val 是否为对象, 是的话就合并, 不是对象的话就新建对象, 并把 val 赋值给该对象上的 from 属性</span></span><br><span class="line">          normalized[key] = isPlainObject(val)</span><br><span class="line">          <span class="comment">// 混合前定义一下这个对象上的属性, 不知道什么用, 感觉完全可以写成空对象 &#123;&#125;, 可能看起来方便点, 可读性更高？能直接知道混合后是什么</span></span><br><span class="line">            ? extend(&#123; <span class="attr">from</span>: key &#125;, val)</span><br><span class="line">            : &#123; <span class="attr">from</span>: val &#125;;</span><br><span class="line">        &#125;</span><br><span class="line">      <span class="comment">// 不是数组也不是对象, 警告</span></span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        warn(</span><br><span class="line">          <span class="string">"Invalid value for option \"inject\": expected an Array or an Object, "</span> +</span><br><span class="line">          <span class="string">"but got "</span> + (toRawType(inject)) + <span class="string">"."</span>,</span><br><span class="line">          vm</span><br><span class="line">        );</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Normalize raw function directives into object format.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 将原始函数指令规范化为对象格式。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">normalizeDirectives</span> (<span class="params">options</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> dirs = options.directives;</span><br><span class="line">      <span class="keyword">if</span> (dirs) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> dirs) &#123;</span><br><span class="line">          <span class="keyword">var</span> def$$<span class="number">1</span> = dirs[key];</span><br><span class="line">          <span class="keyword">if</span> (<span class="keyword">typeof</span> def$$<span class="number">1</span> === <span class="string">'function'</span>) &#123;</span><br><span class="line">            <span class="comment">// 如果 key 是函数格式, 将 key 改为 特定的对象格式, 默认为 bind 和 update 属性赋值该函数</span></span><br><span class="line">            dirs[key] = &#123; <span class="attr">bind</span>: def$$<span class="number">1</span>, <span class="attr">update</span>: def$$<span class="number">1</span> &#125;;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 警告用的</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">assertObjectType</span> (<span class="params">name, value, vm</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (!isPlainObject(value)) &#123;</span><br><span class="line">        warn(</span><br><span class="line">          <span class="string">"Invalid value for option \""</span> + name + <span class="string">"\": expected an Object, "</span> +</span><br><span class="line">          <span class="string">"but got "</span> + (toRawType(value)) + <span class="string">"."</span>,</span><br><span class="line">          vm</span><br><span class="line">        );</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Merge two option objects into a new one.</span></span><br><span class="line"><span class="comment">     * Core utility used in both instantiation and inheritance.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 将两个选项对象合并到一个新的对象中。在实例化和继承中都使用的核心实用程序。</span></span><br><span class="line"><span class="comment">     * 组件合并</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">mergeOptions</span> (<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">      parent,</span></span></span><br><span class="line"><span class="function"><span class="params">      child,</span></span></span><br><span class="line"><span class="function"><span class="params">      vm</span></span></span><br><span class="line"><span class="function"><span class="params">    </span>) </span>&#123;</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">// 验证 child 组件名是否正确，弹警告用的</span></span><br><span class="line">        checkComponents(child);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 如果 child 为函数， child 赋值为 child.options</span></span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> child === <span class="string">'function'</span>) &#123;</span><br><span class="line">        child = child.options;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 验证 child 的 props</span></span><br><span class="line">      normalizeProps(child, vm);</span><br><span class="line">      <span class="comment">// 验证 inject</span></span><br><span class="line">      normalizeInject(child, vm);</span><br><span class="line">      <span class="comment">// 验证 directive</span></span><br><span class="line">      normalizeDirectives(child);</span><br><span class="line">  </span><br><span class="line">      <span class="comment">// Apply extends and mixins on the child options,</span></span><br><span class="line">      <span class="comment">// but only if it is a raw options object that isn't</span></span><br><span class="line">      <span class="comment">// the result of another mergeOptions call.</span></span><br><span class="line">      <span class="comment">// Only merged options has the _base property.</span></span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * 在子选项上应用扩展和混合，但前提是它是原始选项对象，而不是另一个 mergeOptions 调用的结果。</span></span><br><span class="line"><span class="comment">       * 仅合并的选项具有 _base 属性。</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">      <span class="keyword">if</span> (!child._base) &#123;</span><br><span class="line">        <span class="keyword">if</span> (child.extends) &#123;</span><br><span class="line">          <span class="comment">// 如果 child 上有 extends 属性，递归，参数为该属性</span></span><br><span class="line">          parent = mergeOptions(parent, child.extends, vm);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (child.mixins) &#123;</span><br><span class="line">          <span class="comment">// 如果有 mixins 属性，拿到 mixins 的数组，逐项递归</span></span><br><span class="line">          <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, l = child.mixins.length; i &lt; l; i++) &#123;</span><br><span class="line">            parent = mergeOptions(parent, child.mixins[i], vm);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">  </span><br><span class="line">      <span class="keyword">var</span> options = &#123;&#125;;</span><br><span class="line">      <span class="keyword">var</span> key;</span><br><span class="line">      <span class="keyword">for</span> (key <span class="keyword">in</span> parent) &#123;</span><br><span class="line">        mergeField(key);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">for</span> (key <span class="keyword">in</span> child) &#123;</span><br><span class="line">        <span class="comment">// 如果 parent 没有自己的 key 属性</span></span><br><span class="line">        <span class="keyword">if</span> (!hasOwn(parent, key)) &#123;</span><br><span class="line">          <span class="comment">// 默认子盖父</span></span><br><span class="line">          mergeField(key);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="function"><span class="keyword">function</span> <span class="title">mergeField</span> (<span class="params">key</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 如果有定义自己的合并策略，使用自己的，否则使用默认合并策略</span></span><br><span class="line">        <span class="keyword">var</span> strat = strats[key] || defaultStrat;</span><br><span class="line">        <span class="comment">// 合并父子数据</span></span><br><span class="line">        options[key] = strat(parent[key], child[key], vm, key);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> options</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Resolve an asset.</span></span><br><span class="line"><span class="comment">     * This function is used because child instances need access</span></span><br><span class="line"><span class="comment">     * to assets defined in its ancestor chain.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 检测指令是否在组件对象上面，返回注册指令或组件的对象，包括检查 directives, filters, components</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">resolveAsset</span> (<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">      options, <span class="regexp">//</span>参数</span></span></span><br><span class="line"><span class="function"><span class="params">      type, <span class="regexp">//</span> 类型, 只有 directives, filters, components 三种</span></span></span><br><span class="line"><span class="function"><span class="params">      id, <span class="regexp">//</span> 指令的 key</span></span></span><br><span class="line"><span class="function"><span class="params">      warnMissing <span class="regexp">//</span> 警告信息</span></span></span><br><span class="line"><span class="function"><span class="params">    </span>) </span>&#123;</span><br><span class="line">      <span class="comment">/* istanbul ignore if */</span></span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> id !== <span class="string">'string'</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">var</span> assets = options[type];</span><br><span class="line">      <span class="comment">// check local registration variations first</span></span><br><span class="line">      <span class="comment">// 首先检查本地注册变化，找到了直接 return</span></span><br><span class="line">      <span class="keyword">if</span> (hasOwn(assets, id)) &#123; <span class="keyword">return</span> assets[id] &#125;</span><br><span class="line">      <span class="comment">// 没有就把 id 转成驼峰再找一次</span></span><br><span class="line">      <span class="keyword">var</span> camelizedId = camelize(id);</span><br><span class="line">      <span class="keyword">if</span> (hasOwn(assets, camelizedId)) &#123; <span class="keyword">return</span> assets[camelizedId] &#125;</span><br><span class="line">      <span class="comment">// 如果还没有就把驼峰后的首字母大写，再找一次</span></span><br><span class="line">      <span class="keyword">var</span> PascalCaseId = capitalize(camelizedId);</span><br><span class="line">      <span class="keyword">if</span> (hasOwn(assets, PascalCaseId)) &#123; <span class="keyword">return</span> assets[PascalCaseId] &#125;</span><br><span class="line">      <span class="comment">// fallback to prototype chain</span></span><br><span class="line">      <span class="comment">// 如果都没有, 从原型链上找</span></span><br><span class="line">      <span class="keyword">var</span> res = assets[id] || assets[camelizedId] || assets[PascalCaseId];</span><br><span class="line">      <span class="comment">// 如果 res 还是没有，警告</span></span><br><span class="line">      <span class="keyword">if</span> (warnMissing &amp;&amp; !res) &#123;</span><br><span class="line">        warn(</span><br><span class="line">          <span class="string">'Failed to resolve '</span> + type.slice(<span class="number">0</span>, <span class="number">-1</span>) + <span class="string">': '</span> + id,</span><br><span class="line">          options</span><br><span class="line">        );</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> res</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/*  */</span></span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 验证 props 里的 key 是否有效, propsData 是从 VNode 上获取的, 并且为 props 里的属性添加 __ob__</span></span><br><span class="line"><span class="comment">     * 把 props 添加到观察者中</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">validateProp</span> (<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">      key,</span></span></span><br><span class="line"><span class="function"><span class="params">      propOptions,</span></span></span><br><span class="line"><span class="function"><span class="params">      propsData,</span></span></span><br><span class="line"><span class="function"><span class="params">      vm</span></span></span><br><span class="line"><span class="function"><span class="params">    </span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> prop = propOptions[key]; <span class="comment">// 获取 prop 属性</span></span><br><span class="line">      <span class="keyword">var</span> absent = !hasOwn(propsData, key);</span><br><span class="line">      <span class="keyword">var</span> value = propsData[key]; <span class="comment">// 获取值</span></span><br><span class="line">      <span class="comment">// boolean casting</span></span><br><span class="line">      <span class="comment">// 布尔型铸造</span></span><br><span class="line">      <span class="comment">// 根据 Boolean 和 prop.type 是不是相同类型, 内部执行 === , 来返回 0(两者同类型) 或 -1(不同)</span></span><br><span class="line">      <span class="keyword">var</span> booleanIndex = getTypeIndex(<span class="built_in">Boolean</span>, prop.type);</span><br><span class="line">      <span class="comment">// 如果是布尔值</span></span><br><span class="line">      <span class="keyword">if</span> (booleanIndex &gt; <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="comment">// 如果 propsData 里没有 key, 同时没有设置返回值</span></span><br><span class="line">        <span class="keyword">if</span> (absent &amp;&amp; !hasOwn(prop, <span class="string">'default'</span>)) &#123;</span><br><span class="line">          <span class="comment">// value 设置为 false</span></span><br><span class="line">          value = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">          <span class="comment">// 如果 value 为空或 value 与 key 的连字符形式(如 key 为 myVal, hyphenate 函数将将其会转成 my-val 的连字符形式)同值</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (value === <span class="string">''</span> || value === hyphenate(key)) &#123;</span><br><span class="line">          <span class="comment">// only cast empty string / same name to boolean if</span></span><br><span class="line">          <span class="comment">// 仅在以下情况下将空字符串/相同名称转换为布尔值</span></span><br><span class="line">          <span class="comment">// boolean has higher priority</span></span><br><span class="line">          <span class="comment">// 布尔值具有更高的优先级</span></span><br><span class="line">          <span class="comment">// 我们写 prop 的 type 的属性的时候，我们有时候允许接受多个类型值，写成 [Boolean, String] 这种形式，然后就有下面的检测了。</span></span><br><span class="line">          <span class="keyword">var</span> stringIndex = getTypeIndex(<span class="built_in">String</span>, prop.type);</span><br><span class="line">          <span class="comment">// 验证 String 与 prop.type 是不是类型相同，或 Boolean 的索引小于 String 的索引</span></span><br><span class="line">          <span class="keyword">if</span> (stringIndex &lt; <span class="number">0</span> || booleanIndex &lt; stringIndex) &#123;</span><br><span class="line">            <span class="comment">// value 为 true</span></span><br><span class="line">            value = <span class="literal">true</span>;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// check default value</span></span><br><span class="line">      <span class="comment">// 检查默认值, 如果 prop.type 不为 String 和 Boolean, 且 value 为 undefined</span></span><br><span class="line">      <span class="keyword">if</span> (value === <span class="literal">undefined</span>) &#123;</span><br><span class="line">        <span class="comment">// 拿到默认值</span></span><br><span class="line">        value = getPropDefaultValue(vm, prop, key);</span><br><span class="line">        <span class="comment">// since the default value is a fresh copy,</span></span><br><span class="line">        <span class="comment">// make sure to observe it.</span></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 由于默认值为全新副本，因此请务必观察。</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="comment">// 因为某些情况下我们可能需要禁用观察，所以可能有时候不是 true</span></span><br><span class="line">        <span class="keyword">var</span> prevShouldObserve = shouldObserve; <span class="comment">// shouldObserve 默认为 true, 把值给 prevShouldObserve</span></span><br><span class="line">        toggleObserving(<span class="literal">true</span>); <span class="comment">// 把 shouldObserve 转为 true</span></span><br><span class="line">        observe(value); <span class="comment">// 观测 value</span></span><br><span class="line">        toggleObserving(prevShouldObserve); <span class="comment">// 把 shouldObserve 的值变成 prevShouldObserve 的值</span></span><br><span class="line">      &#125;</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">// 判断一下 prop 是否满足规范，警告用的, prop 是 props 里属性的 type 值, key 是 props 的 key,</span></span><br><span class="line">        assertProp(prop, key, value, vm, absent);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> value</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Get the default value of a prop.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">getPropDefaultValue</span> (<span class="params">vm, prop, key</span>) </span>&#123;</span><br><span class="line">      <span class="comment">// no default, return undefined</span></span><br><span class="line">      <span class="comment">// prop 本身是否有 default 属性，没有就 return undefined</span></span><br><span class="line">      <span class="keyword">if</span> (!hasOwn(prop, <span class="string">'default'</span>)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">undefined</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 如果有，就把值给 def</span></span><br><span class="line">      <span class="keyword">var</span> def = prop.default;</span><br><span class="line">      <span class="comment">// warn against non-factory defaults for Object &amp; Array</span></span><br><span class="line">      <span class="comment">// 如果 def 是个对象或数组，就警告</span></span><br><span class="line">      <span class="keyword">if</span> (isObject(def)) &#123;</span><br><span class="line">        warn(</span><br><span class="line">          <span class="string">'Invalid default value for prop "'</span> + key + <span class="string">'": '</span> +</span><br><span class="line">          <span class="string">'Props with type Object/Array must use a factory function '</span> +</span><br><span class="line">          <span class="string">'to return the default value.'</span>,</span><br><span class="line">          vm</span><br><span class="line">        );</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// the raw prop value was also undefined from previous render,</span></span><br><span class="line">      <span class="comment">// return previous default value to avoid unnecessary watcher trigger</span></span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * 原始 prop 值也未从先前的渲染中定义，请返回先前的默认值以避免不必要的观察者触发</span></span><br><span class="line"><span class="comment">       * 如果传入的初始值里</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">      <span class="keyword">if</span> (vm &amp;&amp; vm.$options.propsData &amp;&amp;</span><br><span class="line">        vm.$options.propsData[key] === <span class="literal">undefined</span> &amp;&amp;</span><br><span class="line">        vm._props[key] !== <span class="literal">undefined</span></span><br><span class="line">      ) &#123;</span><br><span class="line">        <span class="keyword">return</span> vm._props[key]</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// call factory function for non-Function types</span></span><br><span class="line">      <span class="comment">// a value is Function if its prototype is function even across different execution context</span></span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * 为非函数类型调用工厂函数</span></span><br><span class="line"><span class="comment">       * 如果非原型类型是跨不同执行上下文的函数，值是函数</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">typeof</span> def === <span class="string">'function'</span> &amp;&amp; getType(prop.type) !== <span class="string">'Function'</span></span><br><span class="line">        ? def.call(vm)</span><br><span class="line">        : def</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Assert whether a prop is valid.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 断言 prop 是否有效。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">assertProp</span> (<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">      prop,</span></span></span><br><span class="line"><span class="function"><span class="params">      name,</span></span></span><br><span class="line"><span class="function"><span class="params">      value,</span></span></span><br><span class="line"><span class="function"><span class="params">      vm,</span></span></span><br><span class="line"><span class="function"><span class="params">      absent</span></span></span><br><span class="line"><span class="function"><span class="params">    </span>) </span>&#123;</span><br><span class="line">      <span class="comment">// 如果 prop 被要求填写了，但是它没被写上</span></span><br><span class="line">      <span class="keyword">if</span> (prop.required &amp;&amp; absent) &#123;</span><br><span class="line">        warn(</span><br><span class="line">          <span class="string">'Missing required prop: "'</span> + name + <span class="string">'"'</span>,</span><br><span class="line">          vm</span><br><span class="line">        );</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 如果 prop 被要求写上了，但是 value 没写上</span></span><br><span class="line">      <span class="keyword">if</span> (value == <span class="literal">null</span> &amp;&amp; !prop.required) &#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">var</span> type = prop.type;</span><br><span class="line">      <span class="keyword">var</span> valid = !type || type === <span class="literal">true</span>;</span><br><span class="line">      <span class="keyword">var</span> expectedTypes = [];</span><br><span class="line">      <span class="keyword">if</span> (type) &#123;</span><br><span class="line">        <span class="comment">// 如果 type 不是数组, 把它变成数组，原来的值为该数组首项</span></span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">Array</span>.isArray(type)) &#123;</span><br><span class="line">          type = [type];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 遍历 type, 只要遇到 valid 为 false, 即不合法的, 跳出循环</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; type.length &amp;&amp; !valid; i++) &#123;</span><br><span class="line">          <span class="comment">// 这个函数返回一个对象，包含值是否格式正确的布尔值(valid)和值的类型(expectedType)</span></span><br><span class="line">          <span class="keyword">var</span> assertedType = assertType(value, type[i]);</span><br><span class="line">          <span class="comment">// 把值的类型 push 进 expectedTypes 数组</span></span><br><span class="line">          expectedTypes.push(assertedType.expectedType || <span class="string">''</span>);</span><br><span class="line">          <span class="comment">// valid 表示格式是否正确的布尔值</span></span><br><span class="line">          valid = assertedType.valid;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 如果 vaild 为 false, 验证不合法，警告</span></span><br><span class="line">      <span class="keyword">if</span> (!valid) &#123;</span><br><span class="line">        warn(</span><br><span class="line">          getInvalidTypeMessage(name, value, expectedTypes),</span><br><span class="line">          vm</span><br><span class="line">        );</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// prop 的验证规则</span></span><br><span class="line">      <span class="keyword">var</span> validator = prop.validator;</span><br><span class="line">      <span class="comment">// 它是个函数，如果存在</span></span><br><span class="line">      <span class="keyword">if</span> (validator) &#123;</span><br><span class="line">        <span class="comment">// 如果验证不通过，警告</span></span><br><span class="line">        <span class="keyword">if</span> (!validator(value)) &#123;</span><br><span class="line">          warn(</span><br><span class="line">            <span class="string">'Invalid prop: custom validator check failed for prop "'</span> + name + <span class="string">'".'</span>,</span><br><span class="line">            vm</span><br><span class="line">          );</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 检测基本类型值的正则</span></span><br><span class="line">    <span class="keyword">var</span> simpleCheckRE = <span class="regexp">/^(String|Number|Boolean|Function|Symbol)$/</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 用于返回一个对象，包含值是否格式正确的布尔值(valid)和值的类型(expectedType)</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">assertType</span> (<span class="params">value, type</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> valid;</span><br><span class="line">      <span class="comment">// 获取 type 的类型, 如 String Boolean 这种</span></span><br><span class="line">      <span class="keyword">var</span> expectedType = getType(type);</span><br><span class="line">      <span class="comment">// 正则匹配 var simpleCheckRE = /^(String|Number|Boolean|Function|Symbol)$/;</span></span><br><span class="line">      <span class="comment">// 如果能匹配到以上基本类型</span></span><br><span class="line">      <span class="keyword">if</span> (simpleCheckRE.test(expectedType)) &#123;</span><br><span class="line">        <span class="comment">// 获取 value 的类型</span></span><br><span class="line">        <span class="keyword">var</span> t = <span class="keyword">typeof</span> value;</span><br><span class="line">        <span class="comment">// 判断 value 的类型与 type 的类型(转成小写比较)是否一致</span></span><br><span class="line">        valid = t === expectedType.toLowerCase();</span><br><span class="line">        <span class="comment">// for primitive wrapper objects</span></span><br><span class="line">        <span class="comment">// 如果类型不一致，而且 value 为 object</span></span><br><span class="line">        <span class="keyword">if</span> (!valid &amp;&amp; t === <span class="string">'object'</span>) &#123;</span><br><span class="line">          <span class="comment">// 判断 value 是否为 type 的实例，并把值赋给 valid</span></span><br><span class="line">          valid = value <span class="keyword">instanceof</span> type;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 如果 type 类型为对象</span></span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (expectedType === <span class="string">'Object'</span>) &#123;</span><br><span class="line">        <span class="comment">// 判断一下 value 是否为基本类型对象</span></span><br><span class="line">        valid = isPlainObject(value);</span><br><span class="line">        <span class="comment">// 如果 type 为 Array</span></span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (expectedType === <span class="string">'Array'</span>) &#123;</span><br><span class="line">        <span class="comment">// 判断一下 value 是否为 Array</span></span><br><span class="line">        valid = <span class="built_in">Array</span>.isArray(value);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 否则 看看 value 是否为 type 的实例</span></span><br><span class="line">        valid = value <span class="keyword">instanceof</span> type;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 返回一个对象，包含值是否格式正确的布尔值(valid)和值的类型(expectedType)</span></span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        valid: valid,</span><br><span class="line">        expectedType: expectedType</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Use function string name to check built-in types,</span></span><br><span class="line"><span class="comment">     * because a simple equality check will fail when running</span></span><br><span class="line"><span class="comment">     * across different vms / iframes.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 使用功能字符串名称来检查内置类型，因为在不同的 vms / iframe 上运行时，简单的相等性检查将失败。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">// 返回传入值的类型, 如 'Boolean'、'String'、'Number' 等</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">getType</span> (<span class="params">fn</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> match = fn &amp;&amp; fn.toString().match(<span class="regexp">/^\s*function (\w+)/</span>);</span><br><span class="line">      <span class="keyword">return</span> match ? match[<span class="number">1</span>] : <span class="string">''</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 比较两者类型是否相同</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">isSameType</span> (<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> getType(a) === getType(b)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 获取 type 在 expectedTypes 数组中的索引， type 为基本类型值，如 String</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">getTypeIndex</span> (<span class="params">type, expectedTypes</span>) </span>&#123;</span><br><span class="line">      <span class="comment">// 如果 expectedTypes 不是数组，那就直接比较它和 type</span></span><br><span class="line">      <span class="keyword">if</span> (!<span class="built_in">Array</span>.isArray(expectedTypes)) &#123;</span><br><span class="line">        <span class="keyword">return</span> isSameType(expectedTypes, type) ? <span class="number">0</span> : <span class="number">-1</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 如果 expectedTypes 是数组，遍历它，如果发现 type 在该数组中存在，直接返回索引</span></span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, len = expectedTypes.length; i &lt; len; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (isSameType(expectedTypes[i], type)) &#123;</span><br><span class="line">          <span class="keyword">return</span> i</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 找不到返回 -1</span></span><br><span class="line">      <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 警告用的函数</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">getInvalidTypeMessage</span> (<span class="params">name, value, expectedTypes</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> message = <span class="string">"Invalid prop: type check failed for prop \""</span> + name + <span class="string">"\"."</span> +</span><br><span class="line">        <span class="string">" Expected "</span> + (expectedTypes.map(capitalize).join(<span class="string">', '</span>));</span><br><span class="line">      <span class="keyword">var</span> expectedType = expectedTypes[<span class="number">0</span>];</span><br><span class="line">      <span class="keyword">var</span> receivedType = toRawType(value);</span><br><span class="line">      <span class="keyword">var</span> expectedValue = styleValue(value, expectedType);</span><br><span class="line">      <span class="keyword">var</span> receivedValue = styleValue(value, receivedType);</span><br><span class="line">      <span class="comment">// check if we need to specify expected value</span></span><br><span class="line">      <span class="keyword">if</span> (expectedTypes.length === <span class="number">1</span> &amp;&amp;</span><br><span class="line">          isExplicable(expectedType) &amp;&amp;</span><br><span class="line">          !isBoolean(expectedType, receivedType)) &#123;</span><br><span class="line">        message += <span class="string">" with value "</span> + expectedValue;</span><br><span class="line">      &#125;</span><br><span class="line">      message += <span class="string">", got "</span> + receivedType + <span class="string">" "</span>;</span><br><span class="line">      <span class="comment">// check if we need to specify received value</span></span><br><span class="line">      <span class="keyword">if</span> (isExplicable(receivedType)) &#123;</span><br><span class="line">        message += <span class="string">"with value "</span> + receivedValue + <span class="string">"."</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> message</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 将 value 转为 type 的类型</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">styleValue</span> (<span class="params">value, type</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (type === <span class="string">'String'</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="string">"\""</span> + value + <span class="string">"\""</span>)</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type === <span class="string">'Number'</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="string">""</span> + (<span class="built_in">Number</span>(value)))</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="string">""</span> + value)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 是可解释的值 , 传入的值是否为 'string', 'number', 'boolean' 之一</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">isExplicable</span> (<span class="params">value</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> explicitTypes = [<span class="string">'string'</span>, <span class="string">'number'</span>, <span class="string">'boolean'</span>];</span><br><span class="line">      <span class="comment">// 返回 传入的值是上面这个数组中的某项的布尔值</span></span><br><span class="line">      <span class="keyword">return</span> explicitTypes.some(<span class="function"><span class="keyword">function</span> (<span class="params">elem</span>) </span>&#123; <span class="keyword">return</span> value.toLowerCase() === elem; &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 传入的值是否有 'boolean' 字样</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">isBoolean</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="comment">// 浅拷贝传入的值</span></span><br><span class="line">      <span class="keyword">var</span> args = [], len = <span class="built_in">arguments</span>.length;</span><br><span class="line">      <span class="keyword">while</span> ( len-- ) args[ len ] = <span class="built_in">arguments</span>[ len ];</span><br><span class="line">      <span class="comment">// 返回 该数组中是否有值为 'boolean' 的项的布尔值</span></span><br><span class="line">      <span class="keyword">return</span> args.some(<span class="function"><span class="keyword">function</span> (<span class="params">elem</span>) </span>&#123; <span class="keyword">return</span> elem.toLowerCase() === <span class="string">'boolean'</span>; &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/*  */</span></span><br><span class="line">    <span class="comment">// 处理错误</span></span><br><span class="line">    <span class="comment">// err 原生错误信息</span></span><br><span class="line">    <span class="comment">// vm 实例</span></span><br><span class="line">    <span class="comment">// info 什么导致的错误 如 'nextTick'，即调用 nextTick 导致的</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 这是向外暴露的方法。 handleError 方法中获取到报错的组件，之后递归查找当前组件的父组件，</span></span><br><span class="line"><span class="comment">     * 依次调用 errorCaptured 方法。在遍历调用完所有 errorCaptured 方法，或 errorCaptured 方法报错时，</span></span><br><span class="line"><span class="comment">     * 调用 globalHandleError 方法，该方法调用了全局的 errorHandler 方法，如果全局的这个方法也报错，</span></span><br><span class="line"><span class="comment">     * 那就会 console.error(err) 或 throw err</span></span><br><span class="line"><span class="comment">     * 如果某个组件的 errorCaptured 方法返回了 false，那么这个异常信息不会再向上冒泡也不会再调用 errorHandler 方法</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">handleError</span> (<span class="params">err, vm, info</span>) </span>&#123;</span><br><span class="line">      <span class="comment">// Deactivate deps tracking while processing error handler to avoid possible infinite rendering.</span></span><br><span class="line">      <span class="comment">// See: https://github.com/vuejs/vuex/issues/1505</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">// 将 Dep.target 设为 undefined</span></span><br><span class="line">      <span class="comment">// 往 targetStack 数组中压入一个 undefined</span></span><br><span class="line">      <span class="comment">// 避免错误收集依赖</span></span><br><span class="line">      pushTarget();</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (vm) &#123;</span><br><span class="line">          <span class="keyword">var</span> cur = vm;</span><br><span class="line">          <span class="keyword">while</span> ((cur = cur.$parent)) &#123;</span><br><span class="line">            <span class="comment">// errorCaptured 是生命周期函数，当错误发生时会调用, 拿到定义的错误处理函数数组</span></span><br><span class="line">            <span class="keyword">var</span> hooks = cur.$options.errorCaptured;</span><br><span class="line">            <span class="keyword">if</span> (hooks) &#123;</span><br><span class="line">              <span class="comment">// 一一调用之</span></span><br><span class="line">              <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; hooks.length; i++) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                  <span class="comment">// 调用函数看看函数返回值是否为 false</span></span><br><span class="line">                  <span class="keyword">var</span> capture = hooks[i].call(cur, err, vm, info) === <span class="literal">false</span>;</span><br><span class="line">                  <span class="comment">// 如果函数返回值为 false，直接 return 出去</span></span><br><span class="line">                  <span class="keyword">if</span> (capture) &#123; <span class="keyword">return</span> &#125;</span><br><span class="line">                &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">                  <span class="comment">// 如果函数报错了，处理一下，就是报点错，由于 cur 一直在往上层走，所以会在报错中看到报错的组件路径</span></span><br><span class="line">                  globalHandleError(e, cur, <span class="string">'errorCaptured hook'</span>);</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        globalHandleError(err, vm, info);</span><br><span class="line">      &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="comment">// 移除 targetStack 中的 undefined</span></span><br><span class="line">        <span class="comment">// Dep.target 也不再试刚刚添加的 undefined</span></span><br><span class="line">        popTarget();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 调用它并包含错误处理， Vue 在方法外面封装了一层 invoker(调用器)，函数的调用都放在 try 里了，防止报错了页面直接不运行了， 返回的也还是函数执行的返回值，就像正常调用一样。</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">invokeWithErrorHandling</span> (<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">      handler,</span></span></span><br><span class="line"><span class="function"><span class="params">      context,</span></span></span><br><span class="line"><span class="function"><span class="params">      args, <span class="regexp">//</span> 传入的参</span></span></span><br><span class="line"><span class="function"><span class="params">      vm,</span></span></span><br><span class="line"><span class="function"><span class="params">      info</span></span></span><br><span class="line"><span class="function"><span class="params">    </span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> res;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// 判断是否有参，分情况调用</span></span><br><span class="line">        res = args ? handler.apply(context, args) : handler.call(context);</span><br><span class="line">        <span class="keyword">if</span> (res &amp;&amp; !res._isVue &amp;&amp; isPromise(res) &amp;&amp; !res._handled) &#123;</span><br><span class="line">          res.catch(<span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123; <span class="keyword">return</span> handleError(e, vm, info + <span class="string">" (Promise/async)"</span>); &#125;);</span><br><span class="line">          <span class="comment">// issue #9511</span></span><br><span class="line">          <span class="comment">// avoid catch triggering multiple times when nested calls</span></span><br><span class="line">          res._handled = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        handleError(e, vm, info);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> res</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 全局错误处理</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">globalHandleError</span> (<span class="params">err, vm, info</span>) </span>&#123;</span><br><span class="line">      <span class="comment">// 如果有自定的错误处理函数，就调用它</span></span><br><span class="line">      <span class="keyword">if</span> (config.errorHandler) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">          <span class="keyword">return</span> config.errorHandler.call(<span class="literal">null</span>, err, vm, info)</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">          <span class="comment">// if the user intentionally throws the original error in the handler,</span></span><br><span class="line">          <span class="comment">// do not log it twice</span></span><br><span class="line">          <span class="keyword">if</span> (e !== err) &#123;</span><br><span class="line">            logError(e, <span class="literal">null</span>, <span class="string">'config.errorHandler'</span>);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 打印错误</span></span><br><span class="line">      logError(err, vm, info);</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">logError</span> (<span class="params">err, vm, info</span>) </span>&#123;</span><br><span class="line">      &#123;</span><br><span class="line">        warn((<span class="string">"Error in "</span> + info + <span class="string">": \""</span> + (err.toString()) + <span class="string">"\""</span>), vm);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/* istanbul ignore else */</span></span><br><span class="line">      <span class="comment">// 如果在浏览器或 inWeex 环境下，同时存在 console，就打印错误，否则 throw</span></span><br><span class="line">      <span class="keyword">if</span> ((inBrowser || inWeex) &amp;&amp; <span class="keyword">typeof</span> <span class="built_in">console</span> !== <span class="string">'undefined'</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.error(err);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span> err</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/*  */</span></span><br><span class="line">    <span class="comment">// 是否使用微任务</span></span><br><span class="line">    <span class="keyword">var</span> isUsingMicroTask = <span class="literal">false</span>;</span><br><span class="line">    <span class="comment">// 回调数组</span></span><br><span class="line">    <span class="keyword">var</span> callbacks = [];</span><br><span class="line">    <span class="keyword">var</span> pending = <span class="literal">false</span>;</span><br><span class="line">    <span class="comment">// flushCallbacks 用来清空回调队列和依次执行回调。</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">flushCallbacks</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      pending = <span class="literal">false</span>;</span><br><span class="line">      <span class="comment">// 拷贝一份原回调数组</span></span><br><span class="line">      <span class="keyword">var</span> copies = callbacks.slice(<span class="number">0</span>);</span><br><span class="line">      <span class="comment">// 把原回调数组清空</span></span><br><span class="line">      callbacks.length = <span class="number">0</span>;</span><br><span class="line">      <span class="comment">// 依次执行回调</span></span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; copies.length; i++) &#123;</span><br><span class="line">        copies[i]();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">// Here we have async deferring wrappers using microtasks.</span></span><br><span class="line">    <span class="comment">// In 2.5 we used (macro) tasks (in combination with microtasks).</span></span><br><span class="line">    <span class="comment">// However, it has subtle problems when state is changed right before repaint</span></span><br><span class="line">    <span class="comment">// (e.g. #6813, out-in transitions).</span></span><br><span class="line">    <span class="comment">// Also, using (macro) tasks in event handler would cause some weird behaviors</span></span><br><span class="line">    <span class="comment">// that cannot be circumvented (e.g. #7109, #7153, #7546, #7834, #8109).</span></span><br><span class="line">    <span class="comment">// So we now use microtasks everywhere, again.</span></span><br><span class="line">    <span class="comment">// A major drawback of this tradeoff is that there are some scenarios</span></span><br><span class="line">    <span class="comment">// where microtasks have too high a priority and fire in between supposedly</span></span><br><span class="line">    <span class="comment">// sequential events (e.g. #4521, #6690, which have workarounds)</span></span><br><span class="line">    <span class="comment">// or even between bubbling of the same event (#6566).</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 在这里，我们使用微任务异步延迟包装器。</span></span><br><span class="line"><span class="comment">     * 在2.5中，我们使用了（宏）任务（结合了微任务）。</span></span><br><span class="line"><span class="comment">     * 但是，在重新粉刷之前更改状态时，它存在一些细微的问题</span></span><br><span class="line"><span class="comment">     * （例如＃6813，外向内过渡）。</span></span><br><span class="line"><span class="comment">     * 另外，在事件处理程序中使用（宏）任务会导致一些奇怪的行为</span></span><br><span class="line"><span class="comment">     * 无法绕过的内容（例如，＃7109，＃7153，＃7546，＃7834，＃8109）。</span></span><br><span class="line"><span class="comment">     * 因此，我们现在再次在各处使用微任务。</span></span><br><span class="line"><span class="comment">     * 这种折衷的主要缺点是存在一些方案</span></span><br><span class="line"><span class="comment">     * 微任务的优先级过高，并且据称介于两者之间</span></span><br><span class="line"><span class="comment">     * 顺序事件（例如＃4521，＃6690，它们具有解决方法）</span></span><br><span class="line"><span class="comment">     * 甚至在同一事件冒泡之间（＃6566）。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">var</span> timerFunc;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">// The nextTick behavior leverages the microtask queue, which can be accessed</span></span><br><span class="line">    <span class="comment">// via either native Promise.then or MutationObserver.</span></span><br><span class="line">    <span class="comment">// MutationObserver has wider support, however it is seriously bugged in</span></span><br><span class="line">    <span class="comment">// UIWebView in iOS &gt;= 9.3.3 when triggered in touch event handlers. It</span></span><br><span class="line">    <span class="comment">// completely stops working after triggering a few times... so, if native</span></span><br><span class="line">    <span class="comment">// Promise is available, we will use it:</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * nextTick行为利用了微任务队列，可以访问它</span></span><br><span class="line"><span class="comment">     * 通过本地Promise.then 或 MutationObserver。</span></span><br><span class="line"><span class="comment">     * MutationObserver拥有更广泛的支持，但是在此方面存在严重错误</span></span><br><span class="line"><span class="comment">     * 在触摸事件处理程序中触发时，iOS&gt; = 9.3.3中的 UIWebView 。它</span></span><br><span class="line"><span class="comment">     * 触发几次后完全停止工作...因此，如果是原生的</span></span><br><span class="line"><span class="comment">     * Promise 可用，我们将使用它：</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/* istanbul ignore next, $flow-disable-line */</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="built_in">Promise</span> !== <span class="string">'undefined'</span> &amp;&amp; isNative(<span class="built_in">Promise</span>)) &#123;</span><br><span class="line">      <span class="keyword">var</span> p = <span class="built_in">Promise</span>.resolve();</span><br><span class="line">      timerFunc = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        p.then(flushCallbacks);</span><br><span class="line">        <span class="comment">// In problematic UIWebViews, Promise.then doesn't completely break, but</span></span><br><span class="line">        <span class="comment">// it can get stuck in a weird state where callbacks are pushed into the</span></span><br><span class="line">        <span class="comment">// microtask queue but the queue isn't being flushed, until the browser</span></span><br><span class="line">        <span class="comment">// needs to do some other work, e.g. handle a timer. Therefore we can</span></span><br><span class="line">        <span class="comment">// "force" the microtask queue to be flushed by adding an empty timer.</span></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 在有问题的 UIWebViews 中，Promise.then 不会完全中断，但是</span></span><br><span class="line"><span class="comment">         * 它可能会陷入怪异的状态，其中回调被推送到</span></span><br><span class="line"><span class="comment">         * 微任务队列，但队列没有被刷新，直到浏览器</span></span><br><span class="line"><span class="comment">         * 需要做一些其他工作，例如处理一个计时器。因此，我们可以</span></span><br><span class="line"><span class="comment">         * 通过添加一个空计时器来“强制”刷新微任务队列。</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">if</span> (isIOS) &#123; setTimeout(noop); &#125;</span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="comment">// 使用微任务</span></span><br><span class="line">      isUsingMicroTask = <span class="literal">true</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!isIE &amp;&amp; <span class="keyword">typeof</span> MutationObserver !== <span class="string">'undefined'</span> &amp;&amp; (</span><br><span class="line">      isNative(MutationObserver) ||</span><br><span class="line">      <span class="comment">// PhantomJS and iOS 7.x</span></span><br><span class="line">      MutationObserver.toString() === <span class="string">'[object MutationObserverConstructor]'</span></span><br><span class="line">    )) &#123;</span><br><span class="line">      <span class="comment">// Use MutationObserver where native Promise is not available,</span></span><br><span class="line">      <span class="comment">// 当原生 Promise 不可用的时候使用 MutationObserver</span></span><br><span class="line">      <span class="comment">// e.g. PhantomJS, iOS7, Android 4.4</span></span><br><span class="line">      <span class="comment">// (#6466 MutationObserver is unreliable in IE11)</span></span><br><span class="line">      <span class="keyword">var</span> counter = <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">var</span> observer = <span class="keyword">new</span> MutationObserver(flushCallbacks);</span><br><span class="line">      <span class="keyword">var</span> textNode = <span class="built_in">document</span>.createTextNode(<span class="built_in">String</span>(counter));</span><br><span class="line">      observer.observe(textNode, &#123;</span><br><span class="line">        characterData: <span class="literal">true</span></span><br><span class="line">      &#125;);</span><br><span class="line">      timerFunc = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        counter = (counter + <span class="number">1</span>) % <span class="number">2</span>;</span><br><span class="line">        textNode.data = <span class="built_in">String</span>(counter);</span><br><span class="line">      &#125;;</span><br><span class="line">      isUsingMicroTask = <span class="literal">true</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> setImmediate !== <span class="string">'undefined'</span> &amp;&amp; isNative(setImmediate)) &#123;</span><br><span class="line">      <span class="comment">// Fallback to setImmediate.</span></span><br><span class="line">      <span class="comment">// Technically it leverages the (macro) task queue,</span></span><br><span class="line">      <span class="comment">// but it is still a better choice than setTimeout.</span></span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * 退回到 setImmediate。</span></span><br><span class="line"><span class="comment">       * 从技术上讲，它利用（宏）任务队列，</span></span><br><span class="line"><span class="comment">       * 但它仍然是比setTimeout更好的选择。</span></span><br><span class="line"><span class="comment">       * 如果 Promise 和 MutationObserver 都不可用，将会使用 setImmediate。</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">      timerFunc = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        setImmediate(flushCallbacks);</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// Fallback to setTimeout.</span></span><br><span class="line">      <span class="comment">// 都不可用的时候退回到 setTimeout, 它将是最后的方案</span></span><br><span class="line">      timerFunc = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        setTimeout(flushCallbacks, <span class="number">0</span>);</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 把 cb 压入 callbacks 数组的最后，并在调用它的时候传入 ctx 上下文</span></span><br><span class="line">    <span class="comment">// 其实是为 callbacks 数组收集 cb, 并且根据 pending 状态决定是否触发 callbacks 队列函数</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">nextTick</span> (<span class="params">cb, ctx</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> _resolve;</span><br><span class="line">      callbacks.push(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (cb) &#123;</span><br><span class="line">          <span class="keyword">try</span> &#123;</span><br><span class="line">            cb.call(ctx);</span><br><span class="line">          &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">            handleError(e, ctx, <span class="string">'nextTick'</span>);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (_resolve) &#123;</span><br><span class="line">          <span class="comment">// 如果_resolve 存在就执行</span></span><br><span class="line">          _resolve(ctx);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="comment">// 如果 pending 是 false，这就是 Promise 的状态，模拟一下</span></span><br><span class="line">      <span class="keyword">if</span> (!pending) &#123;</span><br><span class="line">        <span class="comment">// 修改状态</span></span><br><span class="line">        pending = <span class="literal">true</span>;</span><br><span class="line">        <span class="comment">// 清空 callbacks 数组 ，里面调用了 flushCallbacks，但它被 .then() 方法包裹，将会被放入微任务队列中</span></span><br><span class="line">        <span class="comment">// 即异步触发 callbacks 队列中的函数</span></span><br><span class="line">        timerFunc();</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// $flow-disable-line</span></span><br><span class="line">      <span class="comment">// 如果 cb 不存在 同时原生 Primose 存在</span></span><br><span class="line">      <span class="keyword">if</span> (!cb &amp;&amp; <span class="keyword">typeof</span> <span class="built_in">Promise</span> !== <span class="string">'undefined'</span>) &#123;</span><br><span class="line">        <span class="comment">// 返回一个新的 Promise，它的状态好像永远都是 pending。。</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve</span>) </span>&#123;</span><br><span class="line">          _resolve = resolve;</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/*  */</span></span><br><span class="line">  </span><br><span class="line">    <span class="keyword">var</span> mark;</span><br><span class="line">    <span class="keyword">var</span> measure;</span><br><span class="line">  </span><br><span class="line">    &#123;</span><br><span class="line">      <span class="comment">// 浏览器性能监控</span></span><br><span class="line">      <span class="comment">// 看看 MDN https://developer.mozilla.org/zh-CN/docs/Web/API/Window/performance</span></span><br><span class="line">      <span class="keyword">var</span> perf = inBrowser &amp;&amp; <span class="built_in">window</span>.performance;</span><br><span class="line">      <span class="comment">/* istanbul ignore if */</span></span><br><span class="line">      <span class="keyword">if</span> (</span><br><span class="line">        perf &amp;&amp;</span><br><span class="line">        perf.mark &amp;&amp;</span><br><span class="line">        perf.measure &amp;&amp;</span><br><span class="line">        perf.clearMarks &amp;&amp;</span><br><span class="line">        perf.clearMeasures</span><br><span class="line">      ) &#123;</span><br><span class="line">        mark = <span class="function"><span class="keyword">function</span> (<span class="params">tag</span>) </span>&#123; <span class="keyword">return</span> perf.mark(tag); &#125;;</span><br><span class="line">        measure = <span class="function"><span class="keyword">function</span> (<span class="params">name, startTag, endTag</span>) </span>&#123;</span><br><span class="line">          perf.measure(name, startTag, endTag);</span><br><span class="line">          perf.clearMarks(startTag);</span><br><span class="line">          perf.clearMarks(endTag);</span><br><span class="line">          <span class="comment">// perf.clearMeasures(name)</span></span><br><span class="line">        &#125;;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/* not type checking this file because flow doesn't play well with Proxy */</span></span><br><span class="line">  </span><br><span class="line">    <span class="keyword">var</span> initProxy;</span><br><span class="line">  </span><br><span class="line">    &#123;</span><br><span class="line">      <span class="comment">// 把下面的字符串以逗号分隔为数组并缓存起来, 放到 allowedGlobals 中</span></span><br><span class="line">      <span class="keyword">var</span> allowedGlobals = makeMap(</span><br><span class="line">        <span class="string">'Infinity,undefined,NaN,isFinite,isNaN,'</span> +</span><br><span class="line">        <span class="string">'parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,'</span> +</span><br><span class="line">        <span class="string">'Math,Number,Date,Array,Object,Boolean,String,RegExp,Map,Set,JSON,Intl,'</span> +</span><br><span class="line">        <span class="string">'require'</span> <span class="comment">// for Webpack/Browserify</span></span><br><span class="line">      );</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 不存在 key 放出的警告</span></span><br><span class="line">      <span class="keyword">var</span> warnNonPresent = <span class="function"><span class="keyword">function</span> (<span class="params">target, key</span>) </span>&#123;</span><br><span class="line">        warn(</span><br><span class="line">          <span class="string">"Property or method \""</span> + key + <span class="string">"\" is not defined on the instance but "</span> +</span><br><span class="line">          <span class="string">'referenced during render. Make sure that this property is reactive, '</span> +</span><br><span class="line">          <span class="string">'either in the data option, or for class-based components, by '</span> +</span><br><span class="line">          <span class="string">'initializing the property. '</span> +</span><br><span class="line">          <span class="string">'See: https://vuejs.org/v2/guide/reactivity.html#Declaring-Reactive-Properties.'</span>,</span><br><span class="line">          target</span><br><span class="line">        );</span><br><span class="line">      &#125;;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 如果使用了 Vue 保留的前缀的警告, 以 _ 或 $ 开头的 property 不会被 Vue 实例代理，因为它们可能和 Vue 内置的 property、API 方法冲突。你可以使用例如 vm.$data._property 的方式访问这些 property。</span></span><br><span class="line">      <span class="keyword">var</span> warnReservedPrefix = <span class="function"><span class="keyword">function</span> (<span class="params">target, key</span>) </span>&#123;</span><br><span class="line">        warn(</span><br><span class="line">          <span class="string">"Property \""</span> + key + <span class="string">"\" must be accessed with \"$data."</span> + key + <span class="string">"\" because "</span> +</span><br><span class="line">          <span class="string">'properties starting with "$" or "_" are not proxied in the Vue instance to '</span> +</span><br><span class="line">          <span class="string">'prevent conflicts with Vue internals. '</span> +</span><br><span class="line">          <span class="string">'See: https://vuejs.org/v2/api/#data'</span>,</span><br><span class="line">          target</span><br><span class="line">        );</span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="comment">// 判断是否有 ES6 的 Proxy 对象</span></span><br><span class="line">      <span class="keyword">var</span> hasProxy =</span><br><span class="line">        <span class="keyword">typeof</span> <span class="built_in">Proxy</span> !== <span class="string">'undefined'</span> &amp;&amp; isNative(<span class="built_in">Proxy</span>);</span><br><span class="line">      </span><br><span class="line">      <span class="comment">// 如果有 Proxy, </span></span><br><span class="line">      <span class="keyword">if</span> (hasProxy) &#123;</span><br><span class="line">        <span class="comment">// 把下面的字符缓存起来</span></span><br><span class="line">        <span class="keyword">var</span> isBuiltInModifier = makeMap(<span class="string">'stop,prevent,self,ctrl,shift,alt,meta,exact'</span>);</span><br><span class="line">        <span class="comment">// 把 config 里的 keyCodes 用 Proxy 代理</span></span><br><span class="line">        config.keyCodes = <span class="keyword">new</span> <span class="built_in">Proxy</span>(config.keyCodes, &#123;</span><br><span class="line">          <span class="keyword">set</span>: function <span class="keyword">set</span> (target, key, value) &#123;</span><br><span class="line">            <span class="comment">// 如果自定义的 keyCodes 和上面的这几个重了，警告一下，并且返回 false, 不允许设置</span></span><br><span class="line">            <span class="keyword">if</span> (isBuiltInModifier(key)) &#123;</span><br><span class="line">              warn((<span class="string">"Avoid overwriting built-in modifier in config.keyCodes: ."</span> + key));</span><br><span class="line">              <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">              <span class="comment">// 否则就在对象上加上自己设置的按键</span></span><br><span class="line">              target[key] = value;</span><br><span class="line">              <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">  </span><br><span class="line">      <span class="keyword">var</span> hasHandler = &#123;</span><br><span class="line">        <span class="comment">// Proxy 的 has</span></span><br><span class="line">        has: <span class="function"><span class="keyword">function</span> <span class="title">has</span> (<span class="params">target, key</span>) </span>&#123;</span><br><span class="line">          <span class="keyword">var</span> has = key <span class="keyword">in</span> target;</span><br><span class="line">          <span class="comment">// allowedGlobals 是上面用 makeMap 缓存过的内容, 看看 key 是否在它里面, 或 key 为 string 同时以 _ 开头, 同时 key 不是我们传入的 data 中的内容</span></span><br><span class="line">          <span class="keyword">var</span> isAllowed = allowedGlobals(key) ||</span><br><span class="line">            (<span class="keyword">typeof</span> key === <span class="string">'string'</span> &amp;&amp; key.charAt(<span class="number">0</span>) === <span class="string">'_'</span> &amp;&amp; !(key <span class="keyword">in</span> target.$data));</span><br><span class="line">          <span class="comment">// 如果 key 不在 target 中，也不在 allowedGlobals 中，也不是 Vue 定义的 key</span></span><br><span class="line">          <span class="keyword">if</span> (!has &amp;&amp; !isAllowed) &#123;</span><br><span class="line">            <span class="comment">// 如果 key 是我们定义的 data 中的内容, 警告一下， _ 开头的属性将不会被代理到 Vue 实例上</span></span><br><span class="line">            <span class="keyword">if</span> (key <span class="keyword">in</span> target.$data) &#123; warnReservedPrefix(target, key); &#125;</span><br><span class="line">            <span class="comment">// 否则警告 key 不存在</span></span><br><span class="line">            <span class="keyword">else</span> &#123; warnNonPresent(target, key); &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">return</span> has || !isAllowed</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;;</span><br><span class="line">  </span><br><span class="line">      <span class="keyword">var</span> getHandler = &#123;</span><br><span class="line">        <span class="comment">// Proxy 的 get</span></span><br><span class="line">        <span class="keyword">get</span>: function <span class="keyword">get</span> (target, key) &#123;</span><br><span class="line">          <span class="comment">// 如果 key 是字符串且 key 不在 target 上</span></span><br><span class="line">          <span class="keyword">if</span> (<span class="keyword">typeof</span> key === <span class="string">'string'</span> &amp;&amp; !(key <span class="keyword">in</span> target)) &#123;</span><br><span class="line">            <span class="comment">// 如果 key 是我们定义的，警告一下</span></span><br><span class="line">            <span class="keyword">if</span> (key <span class="keyword">in</span> target.$data) &#123; warnReservedPrefix(target, key); &#125;</span><br><span class="line">            <span class="comment">// 否则警告 key 找不到</span></span><br><span class="line">            <span class="keyword">else</span> &#123; warnNonPresent(target, key); &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">return</span> target[key]</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 初始化 Proxy</span></span><br><span class="line">      initProxy = <span class="function"><span class="keyword">function</span> <span class="title">initProxy</span> (<span class="params">vm</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 如果有 Proxy</span></span><br><span class="line">        <span class="keyword">if</span> (hasProxy) &#123;</span><br><span class="line">          <span class="comment">// determine which proxy handler to use</span></span><br><span class="line">          <span class="comment">// 确定要使用的代理处理程序</span></span><br><span class="line">          <span class="keyword">var</span> options = vm.$options;</span><br><span class="line">          <span class="comment">// 看看有没有 options.render._withStripped 属性, 如果有，就代理 get，否则代理 has</span></span><br><span class="line">          <span class="keyword">var</span> handlers = options.render &amp;&amp; options.render._withStripped</span><br><span class="line">            ? getHandler</span><br><span class="line">            : hasHandler; <span class="comment">// 判断内部函数</span></span><br><span class="line">          <span class="comment">// 实例化代理对象，就是添加一下警告日志</span></span><br><span class="line">          vm._renderProxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(vm, handlers);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="comment">// 如果没有 Proxy, 直接赋值</span></span><br><span class="line">          vm._renderProxy = vm;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/*  */</span></span><br><span class="line">    <span class="comment">// _Set 是 Set 对象, 如果本身支持 Set, 那就是原生 Set, 不然就是 Vue 实现的非标准 polyfill 的 Set, 仅适用于 Vue 自己的 Set</span></span><br><span class="line">    <span class="keyword">var</span> seenObjects = <span class="keyword">new</span> _Set();</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Recursively traverse an object to evoke all converted</span></span><br><span class="line"><span class="comment">     * getters, so that every nested property inside the object</span></span><br><span class="line"><span class="comment">     * is collected as a "deep" dependency.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 递归遍历一个对象以唤起所有已转换的 getter</span></span><br><span class="line"><span class="comment">     * 以便将该对象内的每个嵌套属性收集为“深度”依赖项</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">traverse</span> (<span class="params">val</span>) </span>&#123;</span><br><span class="line">      _traverse(val, seenObjects);</span><br><span class="line">      <span class="comment">// 清空 Set</span></span><br><span class="line">      seenObjects.clear();</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">_traverse</span> (<span class="params">val, seen</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> i, keys;</span><br><span class="line">      <span class="keyword">var</span> isA = <span class="built_in">Array</span>.isArray(val);</span><br><span class="line">      <span class="comment">// 如果 val 不是数组也不是对象 或者被冻结 或者是 VNode 的实例，啥也不干直接出去</span></span><br><span class="line">      <span class="keyword">if</span> ((!isA &amp;&amp; !isObject(val)) || <span class="built_in">Object</span>.isFrozen(val) || val <span class="keyword">instanceof</span> VNode) &#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 如果 val 已经被 observe 过了</span></span><br><span class="line">      <span class="keyword">if</span> (val.__ob__) &#123;</span><br><span class="line">        <span class="comment">// 获取一下 depId</span></span><br><span class="line">        <span class="keyword">var</span> depId = val.__ob__.dep.id;</span><br><span class="line">        <span class="comment">// 如果 seen 里有这个 dep 了，就直接出去</span></span><br><span class="line">        <span class="keyword">if</span> (seen.has(depId)) &#123;</span><br><span class="line">          <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 没有就添加一下这个 depId</span></span><br><span class="line">        seen.add(depId);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 如果是数组</span></span><br><span class="line">      <span class="keyword">if</span> (isA) &#123;</span><br><span class="line">        i = val.length;</span><br><span class="line">        <span class="comment">// 遍历该数组，递归，收集依赖</span></span><br><span class="line">        <span class="keyword">while</span> (i--) &#123; _traverse(val[i], seen); &#125;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 如果是对象</span></span><br><span class="line">        keys = <span class="built_in">Object</span>.keys(val);</span><br><span class="line">        i = keys.length;</span><br><span class="line">        <span class="comment">// 同样遍历，递归，收集依赖</span></span><br><span class="line">        <span class="keyword">while</span> (i--) &#123; _traverse(val[keys[i]], seen); &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/*  */</span></span><br><span class="line">    <span class="comment">// 这个函数主要用于将传入的带有特殊前缀的事件修饰符分解为具有特定值的事件对象，并缓存</span></span><br><span class="line">    <span class="keyword">var</span> normalizeEvent = cached(<span class="function"><span class="keyword">function</span> (<span class="params">name</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> passive = name.charAt(<span class="number">0</span>) === <span class="string">'&amp;'</span>;</span><br><span class="line">      name = passive ? name.slice(<span class="number">1</span>) : name;</span><br><span class="line">      <span class="keyword">var</span> once$$<span class="number">1</span> = name.charAt(<span class="number">0</span>) === <span class="string">'~'</span>; <span class="comment">// Prefixed last, checked first</span></span><br><span class="line">      name = once$$<span class="number">1</span> ? name.slice(<span class="number">1</span>) : name;</span><br><span class="line">      <span class="keyword">var</span> capture = name.charAt(<span class="number">0</span>) === <span class="string">'!'</span>;</span><br><span class="line">      name = capture ? name.slice(<span class="number">1</span>) : name;</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        name: name,</span><br><span class="line">        once: once$$<span class="number">1</span>,</span><br><span class="line">        capture: capture,</span><br><span class="line">        passive: passive</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 创建一个调用者， Vue 给方法外面封装了一层 invoker</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">createFnInvoker</span> (<span class="params">fns, vm</span>) </span>&#123;</span><br><span class="line">      <span class="function"><span class="keyword">function</span> <span class="title">invoker</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> <span class="built_in">arguments</span>$<span class="number">1</span> = <span class="built_in">arguments</span>;</span><br><span class="line">  </span><br><span class="line">        <span class="keyword">var</span> fns = invoker.fns;</span><br><span class="line">        <span class="comment">// 如果 fns 是数组</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">Array</span>.isArray(fns)) &#123;</span><br><span class="line">          <span class="keyword">var</span> cloned = fns.slice();</span><br><span class="line">          <span class="comment">// 遍历 fns，调用它</span></span><br><span class="line">          <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; cloned.length; i++) &#123;</span><br><span class="line">            invokeWithErrorHandling(cloned[i], <span class="literal">null</span>, <span class="built_in">arguments</span>$<span class="number">1</span>, vm, <span class="string">"v-on handler"</span>);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="comment">// return handler return value for single handlers</span></span><br><span class="line">          <span class="keyword">return</span> invokeWithErrorHandling(fns, <span class="literal">null</span>, <span class="built_in">arguments</span>, vm, <span class="string">"v-on handler"</span>)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      invoker.fns = fns;</span><br><span class="line">      <span class="keyword">return</span> invoker</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 更新事件，并为新的值调用添加函数，旧的值删除函数，在 新旧 VNode 对比的时候会调用</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">updateListeners</span> (<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">      on, <span class="regexp">//</span> 新事件</span></span></span><br><span class="line"><span class="function"><span class="params">      oldOn, <span class="regexp">//</span> 旧事件</span></span></span><br><span class="line"><span class="function"><span class="params">      add, <span class="regexp">//</span> 添加事件函数</span></span></span><br><span class="line"><span class="function"><span class="params">      remove$$<span class="number">1</span>, <span class="regexp">//</span>移除事件函数</span></span></span><br><span class="line"><span class="function"><span class="params">      createOnceHandler, <span class="regexp">//</span> 创建仅执行一次的处理函数</span></span></span><br><span class="line"><span class="function"><span class="params">      vm <span class="regexp">//</span> 实例</span></span></span><br><span class="line"><span class="function"><span class="params">    </span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> name, def$$<span class="number">1</span>, cur, old, event;</span><br><span class="line">      <span class="keyword">for</span> (name <span class="keyword">in</span> on) &#123;</span><br><span class="line">        <span class="comment">// cur 就是处理方法</span></span><br><span class="line">        def$$<span class="number">1</span> = cur = on[name];</span><br><span class="line">        old = oldOn[name];</span><br><span class="line">        <span class="comment">// normalizeEvent 是缓存自定义的事件对象的方法，name 将作为事件名</span></span><br><span class="line">        event = normalizeEvent(name);</span><br><span class="line">        <span class="comment">// cur 即 现在的 on[name] 是否为 undefined 或 null, 如果是就警告</span></span><br><span class="line">        <span class="keyword">if</span> (isUndef(cur)) &#123;</span><br><span class="line">          warn(</span><br><span class="line">            <span class="string">"Invalid handler for event \""</span> + (event.name) + <span class="string">"\": got "</span> + <span class="built_in">String</span>(cur),</span><br><span class="line">            vm</span><br><span class="line">          );</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isUndef(old)) &#123;</span><br><span class="line">          <span class="comment">// 看看 oldOn[name] 是不是 undefined 或 null ，如果是的话</span></span><br><span class="line">          <span class="comment">// 就看看 cur.fns 是不是 undefined 或 null</span></span><br><span class="line">          <span class="keyword">if</span> (isUndef(cur.fns)) &#123;</span><br><span class="line">            <span class="comment">// 如果是的话，为 cur 和 on[name] 调用一下 createFnInvoker, 返回一个 Invoker()</span></span><br><span class="line">            cur = on[name] = createFnInvoker(cur, vm);</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="comment">// event.once 是否为 true, 即事件是否只调用一次</span></span><br><span class="line">          <span class="keyword">if</span> (isTrue(event.once)) &#123;</span><br><span class="line">            <span class="comment">// 一次性的处理函数</span></span><br><span class="line">            cur = on[name] = createOnceHandler(event.name, cur, event.capture);</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="comment">// 添加事件</span></span><br><span class="line">          add(event.name, cur, event.capture, event.passive, event.params);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (cur !== old) &#123;</span><br><span class="line">          <span class="comment">// 如果 cur 和 old 不一样，更新一下</span></span><br><span class="line">          old.fns = cur;</span><br><span class="line">          on[name] = old;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 遍历一下 oldOn</span></span><br><span class="line">      <span class="keyword">for</span> (name <span class="keyword">in</span> oldOn) &#123;</span><br><span class="line">        <span class="comment">// on[name] 是否为 undefined 或 null, 是的话就把它移除了</span></span><br><span class="line">        <span class="keyword">if</span> (isUndef(on[name])) &#123;</span><br><span class="line">          <span class="comment">// 缓存一下 这个事件名</span></span><br><span class="line">          event = normalizeEvent(name);</span><br><span class="line">          <span class="comment">// 移除这个事件</span></span><br><span class="line">          remove$$<span class="number">1</span>(event.name, oldOn[name], event.capture);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/*  */</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * def 可能是 data 或 vnode</span></span><br><span class="line"><span class="comment">     * vnode 时 hookKey 为 'insert' 'postpatch'</span></span><br><span class="line"><span class="comment">     * data 时 hookKey 为 'afterLeave' 'afterEnter' 'enterCancelled' 'delayLeave'</span></span><br><span class="line"><span class="comment">     * hook 为回调函数</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">mergeVNodeHook</span> (<span class="params">def, hookKey, hook</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (def <span class="keyword">instanceof</span> VNode) &#123;</span><br><span class="line">        def = def.data.hook || (def.data.hook = &#123;&#125;);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">var</span> invoker;</span><br><span class="line">      <span class="keyword">var</span> oldHook = def[hookKey];</span><br><span class="line">  </span><br><span class="line">      <span class="function"><span class="keyword">function</span> <span class="title">wrappedHook</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        hook.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">        <span class="comment">// important: remove merged hook to ensure it's called only once</span></span><br><span class="line">        <span class="comment">// and prevent memory leak</span></span><br><span class="line">        <span class="comment">// 重要：删除合并的钩子以确保仅调用一次，并防止内存泄漏</span></span><br><span class="line">        <span class="comment">// 删除 invoker.fns 数组里的 wrappedHook, indexOf 后用 splice 删除</span></span><br><span class="line">        remove(invoker.fns, wrappedHook);</span><br><span class="line">      &#125;</span><br><span class="line">  </span><br><span class="line">      <span class="keyword">if</span> (isUndef(oldHook)) &#123;</span><br><span class="line">        <span class="comment">// no existing hook</span></span><br><span class="line">        <span class="comment">// 没有现有的钩子, 创建一个 invoker</span></span><br><span class="line">        invoker = createFnInvoker([wrappedHook]);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">/* istanbul ignore if */</span></span><br><span class="line">        <span class="comment">// 如果 oldHook.fns 已定义同时 oldHook.merged 为 true</span></span><br><span class="line">        <span class="keyword">if</span> (isDef(oldHook.fns) &amp;&amp; isTrue(oldHook.merged)) &#123;</span><br><span class="line">          <span class="comment">// already a merged invoker</span></span><br><span class="line">          <span class="comment">// 表示有一个已经合并过的 invoker</span></span><br><span class="line">          invoker = oldHook;</span><br><span class="line">          <span class="comment">// 把包装好的钩子放到这个 invoker 的 fns 数组中</span></span><br><span class="line">          invoker.fns.push(wrappedHook);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="comment">// existing plain hook</span></span><br><span class="line">          <span class="comment">// 存在普通钩子, 那就新建一个 invoker, 把这普通钩子和包装后的钩子都放到新 invoker 的 fns 中</span></span><br><span class="line">          invoker = createFnInvoker([oldHook, wrappedHook]);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 把合并标志改为 true</span></span><br><span class="line">      invoker.merged = <span class="literal">true</span>;</span><br><span class="line">      <span class="comment">// 重新给 def[hookKey] 指定对象, 可能是原对象也可能是新建的 invoker(不存在 invoker 时)</span></span><br><span class="line">      def[hookKey] = invoker;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">/*  */</span></span><br><span class="line">    <span class="comment">// 从 VNode 中提取原始属性</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">extractPropsFromVNodeData</span> (<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">      data,</span></span></span><br><span class="line"><span class="function"><span class="params">      Ctor,</span></span></span><br><span class="line"><span class="function"><span class="params">      tag</span></span></span><br><span class="line"><span class="function"><span class="params">    </span>) </span>&#123;</span><br><span class="line">      <span class="comment">// we are only extracting raw values here.</span></span><br><span class="line">      <span class="comment">// validation and default values are handled in the child</span></span><br><span class="line">      <span class="comment">// component itself.</span></span><br><span class="line">      <span class="comment">// 我们只在这里提取原始值。验证和默认值在子组件本身中处理。</span></span><br><span class="line">      <span class="keyword">var</span> propOptions = Ctor.options.props;</span><br><span class="line">      <span class="comment">// 如果不存在 props, 直接出去</span></span><br><span class="line">      <span class="keyword">if</span> (isUndef(propOptions)) &#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 存在 props, 开始提取</span></span><br><span class="line">      <span class="keyword">var</span> res = &#123;&#125;;</span><br><span class="line">      <span class="keyword">var</span> attrs = data.attrs;</span><br><span class="line">      <span class="keyword">var</span> props = data.props;</span><br><span class="line">      <span class="comment">// 如果 attrs 或 props 定义了</span></span><br><span class="line">      <span class="keyword">if</span> (isDef(attrs) || isDef(props)) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> propOptions) &#123;</span><br><span class="line">          <span class="comment">// 把驼峰格式变成连字符格式 如 myValue -&gt;  my-value</span></span><br><span class="line">          <span class="keyword">var</span> altKey = hyphenate(key);</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">var</span> keyInLowerCase = key.toLowerCase();</span><br><span class="line">            <span class="keyword">if</span> (</span><br><span class="line">              <span class="comment">// 如果 key 不是全小写格式，同时存在 attrs[key]</span></span><br><span class="line">              key !== keyInLowerCase &amp;&amp;</span><br><span class="line">              attrs &amp;&amp; hasOwn(attrs, keyInLowerCase)</span><br><span class="line">            ) &#123;</span><br><span class="line">              <span class="comment">// 给出 warn, 不要用 驼峰表示组件，要用连字符</span></span><br><span class="line">              tip(</span><br><span class="line">                <span class="string">"Prop \""</span> + keyInLowerCase + <span class="string">"\" is passed to component "</span> +</span><br><span class="line">                (formatComponentName(tag || Ctor)) + <span class="string">", but the declared prop name is"</span> +</span><br><span class="line">                <span class="string">" \""</span> + key + <span class="string">"\". "</span> +</span><br><span class="line">                <span class="string">"Note that HTML attributes are case-insensitive and camelCased "</span> +</span><br><span class="line">                <span class="string">"props need to use their kebab-case equivalents when using in-DOM "</span> +</span><br><span class="line">                <span class="string">"templates. You should probably use \""</span> + altKey + <span class="string">"\" instead of \""</span> + key + <span class="string">"\"."</span></span><br><span class="line">              );</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          checkProp(res, props, key, altKey, <span class="literal">true</span>) ||</span><br><span class="line">          checkProp(res, attrs, key, altKey, <span class="literal">false</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> res</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>


      
    </div>
    
    
    

    

    
      <div class="post-share">分享到：</div>
    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div></div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>Donate</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/wechatpay.png" alt="Dloux WeChat Pay"/>
        <p>WeChat Pay</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/images/alipay.png" alt="Dloux Alipay"/>
        <p>Alipay</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Vue%E6%BA%90%E7%A0%81%E9%80%90%E8%A1%8C%E8%A7%A3%E8%AF%BB/" rel="tag"># Vue源码逐行解读</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2020/08/07/projecthabits/" rel="next" title="projecthabits">
                <i class="fa fa-chevron-left"></i> projecthabits
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2020/11/08/2020-1/" rel="prev" title="2020.1">
                2020.1 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="disqus_thread">
        <div class="disqus-loading">
          <strong>Disqus 加载中...</strong>
          <p>如果长时间无法加载，请针对 disq.us | disquscdn.com | disqus.com 启用代理</p>
        </div>
      </div>
    </div>

  





  

    
      <script type="text/javascript">
        if (disqus_config) {
          var disqus_config = function () {
            this.page.url = 'https://dloux.gitee.io/2020/09/05/Vue%E6%BA%90%E7%A0%81%E9%80%90%E8%A1%8C%E8%A7%A3%E8%AF%BB/';
            this.page.identifier = '2020/09/05/Vue源码逐行解读/';
            this.page.title = 'Vue源码逐行解读';
          };
          if (window.DISQUS) {
            $('.disqus-loading').remove();
            window.DISQUS.reset({
              reload: true,
              config: function () {
                this.page.url = 'https://dloux.gitee.io/2020/09/05/Vue%E6%BA%90%E7%A0%81%E9%80%90%E8%A1%8C%E8%A7%A3%E8%AF%BB/';
                this.page.identifier = '2020/09/05/Vue源码逐行解读/';
                this.page.title = 'Vue源码逐行解读';
              }
            });
          }
        }
        else {
          var disqus_config = function () {
            this.page.url = 'https://dloux.gitee.io/2020/09/05/Vue%E6%BA%90%E7%A0%81%E9%80%90%E8%A1%8C%E8%A7%A3%E8%AF%BB/';
            this.page.identifier = '2020/09/05/Vue源码逐行解读/';
            this.page.title = 'Vue源码逐行解读';
          };
          var d = document, s = d.createElement('script');
          s.src = 'https://diygod-me.disqus.com/embed.js';
          s.setAttribute('data-timestamp', '' + +new Date());
          (d.head || d.body).appendChild(s);
        }
      </script>
    

  




	





  















        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/sidebar-card.jpg"
                alt="Dloux" />
            
              <p class="site-author-name" itemprop="name"><span style="opacity:.2;"></span>Dloux</p>
              <p class="site-description motion-element" itemprop="description">你能抓到我么？</p>
          </div>

          <div class="links-of-author motion-element">
            
              
                <span class="links-of-author-item">
                  <a href="https://github.com/dlouxgit" target="_blank" title="GitHub" data-balloon="GitHub" data-balloon-pos="up">
                    
                      <i class="fa fa-fw fa-github"></i></a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://twitter.com/dlouxgit" target="_blank" title="Twitter" data-balloon="Twitter" data-balloon-pos="up">
                    
                      <i class="fa fa-fw fa-twitter"></i></a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="/images/qq-g.jpg" target="_blank" title="QQ 群" data-balloon="QQ 群" data-balloon-pos="up">
                    
                      <i class="fa fa-fw fa-qq"></i></a>
                </span>
              
            
          </div>

          

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">38</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">2</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            
            

          </nav>

          
          
            <div class="cc-license motion-element" itemprop="license">
              <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" target="_blank">
                <img src="/images/cc-by-nc-sa.png" alt="Creative Commons" />
              </a>
            </div>
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#前言"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-image"></div>
      <div class="footer-inner">
        <p>博客已萌萌哒运行<span id="since"></span><span class="my-face">(●'◡'●)ﾉ♥</span></p>
<p>custom text</p>

<p>© <span itemprop="copyrightYear">2021</span> Dloux.
    由 <a href="https://hexo.io/" target="_blank" class="external" rel="nofollow">Hexo</a> 强力驱动.
    Theme By <a href="https://github.com/DIYgod/hexo-theme-sagiri" target="_blank" class="external" rel="nofollow">Sagiri</a> v0.0.4.
    <a href="/sitemap.xml" target="_blank">站点地图</a>.
    xxxx.
</p>
<p>Made with <i class="fa fa-heart throb" style="color: #d43f57;"></i> by <span class="author" itemprop="copyrightHolder">Dloux</span>. </p>

        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    <canvas id="evanyou"></canvas>
    <!-- 暂时注释 live2d
    <canvas id="live2d" width="150" height="400" class="live2d"></canvas>
    -->
    

  </div>

  <script type="text/javascript" src="/js/sagiri.min.js?v=0.0.4"></script>

  





  

  
  

  

  

  

</body>
</html>
