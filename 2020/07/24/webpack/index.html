<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<script>
    (function(){
        if(''){
            if (prompt('请输入文章密码') !== ''){
                alert('密码错误！');
                history.back();
            }
        }
    })();
</script>
<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"dloux.gitee.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"right","display":"always","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="webpack4">
<meta property="og:type" content="article">
<meta property="og:title" content="webpack">
<meta property="og:url" content="https://dloux.gitee.io/2020/07/24/webpack/index.html">
<meta property="og:site_name" content="Hi, Dloux">
<meta property="og:description" content="webpack4">
<meta property="article:published_time" content="2020-07-24T14:05:17.000Z">
<meta property="article:modified_time" content="2020-09-04T07:01:25.654Z">
<meta property="article:author" content="Dloux">
<meta property="article:tag" content="webpack">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://dloux.gitee.io/2020/07/24/webpack/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-Hans'
  };
</script>

  <title>webpack | Hi, Dloux</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="تشغيل شريط التصفح">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Hi, Dloux</h1>
      
      <span class="logo-line-after">你好</span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>


 



</div>
      
      <div class="menu-header">

<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>معلومات</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>الوسوم</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>الأرشيفات</a>

  </li>
  </ul>
</nav>
</div>
      
      
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://dloux.gitee.io/2020/07/24/webpack/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/dloux.jpg">
      <meta itemprop="name" content="Dloux">
      <meta itemprop="description" content="catch fish with the hands">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hi, Dloux">
    </span>
    
  <div class="post-top">
   <div class="post-top-hover">
    
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          webpack
        </h1>

          

        
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="webpack4"><a href="#webpack4" class="headerlink" title="webpack4"></a>webpack4<a id="more"></a></h2><p><font color="red">注意：由于国内的那个 webpack 中文网一直没有更新，它上面的东西还是 webpack3 的，已经太老了，如果想要看文档的话，去官方 <code>webpack.js.org</code></font></p>
<h3 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h3><p>webpack 基于 node 环境，node 是用 C++ 开发的，不是 JS！并且它使用了 V8 引擎（谷歌出品，这也是谷歌快的原因）。V8 引擎快的原因是，可以直接把 js 代码转换成 二进制码（电脑真正能识别的代码）。正常流程是 js -&gt; 字节码 -&gt; 浏览器，V8 引擎是 js -&gt; 二进制码 -&gt; 浏览器，显然二进制比字节码更容易解析，速度更快。而 node 核心是 V8 引擎，这也是 node 能执行 js 的原因（原本 js 只能在浏览器执行），因此对 js 文件来说，就有了一个底层支撑。</p>
<h3 id="起步"><a href="#起步" class="headerlink" title="起步"></a>起步</h3><p>webpack4 与之前版本有较大不同，它已经不支持 <code>webpack 入口文件 出口文件</code> 这样的代码了，即 <code>webpack ./src/index.js ./dist/bundle.js</code> 不能用了，它会报错，提示说 mode 没有指定，可以指定值为 production 或 development，不指定默认为 production，需要到 <code>webpack.config.js</code> 配置文件中指定。同时还有一个报错，没有找到模块，不能被解析（resolve）。 webpack4 以后 webpack-cli 被单独抽离出来了，需要下载，它是必备的，安装一下 <code>npm install --save-dev webpack-cli</code></p>
<p>下载 webpack 指定版本代码 <code>npm install -D webpack@3.6</code> ，这是下载 3.6 版本的，如果只输入 3，会下载 webpack3 的最新版本</p>
<p>因此首先需要创建一个 package.json 配置文件，它是 npm 的包管理文件，可以手动创建，也可以在命令行输入 <code>npm init</code> ，默认配置的话一路回车就会自动创建一个配置文件。 <code>npm init -y</code> 也行，相当于帮你按了一路回车。</p>
<p><strong>package.json 中的 script 是调用项目下的 node_modules/.bin 里的同名文件。</strong></p>
<h3 id="一些踩坑记录"><a href="#一些踩坑记录" class="headerlink" title="一些踩坑记录"></a>一些踩坑记录</h3><ul>
<li><font size="7" font-weight="bolder">s</font>的问题： <code>webpack.config.js</code> 中， 输出写的是 module.export<font size="6" font-weight="bolder">s</font>  而不是 module.export!!! 写错了也会打包，就是默认配置，入口时 src 下的 index.js，输出到 dist/main.js。同样的，rules、options、presets、extensions、alias、plugins 的 <font size="6" font-weight="bolder">s</font> 都不要忘记加了！</li>
<li>新版中，如果没有指定 <code>mode</code>，默认指定为 <code>production</code> 生产模式，将会压缩代码，同时会给一个警告，可选值为 <code>production</code> 和 <code>development</code> 开发模式。</li>
<li>配置项中的 entry 路径，是相对于项目根目录的，而不是根据配置文件所在的位置。</li>
<li><code>webpack.config.js</code> 中， <code>entry</code> 的路径必须写成<strong>相对路径</strong>，output 的 path 的路径必须写成<strong>绝对路径</strong>（C://xxx 这种从磁盘开始的），也因此需要引入 webpack 的 path 模块，它提供了定位到当前文件夹的绝对路径的功能, <code>path.resolve(__dirname, &#39;dist&#39;)</code> dist 是指定的文件夹名，前面的 __dirname 是当前文件夹的绝对路径名，本来就可以获取到这个变量，而不是因为 path 模块导入的，path.resolve 用于拼接前后两个路径，整合成一个绝对路径</li>
<li>js 文件中，想要引入另外的文件，必须写成<strong>相对路径</strong>，如 <code>import &#39;./hello.js&#39;</code>，不能写成 <code>import &#39;hello.js&#39;</code> 或 <code>import &#39;/src/hello.js&#39;</code>，会直接报错。</li>
<li>老版中可能需要在 <code>package.json</code> 中的 <code>script</code> 设置 <code>build: webpack --config webpack.config.js</code> 才能使用我们自建的 <code>webpack.config.js</code> 文件中的配置项，现在可以直接写成 <code>build: webpack</code>，只要 JSON 文件同级目录下有 <code>webpack.config.js</code> 文件，就默认使用该文件了，同时一旦使用这个配置文件运行过一次，当前的配置项就会被缓存，当作以后的默认项，此时即使把这个文件删除，还是会有效果。</li>
<li>直接在命令行中输入 <code>webpack</code>(只要是在终端中输入命令，都是在全局)，是使用全局安装的 <code>webpack</code> 进行打包，这时如果项目中的 <code>webpack</code> 和全局的 <code>webpack</code> 版本不一致，可能会报错，因此需要在项目中安装 <code>webpack</code>，一般不使用全局，如果在 <code>package.json</code> 中配置了 <code>script</code>，像这样 <code>build: webpack</code>，之后输入 <code>npm run build</code>，这时候调用的是项目中的 <code>webpack</code></li>
<li>开发时依赖 <code>--save-dev</code>，比如 webpack，项目上线的时候是没用的。会被记录到 <code>package.json</code> 中的 <code>devDependencies</code> 属性下。<br>运行时依赖 <code>--save</code>，比如 Vue，项目上线时也需要使用它。会被记录到 <code>package.json</code> 中的 <code>dependencies</code> 属性下。</li>
<li>webpack 从主入口文件进入，只要发现里面有 require 或 import 这些导入模块的语句，就去导入该模块，如果没写就不会导入，即使已经安装了。并且如果模块中还有导入其他模块，也会导入这些模块。</li>
</ul>
<h3 id="初始配置"><a href="#初始配置" class="headerlink" title="初始配置"></a>初始配置</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    mode: <span class="string">'development'</span>,  <span class="comment">// 值可以是 'development' 或 'production', 默认 production，会将 js文件压缩。</span></span><br><span class="line">    entry: <span class="string">'./src/home.js'</span>, <span class="comment">// 入口，可以是字符串、数组、对象</span></span><br><span class="line">    output: &#123; <span class="comment">// 出口， 通常是一个对象，至少包含了 filename 和 path 两个重要属性</span></span><br><span class="line">        path: path.resolve(__dirname, <span class="string">'dist'</span>),</span><br><span class="line">        filename: <span class="string">'inde11x.js'</span>,</span><br><span class="line">        publicPath: <span class="string">'dist/'</span> <span class="comment">// 加上之后，仅仅是 index.html 中涉及到 url 的地方，前面都会加上 dist/ 这个地址。 如 图片会从 url('img.jpg') 变成 url('dist/img.jpg')，注意只是 index.html , 在项目打包后, 把 dist 文件夹给后台的时候，需要配置它， 根据后台把你文件放到相对他根路径的位置, 来决定这里写什么。因为我们默认只是放到 / 这个根路径下，后台可能会把我们打包后的文件夹丢到服务器的 /pages/admin 这样的路径下，那我们这里就需要改成 /pages/admin，然后重新打包发一份给后台</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="built_in">module</span>: &#123;</span><br><span class="line">        rules: [</span><br><span class="line">            &#123;</span><br><span class="line">                test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">                use: [&#123; <span class="attr">loader</span>: <span class="string">'style-loader'</span> &#125;, &#123; <span class="attr">loader</span>: <span class="string">'css-loader'</span> &#125;]</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="loader-部分"><a href="#loader-部分" class="headerlink" title="loader 部分"></a>loader 部分</h3><h4 id="图片处理"><a href="#图片处理" class="headerlink" title="图片处理"></a>图片处理</h4><p>图片处理，可以用 <code>url-loader</code> 或 <code>file-loader</code>，可以设置 <code>limit</code>, 图片大小小于某个值的时候使用 <code>url-loader</code>，否则使用 <code>file-loader</code>，<code>url-loader</code> 会把图片编译成 base64 字符串形式，而<code>file-loader</code> 会重新生成一个同样的图片（默认名称是 32位哈希值，目的是为了防止重名）并放到 dist 目录下。 <code>url-loader</code> 是 <code>file-loader</code> 的封装，不要设置了 <code>url-loader</code>，下面又设置了 <code>file-loader</code>，反过来同理，不会报错，但图片不会显示。 <code>use</code> 是数组，当只有一个对象时，可以写成对象。</p>
<p>自定义图片路径名字时，记得遵循格式。前面可以加上文件夹名，表示想把图片放置到 dist 的哪里，默认就在 dist 目录下， <code>[]</code> 里是变量，name 是原文件名， hash 是 32位哈希值，可以用 :Num 来决定选取多少位哈希值（还是得加上哈希值，防止项目变大的时候，前面的文件因重名而被替换）， ext 是 extention（扩展名）的意思，表示原文件的后缀名。</p>
  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    test: <span class="regexp">/\.(gif|png|jpg)$/</span>,</span><br><span class="line">    use: [</span><br><span class="line">        &#123;</span><br><span class="line">            loader: <span class="string">'url-loader'</span>,</span><br><span class="line">            options: &#123;</span><br><span class="line">                limit: <span class="number">6144</span>,  <span class="comment">// 图片小于 6KB 时，使用 url-loader, 否则使用 file-loader</span></span><br><span class="line">                name: <span class="string">'img/[name].[hash:8].[ext]'</span> <span class="comment">// 图片路径变为 img/name.xxxxxxxx.png</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="babel"><a href="#babel" class="headerlink" title="babel"></a>babel</h4><p>安装 babel 转化 ES6 代码的时候，需要先安装 loader， <code>npm install babel-loader babel-core babel-preset-env</code>（这条代码很有可能出现问题，就是下面这种）， <code>babel-loader</code> 是加载用的，<code>babel-core</code> 和安装 <code>less-loader</code> 时需要同时安装 <code>less</code> 挺像的，装了才能编译， <code>babel-preset-env</code> 是要转化的版本，老版中 -env 需要配置 <code>.babelrc</code> 文件才能使用。</p>
<p>老版 babel 中，我们可以直接指定 <code>babel-preset-es2015</code> 这样，就不需要配置 <code>.babelrc</code> 文件了，新版中 <code>babel-preset-latest、babel-preset-es2015(@babel/preset-es2015)</code> 已被废弃，需使用 <code>@babel/preset-env</code> 代替。npm 下载包的时候，没有 @ 表示非作用域包， @ 表示作用域包， @ 后面跟的是用户名或组织名，表示该用户或该组织发布的，因为没有 @ 时，这个包名可能被人注册了，无法再用了，所以加上 @，保证不会被占用，如 <code>vue-cli</code> （这种没有作用域的包可以是任何人创建的，你也可以创建个 vue-abcd 的包然后发布上去，当然这里的这个是官方的）和 <code>@vue/cli</code>，这里两个都是官方的，但因为 vue-cli 被注册了，那就只能用 <code>@vue/cli</code> 来作为新的 vue-cli 的包了。如果这个用户或组织不存在，或者它并没有发布什么内容， npm 就会报错。</p>
<p>一般 npm 一个什么包的时候，默认会在包后面加上 @lastest，表示下载最新发表的包，如  <code>npm i vue-template-compiler</code> 就相当于 <code>npm i vue-template-compiler@lastest</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">    exclude: <span class="string">'/(node_modules|bower_components)/'</span>,  <span class="comment">// 排除这两个文件夹</span></span><br><span class="line">    use: &#123;</span><br><span class="line">        loader: <span class="string">'babel-loader'</span>,</span><br><span class="line">        options: &#123;</span><br><span class="line">            presets: [<span class="string">'@babel/preset-env'</span>] <span class="comment">//编译成下载的 @babel/preset-env</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Vue"><a href="#Vue" class="headerlink" title="Vue"></a>Vue</h4><h5 id="安装-Vue"><a href="#安装-Vue" class="headerlink" title="安装 Vue"></a>安装 Vue</h5><p>Vue 发布时，会发布两种版本，一种是 runtime-only，一种是 runtime-compiler。</p>
<ul>
<li><code>runtime-only</code> ，字面意思，只有运行功能，运行时代码中不可以有任何的 template（Vue 实例挂载的 #app ）也会被当做 template。它不包含对 template 编译的代码。<strong>默认使用这个版本，如果要修改，需要到 webpack.json 去配置 resolve</strong></li>
<li><code>runtime-compiler</code>，字面意思，运行和编译功能，代码中可以有 template，compiler 用于编译 template</li>
</ul>
<h5 id="别名-alias"><a href="#别名-alias" class="headerlink" title="别名 alias"></a>别名 alias</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">    output: &#123; <span class="comment">/* ... */</span> &#125;,</span><br><span class="line">    <span class="built_in">module</span>: &#123; <span class="comment">/* ... */</span> &#125;,</span><br><span class="line">    resolve: &#123;</span><br><span class="line">        <span class="comment">/* </span></span><br><span class="line"><span class="comment">        	alias 别名的意思，git 中也有类似的操作</span></span><br><span class="line"><span class="comment">        	比如 git commit -m "提交" 太长了，我们可以给它设置别名，改成 git c "提交"</span></span><br><span class="line"><span class="comment">        	格式是 git config --global alias.别名 "命令全称"</span></span><br><span class="line"><span class="comment">        	因此写成 git config --global alias.c "commit -m"</span></span><br><span class="line"><span class="comment">        	</span></span><br><span class="line"><span class="comment">        	在这里的 alias 作用也类似，在 js 文件中，如果找到 import 'vue'，就加载 node_modules/vue/dist/vue.esm.js，也就是 runtime-compiler 版本</span></span><br><span class="line"><span class="comment">            默认加载的是 node_modules/vue/dist/vue.runtime.js，也就是 runtime-only 版本</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        alias: &#123; </span><br><span class="line">            <span class="string">'vue$'</span>: <span class="string">'vue/dist/vue.esm.js'</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 一般我们 npm install 某个插件，拿到的都是 .esm.js 版本，这是模块化(ECMAScript Module)的版本。去该插件的 github 地址里的 dist 里查看，但 vue 默认用的不是 .esm.js</span></span><br></pre></td></tr></table></figure>

<h5 id="处理-vue-文件"><a href="#处理-vue-文件" class="headerlink" title="处理 .vue 文件"></a>处理 .vue 文件</h5><p>同样的，也需要安装 loader，不过 loader 只是加载用的，并不能编译，所以还需要一个模板编译器，所以命令行输入 <code>npm i vue-loader vue-template-compiler -D</code> 安装。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 同样的，在 use 里加上</span></span><br><span class="line">&#123;</span><br><span class="line">    test: <span class="regexp">/\.vue$/</span>,</span><br><span class="line">    use: [<span class="string">'vue-loader'</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在旧版的 vue-loader （低于 14.0.0）情况下，这时候已经能运行 .vue 文件了，但在 14 版本以后，将会报错 <code>vue-loader was used without the corresponding plugin. Make sure to include VueLoaderPlugin in your webpack config.</code>，提示我们需要加上插件，那么就加一下，或者直接把版本降级，就不用加入插件了。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> VueLoaderPlugin = <span class="built_in">require</span>(<span class="string">'vue-loader/lib/plugin'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="built_in">module</span>: &#123; <span class="comment">/* ... */</span> &#125;,</span><br><span class="line">    resolve: &#123; <span class="comment">/* ... */</span> &#125;,</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> VueLoaderPlugin()</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="省略后缀名"><a href="#省略后缀名" class="headerlink" title="省略后缀名"></a>省略后缀名</h5><p>此时应该就能顺利运行 .vue 文件了，但 import 的 .vue 文件的后缀无法省略，加上以下代码后就可以省略了。默认是只能省略 .js 后缀的。但是记得，如果没有同名文件的话，就可以省略后缀，但如果有同名文件，就不能省略，否则后写的将会不生效。如 当目录下同时存在 index.css 和 index.less 文件时，且省略了后缀，变成 <code>import &#39;index&#39;; import &#39;index&#39;;</code>，那么 extensions 后写的 <code>&#39;.less&#39;</code> 将不会生效，引入的两次 index 都会变成 index.css.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ...</span></span><br><span class="line">	resolve: &#123;</span><br><span class="line">        extensions: [<span class="string">'.vue'</span>, <span class="string">'.js'</span>, <span class="string">'.css'</span>, <span class="string">'.less'</span>], <span class="comment">// 把想省的都写这。</span></span><br><span class="line">        alias: &#123;</span><br><span class="line">            <span class="string">'vue$'</span>: <span class="string">'vue/dist/vue.esm.js'</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line"><span class="comment">// ...</span></span><br></pre></td></tr></table></figure>

<h3 id="Plugins"><a href="#Plugins" class="headerlink" title="Plugins"></a>Plugins</h3><p>Plugins 可以扩展 webpack 的功能。</p>
<h4 id="清除dist目录的插件"><a href="#清除dist目录的插件" class="headerlink" title="清除dist目录的插件"></a>清除dist目录的插件</h4><p><code>clean-webpack-plugin</code> ，在每次打包前清除下dist文件夹。</p>
<h5 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h5><p><code>npm install clean-webpack-plugin -D</code></p>
<h5 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; CleanWebpackPlugin &#125; = <span class="built_in">require</span>(<span class="string">'clean-webpack-plugin'</span>) <span class="comment">// 解构赋值</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">	plugins: [</span><br><span class="line">        <span class="keyword">new</span> CleanWebpackPlugin()</span><br><span class="line">    ]</span><br><span class="line"><span class="comment">// ...</span></span><br></pre></td></tr></table></figure>

<h4 id="分离-css-文件的-Plugin"><a href="#分离-css-文件的-Plugin" class="headerlink" title="分离 css 文件的 Plugin"></a>分离 css 文件的 Plugin</h4><p><code>mini-css-extract-plugin</code> ，将会把和 bundle.js（打包后的 js 文件，写到一起可以减少请求）整合在一起的 css 单独抽离出来（方便检查）。</p>
<h5 id="安装-1"><a href="#安装-1" class="headerlink" title="安装"></a>安装</h5><p><code>npm install mini-css-extract-plugin -D</code></p>
<h5 id="使用-1"><a href="#使用-1" class="headerlink" title="使用"></a>使用</h5><p>其实就是把原来 style-loader 的位置改成了这个插件，但和其他插件不同的是，在 plugins 里 new 了之后还需要在 module.rules 中使用。</p>
<p>老版中应该使用 <code>extract-text-webpack-plugin</code> ，这里不再举例，它适用于 webpack3 而不适用于 webpack4，它也被使用在 vue-cli3 中。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> MiniCssExtractPlugin = <span class="built_in">require</span>(<span class="string">'mini-css-extract-plugin'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">    <span class="built_in">module</span>: &#123;</span><br><span class="line">        rules: [</span><br><span class="line">            &#123; <span class="comment">// 其实就是把 style-loader 改成了这个插件</span></span><br><span class="line">                test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">                use: [</span><br><span class="line">                    &#123; </span><br><span class="line">                        loader: MiniCssExtractPlugin.loader, </span><br><span class="line">                        options: &#123; </span><br><span class="line">                            publicPath: <span class="string">'../'</span>   <span class="comment">// css 文件中的引用路径前面加上 ../，注意，这也是仅作用于 css 文件的，和外面那个 publicPath 只影响 index.html 一样，它们不会互相干扰。</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    <span class="string">'css-loader'</span>  <span class="comment">// 可以用对象形式也可以用字符串形式，还可以混用。</span></span><br><span class="line">                ]</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    plugins: [ <span class="comment">// 还需要引入插件</span></span><br><span class="line">      	<span class="keyword">new</span> MiniCssExtractPlugin(&#123;</span><br><span class="line">    <span class="comment">// 指定生成路径为 dist/css/name.hash.css    name 为自己的 css 文件名  hash 为运行时系统自动生成的唯一 hash 值, 所以即使定义了同名的css, 打包也不会因为重名而失效，拓展名固定为 .css，如果用 [ext]，可能会变成 .less .scss .styl 等。</span></span><br><span class="line">    		filename: <span class="string">'css/[name].[hash:8].css'</span></span><br><span class="line">    	&#125;)</span><br><span class="line">    ]</span><br><span class="line"><span class="comment">// ...</span></span><br></pre></td></tr></table></figure>



<h4 id="添加版权的-Plugin"><a href="#添加版权的-Plugin" class="headerlink" title="添加版权的 Plugin"></a>添加版权的 Plugin</h4><p><code>BannerPlugin</code> 是 webpack 自带的插件，可以在打包后的 js 文件头部加上点想写的东西。</p>
<p>讲故事：比如 vue 前面就有一串这样的版权信息，使用 MIT 开源协议，这个协议对使用者的束缚更小，React 的协议也从 BSD + 专利条款改为更受欢迎的 MIT 许可证，原来 React 的协议允许 Facebook 随时收回 React 的使用权，随时可以告你侵权，这是一种防御性质的 license，但由于这个开源协议存在的原因，许多大公司开始弃用 React，最后 Facebook 做出让步，改为 MIT。当时使用 React 的国外大型公司有 Apache基金会、Wordpress，国内的百度等公司，那时候的这些公司都宣布弃用 React。如果希望别人使用你的代码时必须声明这是你的代码，可以使用 Apache License，开放性比较高的就是 MIT。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*!</span></span><br><span class="line"><span class="comment"> * Vue.js v2.6.11</span></span><br><span class="line"><span class="comment"> * (c) 2014-2019 Evan You</span></span><br><span class="line"><span class="comment"> * Released under the MIT License.</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>

<p>使用：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">	resolve:&#123; <span class="comment">/* ... */</span> &#125;,</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> webpack.BannerPlugin(<span class="string">'Vue.js v2.6.11'</span> + <span class="string">'\n'</span> + <span class="string">'(c) 2014-2019 Evan You'</span> + <span class="string">'\n'</span> + <span class="string">'Released under the MIT License.'</span>)</span><br><span class="line">    ]</span><br><span class="line"><span class="comment">// ...</span></span><br></pre></td></tr></table></figure>

<h4 id="在-dist-目录下添加-html-文件"><a href="#在-dist-目录下添加-html-文件" class="headerlink" title="在 dist 目录下添加 html 文件"></a>在 dist 目录下添加 html 文件</h4><p><code>htmlWebpackPlugin</code> 作用是每次 build 时，在 dist 目录下新建一个 html 文件，并自动引入打包后的 js 文件。</p>
<p>由于不是 webpack 自带的插件，需要安装： <code>npm i html-webpack-plugin -D</code></p>
<p>使用：方法接受一个对象，用于配置。当使用了这个插件之后，记得把 publicPath 给去掉，否则引入的 js 文件路径前面将会加上设置的 publicPath，就会找不到文件。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">    output: &#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">        <span class="comment">// , publicPath: 'dist/' // 这个得去掉或者注释掉。</span></span><br><span class="line">    &#125;,</span><br><span class="line">	resolve:&#123; <span class="comment">/* ... */</span> &#125;,</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">            <span class="comment">// 允许接受一个 html 模板，来控制生成的 html 里的基本内容。否则将生成一个空的 html （只有基本结构，就一个 ! 敲出来的那种）并导入 js。</span></span><br><span class="line">            template: <span class="string">'index.html'</span>  </span><br><span class="line">        &#125;)</span><br><span class="line">    ]</span><br><span class="line"><span class="comment">// ...</span></span><br></pre></td></tr></table></figure>

<h4 id="压缩代码"><a href="#压缩代码" class="headerlink" title="压缩代码"></a>压缩代码</h4><p><code>UglifyJsPlugin</code>  作用如英文翻译，丑化插件，移除代码里的未使用的内容和空格。 </p>
<h5 id="安装-2"><a href="#安装-2" class="headerlink" title="安装"></a>安装</h5><p><code>npm install uglifyjs-webpack-plugin --save-dev</code></p>
<h5 id="使用-2"><a href="#使用-2" class="headerlink" title="使用"></a>使用</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> UglifyJsPlugin = <span class="built_in">require</span>(<span class="string">'uglifyjs-webpack-plugin'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> UglifyJsPlugin()  <span class="comment">// 通用写法</span></span><br><span class="line">        <span class="comment">/*  webpack3 写法</span></span><br><span class="line"><span class="comment">           new webpack.optimize.UglifyJsPlugin() // 这种写法在 webpack3 内置了，在这个版本下，可以不用下载，但 webpack4 中移除了。</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">    ]</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">	<span class="comment">// webpack4+ 写法，在 optimization 中设置 minimize，但 webpack4+ 可以直接把 mode 设置为 production ，或者 JSON 文件中配置 "build": "webpack --mode production", 自动压缩代码，也是修改了下面的配置项。</span></span><br><span class="line">    plugins: [],</span><br><span class="line">    optimization: &#123;</span><br><span class="line">        minimize: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">	<span class="comment">// 另外可以指定压缩的插件，可以用自己下载的插件来压缩。 webpack4 中只有自己的 minimize，没有 UglifyJsPlugin 了。</span></span><br><span class="line">    <span class="comment">/*  optimization: &#123;</span></span><br><span class="line"><span class="comment">    		minimize: true,   // 当然这一行还是要加，默认为 false，不打包。</span></span><br><span class="line"><span class="comment">            minimizer: [  // 使用自己的打包插件</span></span><br><span class="line"><span class="comment">              new UglifyJsPlugin(&#123;</span></span><br><span class="line"><span class="comment">                uglifyOptions: &#123;</span></span><br><span class="line"><span class="comment">                  compress: false,</span></span><br><span class="line"><span class="comment">                &#125;</span></span><br><span class="line"><span class="comment">              &#125;)</span></span><br><span class="line"><span class="comment">            ]</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">    */</span>    </span><br><span class="line"><span class="comment">// ...</span></span><br></pre></td></tr></table></figure>

<h4 id="本地服务器"><a href="#本地服务器" class="headerlink" title="本地服务器"></a>本地服务器</h4><p><code>webpack-dev-server</code> ，用于搭建本地服务器，基于 nodejs，内部使用 express 框架，可以让它服务于 dist 文件夹，实时监听这个文件夹的改变，一旦改变，会对所有代码重新进行编译。它可以把读取的文件都存放到内存中，测试时读取文件都基于内存，内存读取速度远大于磁盘。这种情况，也就是我们说的热更新（此时相当于 vue-cli 中的 npm run serve），只有当 npm run build 之后，再把内存的文件放到磁盘中（也就是放到 dist 文件夹中，本来 dist 文件夹中是没有东西的）。</p>
<h5 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ...</span></span><br><span class="line">	optimization: &#123; <span class="comment">/* ... */</span> &#125;,</span><br><span class="line">	devServer: &#123;</span><br><span class="line">        contentBase: <span class="string">'./dist'</span>, <span class="comment">// 监听文件夹</span></span><br><span class="line">        inline: <span class="literal">true</span>, <span class="comment">// 页面刷新模式 inline 和 Iframe（构建消息在浏览器页面头部显示，会自动生成一个 头部提示框，浏览器访问是 localhost:8080/webpack-dev-server/index.html）。默认 inline(true)，构建消息在浏览器控制台显示，浏览器访问路径是 localhost:8080/index.html</span></span><br><span class="line">        port: <span class="number">8080</span>,  <span class="comment">// 指定端口 默认 8080</span></span><br><span class="line">        historyApiFallback: <span class="literal">true</span> <span class="comment">// 是否使用 h5 路由</span></span><br><span class="line">   <span class="comment">//   , open: true // 或者协商这个，下面的 --open 就可以省略了，也会自动打开浏览器。</span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">// ...</span></span><br></pre></td></tr></table></figure>

<p>安装完后在命令行中输入 <code>./node_modules/.bin/webpack-dev-server --open</code>，PowerShell 中可能需要管理员运行，编译完成即可自动打开网页（<code>--open</code> 在编译完后自动打开该端口），并监听该端口。</p>
<p>也可以在 package.json 中的 script 配置如下，之后 npm run dev 即可达到和上面的命令一样的效果。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"scripts"</span>: &#123;</span><br><span class="line">  <span class="string">"dev"</span>: <span class="string">"webpack-dev-server --open"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="拆分-webpack-config-js-配置文件"><a href="#拆分-webpack-config-js-配置文件" class="headerlink" title="拆分 webpack.config.js 配置文件"></a>拆分 webpack.config.js 配置文件</h3><h4 id="拆分"><a href="#拆分" class="headerlink" title="拆分"></a>拆分</h4><p>由于生产模式和开发模式需要的配置项不同，不希望混用，但又存在较多的公共样式，所以需要拆分。</p>
<p>把原来的 webpack.config.js 拆分成 base.config.js(公共) 、prod.config.js(生产)、dev.config.js(开发) 三个配置项。此时，抽离原配置文件的公共项到 base.config.js 中，排除非公共项，如开发不需要 UglifyJsPlugin，生产不需要 devServer。prod.config.js 中只写生产需要，dev.config.js 只写开发需要。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// base.config.js</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"><span class="keyword">const</span> VueLoaderPlugin = <span class="built_in">require</span>(<span class="string">'vue-loader/lib/plugin'</span>)</span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>)</span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>)</span><br><span class="line"><span class="keyword">const</span> MiniCssExtractPlugin = <span class="built_in">require</span>(<span class="string">'mini-css-extract-plugin'</span>)</span><br><span class="line"><span class="keyword">const</span> &#123; CleanWebpackPlugin &#125; = <span class="built_in">require</span>(<span class="string">'clean-webpack-plugin'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    mode: <span class="string">'development'</span>,</span><br><span class="line">    entry: <span class="string">'./src/home.js'</span>,</span><br><span class="line">    output: &#123;</span><br><span class="line">        path: path.resolve(__dirname, <span class="string">'dist'</span>),</span><br><span class="line">        filename: <span class="string">'index.js'</span></span><br><span class="line">        <span class="comment">// ,</span></span><br><span class="line">        <span class="comment">// publicPath: 'dist/'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="built_in">module</span>: &#123;</span><br><span class="line">        rules: [</span><br><span class="line">            &#123;</span><br><span class="line">                test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">                use: [&#123; <span class="attr">loader</span>: MiniCssExtractPlugin.loader, <span class="attr">options</span>: &#123; <span class="attr">publicPath</span>: <span class="string">'../'</span> &#125; &#125;, <span class="string">'css-loader'</span>]</span><br><span class="line"></span><br><span class="line">                <span class="comment">// use: ['style-loader', 'css-loader']</span></span><br><span class="line">                <span class="comment">// use: [&#123; loader: 'style-loader' &#125;, &#123; loader: 'css-loader' &#125;]</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                test: <span class="regexp">/\.less$/</span>,</span><br><span class="line">                use: [ &#123; <span class="attr">loader</span>: MiniCssExtractPlugin.loader, <span class="attr">options</span>: &#123; <span class="attr">publicPath</span>: <span class="string">'../'</span> &#125; &#125;, <span class="string">'css-loader'</span>, <span class="string">'less-loader'</span>]</span><br><span class="line">                <span class="comment">// use: ['style-loader', 'css-loader', 'less-loader']</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                test: <span class="regexp">/\.(gif|png|jpg)$/</span>,</span><br><span class="line">                use: [</span><br><span class="line">                    &#123;</span><br><span class="line">                        loader: <span class="string">'url-loader'</span>,</span><br><span class="line">                        options: &#123;</span><br><span class="line">                            limit: <span class="number">6000</span>,</span><br><span class="line">                            name: <span class="string">'img/[name].[hash:8].[ext]'</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                ]</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">                exclude: <span class="string">'/(node_modules|bower_components)/'</span>,</span><br><span class="line">                use: &#123;</span><br><span class="line">                    loader: <span class="string">'babel-loader'</span>,</span><br><span class="line">                    options: &#123;</span><br><span class="line">                        presets: [<span class="string">'@babel/preset-env'</span>]</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                test: <span class="regexp">/\.vue$/</span>,</span><br><span class="line">                use: [<span class="string">'vue-loader'</span>]</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    resolve: &#123;</span><br><span class="line">        extensions: [<span class="string">'.vue'</span>, <span class="string">'.js'</span>, <span class="string">'.css'</span>, <span class="string">'.less'</span>],</span><br><span class="line">        alias: &#123;</span><br><span class="line">            <span class="string">'vue$'</span>: <span class="string">'vue/dist/vue.esm.js'</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> VueLoaderPlugin(),</span><br><span class="line">        <span class="keyword">new</span> webpack.BannerPlugin(</span><br><span class="line">        <span class="string">'Vue.js v2.6.11'</span> + <span class="string">'\n'</span> + <span class="string">'(c) 2014-2019 Evan You'</span> + <span class="string">'\n'</span> + <span class="string">'Released under the MIT License.'</span></span><br><span class="line">        ),</span><br><span class="line">        <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">            template: <span class="string">'index.html'</span></span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="keyword">new</span> MiniCssExtractPlugin(&#123;</span><br><span class="line">            filename: <span class="string">'css/[name].[hash:8].css'</span></span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="keyword">new</span> CleanWebpackPlugin()</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// prod.config.js</span></span><br><span class="line"><span class="keyword">const</span> UglifyJsPlugin = <span class="built_in">require</span>(<span class="string">'uglifyjs-webpack-plugin'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    optimization: &#123;</span><br><span class="line">        minimize: <span class="literal">true</span>,</span><br><span class="line">        minimizer: [<span class="keyword">new</span> UglifyJsPlugin()]</span><br><span class="line">    &#125;    </span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// dev.config.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    devServer: &#123;</span><br><span class="line">        contentBase: <span class="string">'./dist'</span>,</span><br><span class="line">        inline: <span class="literal">false</span>,</span><br><span class="line">        port: <span class="number">8080</span>,</span><br><span class="line">        historyApiFallback: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>此时，分离之后，就需要整合。需要下载 merge 工具。</p>
<h4 id="安装-3"><a href="#安装-3" class="headerlink" title="安装"></a>安装</h4><p><code>npm install webpack-merge -D</code></p>
<h4 id="使用-3"><a href="#使用-3" class="headerlink" title="使用"></a>使用</h4><p>在两种模式的头部引入公共配置和 merge，之后调用 merge 函数。之后就写成这样了。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// dev.config.js</span></span><br><span class="line"><span class="keyword">const</span> &#123; merge &#125; = <span class="built_in">require</span>(<span class="string">'webpack-merge'</span>)</span><br><span class="line"><span class="keyword">const</span> baseConfig = <span class="built_in">require</span>(<span class="string">'./base.config.js'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = merge(baseConfig, &#123;</span><br><span class="line">    devServer: &#123;</span><br><span class="line">        contentBase: <span class="string">'./dist'</span>,</span><br><span class="line">        inline: <span class="literal">true</span>,</span><br><span class="line">        port: <span class="number">8080</span>,</span><br><span class="line">        historyApiFallback: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// prod.config.js</span></span><br><span class="line"><span class="keyword">const</span> UglifyJsPlugin = <span class="built_in">require</span>(<span class="string">'uglifyjs-webpack-plugin'</span>)</span><br><span class="line"><span class="keyword">const</span> &#123; merge &#125; = <span class="built_in">require</span>(<span class="string">'webpack-merge'</span>)</span><br><span class="line"><span class="keyword">const</span> baseConfig = <span class="built_in">require</span>(<span class="string">'./base.config.js'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = merge(baseConfig, &#123;</span><br><span class="line">    optimization: &#123;</span><br><span class="line">        minimize: <span class="literal">true</span>,</span><br><span class="line">        minimizer: [<span class="keyword">new</span> UglifyJsPlugin()]</span><br><span class="line">    &#125;    </span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment">	新版 webpack-merge 与老版写法不一致，这是因为新版源码中向外暴露对象的写法与老版不一致。</span></span><br><span class="line"><span class="comment"> 	新版文件中暴露的接口是这样写的： export &#123; merge, mergeWithCustomize, unique, customizeArray, customizeObject &#125;</span></span><br><span class="line"><span class="comment"> 	所以可以使用解构赋值来获取 merge</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 老版 webpack-merge 写法</span></span><br><span class="line"><span class="keyword">const</span> webpackMerge = <span class="built_in">require</span>(<span class="string">'webpack-merge'</span>)</span><br><span class="line"><span class="built_in">module</span>.exports = webpackMerge(baseConfig, &#123;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">    &#125;    </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>这样就分离完成了。</p>
<p>当然，我们一般不会把这三个配置项都放下根目录下，一般做法是在根目录下新建一个 build 文件夹，并把这三个配置项都放进去，并移除旧的在根目录下 的 webpack.config.js。</p>
<p>由于我们把配置文件位置移动了，因此，base.config.js 的打包路径也需要改动，否则 dist 会打包到 build 目录下。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// base.config.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    entry: <span class="string">'./src/home.js'</span>,   <span class="comment">// 入口是不需要修改的，因为它本身是相对于项目根目录的，而不是配置文件位置</span></span><br><span class="line">    output: &#123;</span><br><span class="line">        path: path.resolve(__dirname, <span class="string">'../dist'</span>), <span class="comment">// 由于移到了 build 里面而不是根目录，需要返回上一级。</span></span><br><span class="line">        filename: <span class="string">'index.js'</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>接着需要把 package.json 中的配置修改一下。</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"scripts"</span>: &#123;</span><br><span class="line">    <span class="attr">"test"</span>: <span class="string">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span>,</span><br><span class="line">    <span class="attr">"build"</span>: <span class="string">"webpack --config ./build/prod.config.js"</span>, </span><br><span class="line">    <span class="attr">"dev"</span>: <span class="string">"webpack-dev-server --config ./build/dev.config.js --open"</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>--config</code> 表示变量 config 配置项，使用它后面空格之后的内容。这里表示 config 配置文件使用 ./build/prod.config.js ）生产）或 ./build/dev.config.js（开发）。</p>
<p>结束。</p>
<p>附上原来的未拆分版本</p>
<h2 id="原完整未拆分版本"><a href="#原完整未拆分版本" class="headerlink" title="原完整未拆分版本"></a>原完整未拆分版本</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js</span></span><br><span class="line"><span class="comment">// 未使用 clean-webpack-plugin 和 mini-css-extract-plugin</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"><span class="keyword">const</span> VueLoaderPlugin = <span class="built_in">require</span>(<span class="string">'vue-loader/lib/plugin'</span>)</span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>)</span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>)</span><br><span class="line"><span class="keyword">const</span> UglifyJsPlugin = <span class="built_in">require</span>(<span class="string">'uglifyjs-webpack-plugin'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    mode: <span class="string">'development'</span>, <span class="comment">// 值可以是 'development' 或 'production', 默认 production，会将 js文件压缩。</span></span><br><span class="line">    entry: <span class="string">'./src/home.js'</span>, <span class="comment">// 入口，可以是字符串、数组、对象</span></span><br><span class="line">    output: &#123; <span class="comment">// 出口， 通常是一个对象，至少包含了 filename 和 path 两个重要属性</span></span><br><span class="line">        path: path.resolve(__dirname, <span class="string">'dist'</span>), </span><br><span class="line">        filename: <span class="string">'index.js'</span></span><br><span class="line">        <span class="comment">// ,</span></span><br><span class="line">        <span class="comment">// publicPath: 'dist/' // 加上之后，仅仅是 index.html 中涉及到 url 的地方，前面都会加上 dist/ 这个地址。 如 图片会从 url('img.jpg') 变成 url('dist/img.jpg')，注意只是 index.html</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="built_in">module</span>: &#123;</span><br><span class="line">        rules: [</span><br><span class="line">            &#123;</span><br><span class="line">                test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">                use: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>]</span><br><span class="line">                <span class="comment">// use: [&#123; loader: 'style-loader' &#125;, &#123; loader: 'css-loader' &#125;]</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                test: <span class="regexp">/\.less$/</span>,</span><br><span class="line">                use: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>, <span class="string">'less-loader'</span>]</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                test: <span class="regexp">/\.(gif|png|jpg)$/</span>,</span><br><span class="line">                use: [</span><br><span class="line">                    &#123;</span><br><span class="line">                        loader: <span class="string">'url-loader'</span>,</span><br><span class="line">                        options: &#123;</span><br><span class="line">                            limit: <span class="number">6000</span>,</span><br><span class="line">                            name: <span class="string">'img/[name].[hash:8].[ext]'</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                ]</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">                exclude: <span class="string">'/(node_modules|bower_components)/'</span>,</span><br><span class="line">                use: &#123;</span><br><span class="line">                    loader: <span class="string">'babel-loader'</span>,</span><br><span class="line">                    options: &#123;</span><br><span class="line">                        presets: [<span class="string">'@babel/preset-env'</span>]</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                test: <span class="regexp">/\.vue$/</span>,</span><br><span class="line">                use: [<span class="string">'vue-loader'</span>]</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    resolve: &#123;</span><br><span class="line">        extensions: [<span class="string">'.vue'</span>, <span class="string">'.js'</span>, <span class="string">'.css'</span>, <span class="string">'.less'</span>],</span><br><span class="line">        alias: &#123;</span><br><span class="line">            <span class="string">'vue$'</span>: <span class="string">'vue/dist/vue.esm.js'</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> VueLoaderPlugin(),</span><br><span class="line">        <span class="keyword">new</span> webpack.BannerPlugin(</span><br><span class="line">        <span class="string">'Vue.js v2.6.11'</span> + <span class="string">'\n'</span> + <span class="string">'(c) 2014-2019 Evan You'</span> + <span class="string">'\n'</span> + <span class="string">'Released under the MIT License.'</span></span><br><span class="line">        ),</span><br><span class="line">        <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">            template: <span class="string">'index.html'</span></span><br><span class="line">        &#125;)</span><br><span class="line">    ],</span><br><span class="line">    optimization: &#123;</span><br><span class="line">        minimize: <span class="literal">true</span>,</span><br><span class="line">        minimizer: [<span class="keyword">new</span> UglifyJsPlugin()]</span><br><span class="line">    &#125;,</span><br><span class="line">    devServer: &#123;</span><br><span class="line">        contentBase: <span class="string">'./dist'</span>,</span><br><span class="line">        inline: <span class="literal">true</span>,</span><br><span class="line">        port: <span class="number">8080</span>,</span><br><span class="line">        historyApiFallback: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="遗漏追加"><a href="#遗漏追加" class="headerlink" title="遗漏追加"></a>遗漏追加</h3><h4 id="proxy"><a href="#proxy" class="headerlink" title="proxy"></a>proxy</h4><p>同源策略是浏览器的，所以 node 不受影响。</p>
<p>开发环境通过配置 devServer 的 proxy，实现跨域，它无法应用于线上环境。因为该技术只是在 webpack 打包阶段在本地临时生成了 node server，来实现类似 nginx 的 <code>proxy_pass</code> 的反向代理效果。  <code>proxy</code> 工作原理实质上是利用 <code>http-proxy-middleware</code> 这个 http 代理中间件，实现请求转发给其他服务器。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> proxy = <span class="built_in">require</span>(<span class="string">'http-proxy-middleware'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> apiProxy = proxy(<span class="string">'/api'</span>, &#123;<span class="attr">target</span>: <span class="string">'http://www.example.org'</span>&#125;);</span><br><span class="line"><span class="comment">//                   \____/   \_____________________________/</span></span><br><span class="line"><span class="comment">//                     |                    |</span></span><br><span class="line"><span class="comment">//                   context             options</span></span><br><span class="line"><span class="comment">// content：用于定义哪些请求需要被目标主机代理</span></span><br><span class="line"><span class="comment">// option.target：目标主机（协议+主机名）</span></span><br><span class="line"><span class="comment">// 也可以简写 var apiProxy = proxy('http://www.example.org/api')</span></span><br></pre></td></tr></table></figure>

<p>线上环境可以通过配置 Ngix 来解决跨域，不过这一般是后端处理。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.export = &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    devServer: &#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">        proxy: &#123;</span><br><span class="line">            <span class="comment">// 在后台没配置 cors 的时候，可以用 proxy 来解决跨域</span></span><br><span class="line">            <span class="comment">// 将以 /admin 开头的 url 请求都配置到 target 的网站去</span></span><br><span class="line">            <span class="comment">// 此时需要把 axios 的 baseURL 关了，url 只发送 /admin, 这样就会被 webpack 代理了。</span></span><br><span class="line">            <span class="comment">// 此时相当于 在 http://www.xxxx.com 向 http://www.xxxx.com/admin/login。请求的地址就变成了 localhost:9528/admin/login。</span></span><br><span class="line">            <span class="string">'^\\/admin'</span>: &#123; <span class="comment">// 这是正则字符串, 字符串中 \\ 会变成 \</span></span><br><span class="line">                target: <span class="string">'http://www.xxxx.com'</span>,</span><br><span class="line">                changeOrigin: <span class="literal">true</span>, <span class="comment">// 是否跨域，跨域必须配置</span></span><br><span class="line">                pathRewrite: &#123;</span><br><span class="line">                <span class="comment">// 重写 /admin 变成 /dloux</span></span><br><span class="line">                <span class="comment">// 如 http://www.xxxx.com/admin/login 变成 http://www.xxxx.com/dloux/login</span></span><br><span class="line">                    <span class="string">'/admin'</span>: <span class="string">'/dloux'</span> </span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="题外："><a href="#题外：" class="headerlink" title="题外："></a>题外：</h2><h3 id="webpack-打包后的-js-文件"><a href="#webpack-打包后的-js-文件" class="headerlink" title="webpack 打包后的 js 文件"></a>webpack 打包后的 js 文件</h3><p>可以看到整个文件的格式是</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params">modules</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">return</span> __webpack_require__(__webpack_require__.s = <span class="number">0</span>)</span><br><span class="line">&#125;)([<span class="comment">/* ... */</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">// 可以看到，它是一个立即执行的匿名函数。 在它里面，定义了一个叫 __webpack_require_ 的方法，传入下面的数组参数的 id，即传入一个个模块的 id， 这个 id 是 0, 1, 2 这样的顺序，从 0 开始。按顺序执行</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__webpack_require_</span>(<span class="params">moduleId</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// ... 执行代码</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	上面立即执行的匿名函数最后一句是</span></span><br><span class="line"><span class="comment">	return __webpack_require__(__webpack_require__.s = 0)</span></span><br><span class="line"><span class="comment">	相当于下面这两行，先对 .s 赋值为 0，再获取 .s 的值，而此时值为 0。关于这个写法可以看看 《你不知道的 JS 第一章》</span></span><br><span class="line"><span class="comment">	__webpack_require__.s = 0</span></span><br><span class="line"><span class="comment">	return __webpack_require__(__webpack_require__.s)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 传入的数组参数，里面是一个个模块，都是我们自己写的 js 代码，被包装成一个个函数</span></span><br><span class="line">[</span><br><span class="line">    (<span class="function"><span class="keyword">function</span> (<span class="params"><span class="regexp">/* ... */</span></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// ... 一堆配置代码</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'我的代码1'</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// ... 它的代码，这里一般也是 console.log 什么东西</span></span><br><span class="line">    &#125;),</span><br><span class="line">    (<span class="function"><span class="keyword">function</span> (<span class="params"><span class="regexp">/* ... */</span></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// ... 一堆配置代码</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'我的代码2'</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// ... 它的代码，这里一般也是 console.log 什么东西</span></span><br><span class="line">    &#125;)</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<h3 id="Vue-cli-的-runtime-only-和-runtime-compiler"><a href="#Vue-cli-的-runtime-only-和-runtime-compiler" class="headerlink" title="Vue-cli 的 runtime-only 和 runtime-compiler"></a>Vue-cli 的 runtime-only 和 runtime-compiler</h3><p>我们用 vue-cli 构建项目时，对 vue 会有两种选择 <code>runtime-only</code> 和 <code>runtime-compiler</code>，一种能编译 template，一种不能，所以代码体积小了6KB ( 30% ).</p>
<p><code>runtime-compiler</code> 流程是 template -&gt; ast -&gt; render() -&gt; vdom -&gt; UI</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'./App.vue'</span></span><br><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">    el: <span class="string">'#app'</span>,</span><br><span class="line">    components: &#123;</span><br><span class="line">        App</span><br><span class="line">    &#125;,</span><br><span class="line">    template: <span class="string">'&lt;App /&gt;'</span>        <span class="comment">// 这个版本的 vue 文件内部有编译 template 功能，允许 template 属性</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 这个版本也允许使用下面的 render 函数，两者可以写的完全一样，也就是说，下面的版本是该版本的子集。</span></span><br></pre></td></tr></table></figure>

<p><code>runtime-only</code> 流程是 render() -&gt; vdom -&gt; UI，省去的过程在运行前由 vue-template-compiler 执行。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'./App.vue'</span></span><br><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">    el: <span class="string">'#app'</span>,</span><br><span class="line">    render: <span class="function"><span class="keyword">function</span> (<span class="params">createElement</span>) </span>&#123;  <span class="comment">// render 是一个函数，到时候会传进来一个 createElement 函数，下面说说这个函数，这个函数可以自定义渲染的内容（即 #app 被替换成什么）</span></span><br><span class="line">        <span class="keyword">return</span> createElement(App) <span class="comment">// 返回一个 VNode 即虚拟 DOM，直接交给 Vue 去渲染</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	我们发现我们不写 render 也能正常运行 Vue，这是因为Vue 内部写了个 if 判断来决定是否使用 render</span></span><br><span class="line"><span class="comment">	if (typeof this._options.render !== 'function') &#123;</span></span><br><span class="line"><span class="comment">		this.render = this.createRenderFn() // 调用另一个渲染函数</span></span><br><span class="line"><span class="comment">	&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 这个版本的 vue 文件内部没有编译 template 功能，编译 template 的任务交给了 vue-template-compiler，即把解析 template 的过程放到了运行前，而不是上面那种的运行时，将返回一个 render 函数 h，已经把 template 解析完毕。</span></span><br><span class="line"><span class="comment">// 引入 App 的时候，App 已经是个解析过后的对象了，它上面有 render 函数，而不是一大堆的 template + js + css</span></span><br></pre></td></tr></table></figure>

<p>默认传入的 <code>createElement</code> （即 h）是 Vue 里的创造 DOM 元素的方法。用法如下，参数 1 为标签，参数 2 为一个对象，表示该元素上的属性，参数 3 是一个数组，表示被该标签包裹的内容。如果参数 2 是数组，则代表该标签未定义属性，数组内容就是被标签包裹的内容。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> Vue&#123;</span><br><span class="line">    render(createElement) &#123;</span><br><span class="line">        <span class="keyword">return</span> createElement(<span class="string">'div'</span>, &#123; <span class="attr">class</span>:<span class="string">"class1"</span> &#125;, [<span class="string">'这是内容，这是生成真正 DOM 的函数，它会被挂载道页面中'</span>, createElement(<span class="string">'span'</span>),[<span class="string">'这是子元素内容，如果第二项是数组，就会自动变成内容插入。'</span>]])</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>另外 vue-cli 3+ 之后会写成这样，$mount 和 <code>el: &#39;#app&#39;</code> 几乎没有区别，在源码中， <code>el: &#39;#app&#39;</code> 会被转化为 <code>$mount(&#39;#app&#39;)</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> Vue&#123;</span><br><span class="line">	render: <span class="function"><span class="params">h</span> =&gt;</span> h(App)</span><br><span class="line">&#125;.$mount(<span class="string">'#app'</span>)</span><br></pre></td></tr></table></figure>

<h3 id="vue-cli-的配置文件位置-vuerc"><a href="#vue-cli-的配置文件位置-vuerc" class="headerlink" title="vue-cli 的配置文件位置 .vuerc"></a>vue-cli 的配置文件位置 .vuerc</h3><p>一般这些全局配置文件都在 C:\Users\Administrator，在这里也可以找到 git 的配置文件和 .npmrc ， 关于 rc 的后缀名源自 linux，表示是在命令行（终端）运行的， run command</p>
<p>在 .vuerc 中，可以修改创建的 vue 模板。就是 vue create projectname 创建后保存的模板可以在这里删除修改。</p>
<h3 id="vue-cli3-的配置文件"><a href="#vue-cli3-的配置文件" class="headerlink" title="vue-cli3+ 的配置文件"></a>vue-cli3+ 的配置文件</h3><p>vue-cli3+ 之后，作者希望 vue 可以 0 配置上手，因此创建项目后，根目录不再能看到配置文件(vue-cli2 中可以看到一堆)，这是因为 vue-cli3+ 之后，配置文件都交给 <code>@vue-cli-service</code> 托管了，在 <code>npm i @vue-cli</code> 的时候会一起下载，也因此 package.json 中的 scripts 变成了 ，都从 <code>vue-cli-sevice</code> 的配置文件中获取。</p>
<p>如果想要查看，配置文件的入口文件在 <code>/node_modules/@vue/cli-service/webpack.config.js</code>，可以根据它的导入来确认真正的配置文件。记得是找 <code>@vue</code> 文件夹。</p>
<p>另一种方法是通过 vue ui 可视化面板中的配置 选项中查看。</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"scripts"</span>: &#123;</span><br><span class="line">        <span class="attr">"serve"</span>: <span class="string">"vue-cli-service serve"</span>,</span><br><span class="line">        <span class="attr">"build"</span>: <span class="string">"vue-cli-service build"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果想要修改配置文件，可以在项目根目录下创建 vue.config,js 文件（必须是这个名字），用 <code>module.exports  = {}</code> 来导出配置，到时候就会和默认配置合并。</p>
<h3 id="输入-webpack-之后干了什么"><a href="#输入-webpack-之后干了什么" class="headerlink" title="输入 webpack 之后干了什么"></a>输入 webpack 之后干了什么</h3><p>找到 node_modules/webpack/package.json，可以看到</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">"bin": &#123;</span><br><span class="line">  "webpack": "bin/webpack.js"</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>就是执行了这个 JSON 文件同级下的 bin 文件夹内的 webpack.js</p>
<h3 id="别名-alias-在-vue-cli-中的使用"><a href="#别名-alias-在-vue-cli-中的使用" class="headerlink" title="别名 alias 在 vue-cli 中的使用"></a>别名 alias 在 vue-cli 中的使用</h3><p>可以在 <code>node_modules/@vue/cli-service/lib/config/base.js</code> 中看到，大概在 39-59 行。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// vue.config.js (这是 vue-cli3+ 之后的自定义配置文件，将会与默认配置文件混合，并且覆盖它)</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="comment">// configureWebpack 表示告诉 Vue 要配置 webpack，必须卸载这个对象里面才能配置 webpack</span></span><br><span class="line">    configureWebpack: &#123; </span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">        resolve: &#123;</span><br><span class="line">            <span class="comment">/* </span></span><br><span class="line"><span class="comment">                alias 是别名的意思，在这里配置了之后，import 就可以改写了</span></span><br><span class="line"><span class="comment">                原来在 js 中 import 的写法</span></span><br><span class="line"><span class="comment">                assets:  '../../assets/xxx' 或 '@/assets/xxx'</span></span><br><span class="line"><span class="comment">                components:  '../../components/xxx' 或 '@/components/xxx'</span></span><br><span class="line"><span class="comment">                views:  '../../views/xxx' 或 '@/views/xxx'</span></span><br><span class="line"><span class="comment">                增加别名之后在 js 中 import 的写法</span></span><br><span class="line"><span class="comment">                assets: 'assets/xxx'</span></span><br><span class="line"><span class="comment">                components: 'components/xxx'</span></span><br><span class="line"><span class="comment">                views: 'views/xxx'</span></span><br><span class="line"><span class="comment">                增加别名之后在 html 中，比如在 src 属性上写访问静态资源，前面需要加上 ~</span></span><br><span class="line"><span class="comment">                如 &lt;img src="~assets/img/img1.png"&gt;</span></span><br><span class="line"><span class="comment">            */</span></span><br><span class="line">            alias: &#123; </span><br><span class="line">                <span class="string">'@'</span>: resolve(<span class="string">'src'</span>),  <span class="comment">// 写了这行之后就可以用 @ 表示 src 路径了，自己的 webpack 中也能这样，但不知道是不是 webpack4+ 才支持。</span></span><br><span class="line">                <span class="string">'assets'</span>: <span class="string">'@/assets'</span>,   <span class="comment">// 在 vue-cli3+ 中，可以用上面定义的 @ 代表 src</span></span><br><span class="line">                <span class="string">'components'</span>: <span class="string">'@/components'</span>, <span class="comment">// 但在 vue-cli2 中不行，还是得写成 src/</span></span><br><span class="line">                <span class="string">'views'</span>: <span class="string">'@/views'</span> <span class="comment">// 比如这个 views，就得写成 resolve('src/views')</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="exe-是-execute（执行的缩写），所以那些可执行的文件都是-exe-结尾"><a href="#exe-是-execute（执行的缩写），所以那些可执行的文件都是-exe-结尾" class="headerlink" title=".exe 是 execute（执行的缩写），所以那些可执行的文件都是 .exe 结尾"></a>.exe 是 execute（执行的缩写），所以那些可执行的文件都是 .exe 结尾</h3>
    </div>

  </div>
  </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>مؤلف المقال:  </strong>Dloux
  </li>
  <li class="post-copyright-link">
    <strong>رابط المقال: </strong>
    <a href="https://dloux.gitee.io/2020/07/24/webpack/" title="webpack">https://dloux.gitee.io/2020/07/24/webpack/</a>
  </li>
  <li class="post-copyright-license">
    <strong>حقوق الملكية:  </strong>حميع المقالات في هذه المدوّنة منشورة تحت رخصة <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> إلا عند التنويه بخلافه.
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/webpack/" rel="tag"><i class="fa fa-tag"></i> webpack</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/07/22/AdvancedFunction/" rel="prev" title="AdvancedFunction">
      <i class="fa fa-chevron-left"></i> AdvancedFunction
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/08/03/router/" rel="next" title="router">
      router <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>

      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          المحتويات
        </li>
        <li class="sidebar-nav-overview">
          عام
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#webpack4"><span class="nav-number">1.</span> <span class="nav-text">webpack4</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#环境"><span class="nav-number">1.1.</span> <span class="nav-text">环境</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#起步"><span class="nav-number">1.2.</span> <span class="nav-text">起步</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#一些踩坑记录"><span class="nav-number">1.3.</span> <span class="nav-text">一些踩坑记录</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#初始配置"><span class="nav-number">1.4.</span> <span class="nav-text">初始配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#loader-部分"><span class="nav-number">1.5.</span> <span class="nav-text">loader 部分</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#图片处理"><span class="nav-number">1.5.1.</span> <span class="nav-text">图片处理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#babel"><span class="nav-number">1.5.2.</span> <span class="nav-text">babel</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Vue"><span class="nav-number">1.5.3.</span> <span class="nav-text">Vue</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#安装-Vue"><span class="nav-number">1.5.3.1.</span> <span class="nav-text">安装 Vue</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#别名-alias"><span class="nav-number">1.5.3.2.</span> <span class="nav-text">别名 alias</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#处理-vue-文件"><span class="nav-number">1.5.3.3.</span> <span class="nav-text">处理 .vue 文件</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#省略后缀名"><span class="nav-number">1.5.3.4.</span> <span class="nav-text">省略后缀名</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Plugins"><span class="nav-number">1.6.</span> <span class="nav-text">Plugins</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#清除dist目录的插件"><span class="nav-number">1.6.1.</span> <span class="nav-text">清除dist目录的插件</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#安装"><span class="nav-number">1.6.1.1.</span> <span class="nav-text">安装</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#使用"><span class="nav-number">1.6.1.2.</span> <span class="nav-text">使用</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#分离-css-文件的-Plugin"><span class="nav-number">1.6.2.</span> <span class="nav-text">分离 css 文件的 Plugin</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#安装-1"><span class="nav-number">1.6.2.1.</span> <span class="nav-text">安装</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#使用-1"><span class="nav-number">1.6.2.2.</span> <span class="nav-text">使用</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#添加版权的-Plugin"><span class="nav-number">1.6.3.</span> <span class="nav-text">添加版权的 Plugin</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#在-dist-目录下添加-html-文件"><span class="nav-number">1.6.4.</span> <span class="nav-text">在 dist 目录下添加 html 文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#压缩代码"><span class="nav-number">1.6.5.</span> <span class="nav-text">压缩代码</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#安装-2"><span class="nav-number">1.6.5.1.</span> <span class="nav-text">安装</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#使用-2"><span class="nav-number">1.6.5.2.</span> <span class="nav-text">使用</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#本地服务器"><span class="nav-number">1.6.6.</span> <span class="nav-text">本地服务器</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#配置"><span class="nav-number">1.6.6.1.</span> <span class="nav-text">配置</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#拆分-webpack-config-js-配置文件"><span class="nav-number">1.7.</span> <span class="nav-text">拆分 webpack.config.js 配置文件</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#拆分"><span class="nav-number">1.7.1.</span> <span class="nav-text">拆分</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#安装-3"><span class="nav-number">1.7.2.</span> <span class="nav-text">安装</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#使用-3"><span class="nav-number">1.7.3.</span> <span class="nav-text">使用</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#原完整未拆分版本"><span class="nav-number">2.</span> <span class="nav-text">原完整未拆分版本</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#遗漏追加"><span class="nav-number">2.1.</span> <span class="nav-text">遗漏追加</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#proxy"><span class="nav-number">2.1.1.</span> <span class="nav-text">proxy</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#题外："><span class="nav-number">3.</span> <span class="nav-text">题外：</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#webpack-打包后的-js-文件"><span class="nav-number">3.1.</span> <span class="nav-text">webpack 打包后的 js 文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Vue-cli-的-runtime-only-和-runtime-compiler"><span class="nav-number">3.2.</span> <span class="nav-text">Vue-cli 的 runtime-only 和 runtime-compiler</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#vue-cli-的配置文件位置-vuerc"><span class="nav-number">3.3.</span> <span class="nav-text">vue-cli 的配置文件位置 .vuerc</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#vue-cli3-的配置文件"><span class="nav-number">3.4.</span> <span class="nav-text">vue-cli3+ 的配置文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#输入-webpack-之后干了什么"><span class="nav-number">3.5.</span> <span class="nav-text">输入 webpack 之后干了什么</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#别名-alias-在-vue-cli-中的使用"><span class="nav-number">3.6.</span> <span class="nav-text">别名 alias 在 vue-cli 中的使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#exe-是-execute（执行的缩写），所以那些可执行的文件都是-exe-结尾"><span class="nav-number">3.7.</span> <span class="nav-text">.exe 是 execute（执行的缩写），所以那些可执行的文件都是 .exe 结尾</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Dloux"
      src="/images/dloux.jpg">
  <p class="site-author-name" itemprop="name">Dloux</p>
  <div class="site-description" itemprop="description">catch fish with the hands</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">56</span>
          <span class="site-state-item-name">المقالات</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">التصنيفات</span></a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">44</span>
        <span class="site-state-item-name">الوسوم</span>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/dlouxgit" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;dlouxgit" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Dloux</span>
</div>
  <div class="powered-by">تطبيق الموقع <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  









  <script async src="/js/cursor/fireworks.js"></script>
  <canvas class="fireworks" style="position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;" ></canvas>



<script>
  var pathName = window.document.location.pathname;
  var cont = document.getElementsByClassName("content-wrap")[0];
  console.log(cont);
  if (pathName =='/' || pathName =='/note/') {
  // if (/\//.test(window.document.location.pathname)) {
    console.log(pathName);
    console.log(cont.style.backgroundColor)
    cont.className="content-wrap transparentcont";
    // cont.style.backgroundColor = "rgba(255,255,255,0) !importent";
  }
</script>
</body>
</html>
