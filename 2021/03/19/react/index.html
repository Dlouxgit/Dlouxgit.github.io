<!DOCTYPE html>




<html class="theme-next pisces" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
    
  
  <link href="https://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet" type="text/css" />







  

<link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.css" rel="stylesheet" type="text/css" />



  

<link href="https://cdn.bootcss.com/social-share.js/1.0.9/css/share.min.css" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=0.0.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=0.0.4">



  <link rel="mask-icon" href="/images/logo.svg?v=0.0.4" color="#222">





  <meta name="keywords" content="react," />










<meta name="description" content="React åŸºç¡€ è®¾ç½®ç»„ä»¶çŠ¶æ€">
<meta property="og:type" content="article">
<meta property="og:title" content="react">
<meta property="og:url" content="https://dloux.gitee.io/2021/03/19/react/index.html">
<meta property="og:site_name" content="Dloux">
<meta property="og:description" content="React åŸºç¡€ è®¾ç½®ç»„ä»¶çŠ¶æ€">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2021-03-18T16:17:24.000Z">
<meta property="article:modified_time" content="2021-04-12T16:59:53.499Z">
<meta property="article:author" content="Dloux">
<meta property="article:tag" content="react">
<meta name="twitter:card" content="summary">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '0.0.4',
    sidebar: {"position":"right","display":"always","offset":52,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    since: '6/2/2020 11:30:00',
    onlineAPI: '',
    site: {
      title: 'Dloux',
      subtitle: '',
      author: 'Dloux'
    },
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    leancloud: {
      enable: false,
      appID: '',
      appKey: ''
    },
    favicon: {
      visibilitychange: true,
      narmal: '',
      hidden: '/images/failure.ico',
      show_text: '(/â‰§â–½â‰¦/)å’¦ï¼åˆå¥½äº†ï¼',
      hide_text: '(â—â€”â—)å–”å“Ÿï¼Œå´©æºƒå•¦ï¼'
    }
  };
</script>



  
    <script type="text/javascript" src="https://cdn.bootcss.com/jquery/2.1.3/jquery.min.js"></script>




  <link rel="canonical" href="https://dloux.gitee.io/2021/03/19/react/"/>





  <title>react | Dloux</title>
  








<meta name="generator" content="Hexo 4.2.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-right page-post-detail">
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-ä¸»é¡µ">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            ä¸»é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-å®éªŒå®¤">
          <a href="/proj" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-magic"></i> <br />
            
            å®éªŒå®¤
          </a>
        </li>
      
        
        <li class="menu-item menu-item-å½’æ¡£">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            å½’æ¡£
          </a>
        </li>
      
        
        <li class="menu-item menu-item-å…³äºæˆ‘">
          <a href="/proj/cv/resume.html" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br />
            
            å…³äºæˆ‘
          </a>
        </li>
      
        
        <li class="menu-item menu-item-åƒä¸ªé¥­">
          <a href="/proj/meal/index.html" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br />
            
            åƒä¸ªé¥­
          </a>
        </li>
      

      
      <li class="menu-item search">
          <form class="search-form">
            <input name="keyword" type="text" class="search-input" placeholder="ç«™å†…æœç´¢">
            <button type="submit" class="search-submit"><i class="fa fa-search"></i></button>
          </form>
      </li>
      <li class="menu-item online"><span id="online-count">?</span>äººåœ¨çº¿</li>
    </ul>
  

  
</nav>

<div class="site-brand-wrapper" style="background-image: url(/images/header-cat.jpg)">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <div class="brand">
        <span class="logo-line-before"><i></i></span>
        <div class="site-title">
          <div id="animate" class="animate">
            <span>D</span><span>l</span><span>o</span><span>u</span><span>x</span>
          </div>
          <div id="guide" class="guide">
            <span>D</span><span>l</span><span>o</span><span>u</span><span>x</span>
          </div>
        </div>
        <span class="logo-line-after"><i></i></span>
      </div>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>
<div class="site-master" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-master-avatar" itemprop="image" src="/images/dloux.jpg" alt="Dloux" />
    <h2 class="site-master-description" itemprop="description">
        catch fish with the hands
    </h2>
</div>


 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-date">
			<div class="post-month">03æœˆ</div>
			<div class="post-day">19</div>
	</div>
  
  <div class="post-badge">
    
      <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
        <a href="/categories/%E6%8A%80%E6%9C%AF/" itemprop="url" rel="index">
          <span itemprop="name">æŠ€æœ¯</span>
        </a>
      </span>
    
  </div>
  

  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://dloux.gitee.io/2021/03/19/react/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Dloux">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/dloux.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dloux">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">react</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2021-03-19T00:17:24+08:00">
                2021-03-19
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">â€¢</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%8A%80%E6%9C%AF/" itemprop="url" rel="index">
                    <span itemprop="name">æŠ€æœ¯</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="React-åŸºç¡€"><a href="#React-åŸºç¡€" class="headerlink" title="React åŸºç¡€"></a>React åŸºç¡€</h2><ol>
<li><p>è®¾ç½®ç»„ä»¶çŠ¶æ€<a id="more"></a></p>
<p>é€šè¿‡ <code>import React, { useState } from &#39;react&#39;;</code> æ¥ä½¿ç”¨ useState</p>
<p>å¦‚ </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> [opt, setOpt] = useState(&#123;</span><br><span class="line">    page: <span class="number">1</span>,</span><br><span class="line">    limit: <span class="number">10</span>,</span><br><span class="line">    kwd: <span class="string">''</span></span><br><span class="line">  &#125;)</span><br><span class="line"><span class="comment">// useState è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œç¬¬ä¸€ä¸ªä¸ºä¼ å…¥çš„å€¼ï¼Œç¬¬äºŒä¸ªä¸ºä¿®æ”¹ç¬¬ä¸€ä¸ªå€¼çš„æ–¹æ³•(dispatch)ï¼Œä¸€èˆ¬é€šè¿‡ç»“æ„èµ‹å€¼æ¥è·å¾—è¯¥çŠ¶æ€å’Œä¿®æ”¹çŠ¶æ€çš„æ–¹æ³•ã€‚</span></span><br><span class="line"><span class="comment">// </span></span><br><span class="line">setOpt(&#123;</span><br><span class="line">  ...opt,</span><br><span class="line">  page: <span class="number">2</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// ä¹Ÿå¯ä»¥æ¥å—ä¸€ä¸ªå‡½æ•°ã€‚</span></span><br><span class="line">setOpt(<span class="function">(<span class="params">oldOpt</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(oldOpt)</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    ...opt,</span><br><span class="line">    page: <span class="number">2</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</li>
<li><p>è·¯ç”±</p>
<p>é€šè¿‡ <code>import { history } from &#39;umi&#39;;</code>  ä½¿ç”¨ history </p>
<p>å¦‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">history.push(&#123;</span><br><span class="line">  pathname: <span class="string">'/ratings/template-list'</span>,</span><br><span class="line">  query: &#123; <span class="attr">id</span>: row.key &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¥å—</span></span><br><span class="line"><span class="keyword">this</span>.props.location.query.name</span><br><span class="line"><span class="comment">// å‚è€ƒ https://www.cnblogs.com/houjl/p/10056718.html</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>ç›‘å¬å±æ€§æ”¹å˜æ—¶è§¦å‘å‰¯ä½œç”¨</p>
<p>é€šè¿‡ <code>import { useEffect } from &#39;react&#39;;</code> æ¥ä½¿ç”¨ useEffect</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç¬¬äºŒä¸ªå‚æ•°ä¼ ç©ºæ•°ç»„ ç›¸å½“äº Vue ä¸­çš„ Created</span></span><br><span class="line">useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'ç¬¬ä¸€æ¬¡renderä¹‹åæ‰§è¡Œ!'</span>)</span><br><span class="line">  &#125;, [])</span><br><span class="line"><span class="comment">// ä¸ä¼ ç¬¬äºŒä¸ªå‚æ•° æ¯æ¬¡ render éƒ½ä¼šæ‰§è¡Œ</span></span><br><span class="line">useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'æ¯æ¬¡ render ä¹‹åæ‰§è¡Œ!'</span>)</span><br><span class="line">  &#125;)</span><br><span class="line"><span class="comment">// ç¬¬äºŒä¸ªå‚æ•°ä¸ºä¸ä¸ºç©ºæ•°ç»„æ—¶ï¼Œå½“ n å‘ç”Ÿå˜åŒ–å°±æ‰§è¡Œï¼Œç›¸å½“äº Vue Watch äº†</span></span><br><span class="line">useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'æ¯æ¬¡renderä¹‹åæ‰§è¡Œ!'</span>)</span><br><span class="line">  &#125;, [n])</span><br><span class="line"><span class="comment">// </span></span><br><span class="line">useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    	<span class="built_in">console</span>.log(<span class="string">'ç»„ä»¶è¢« componentWillUnmount ä¹‹å‰æ‰§è¡Œ!'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, [])</span><br></pre></td></tr></table></figure>
</li>
<li><p>React ä¸­çš„ ref</p>
<p>é€šè¿‡ <code>import { useRef } from &#39;react&#39;;</code> æ¥ä½¿ç”¨ useRefï¼Œå®ƒä¹Ÿå¯ä»¥è¢«ä½¿ç”¨ä¸ºå‡½æ•°å¼ç»„ä»¶ä¸­çš„ this, å› ä¸ºå‡½æ•°å¼ç»„ä»¶æ²¡æœ‰ this æ¥å­˜æ”¾ä¸œè¥¿</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æœ‰äº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦ä¿è¯å‡½æ•°ç»„ä»¶æ¯æ¬¡ render ä¹‹åï¼ŒæŸäº›å˜é‡ä¸ä¼šè¢«é‡å¤ç”³æ˜ï¼Œæ¯”å¦‚è¯´ Dom èŠ‚ç‚¹ï¼Œå®šæ—¶å™¨çš„ id ç­‰ç­‰ï¼Œåœ¨ç±»ç»„ä»¶ä¸­ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥é€šè¿‡ç»™ç±»æ·»åŠ ä¸€ä¸ªè‡ªå®šä¹‰å±æ€§æ¥ä¿ç•™ï¼Œæ¯”å¦‚è¯´ this.xxxï¼Œ ä½†æ˜¯å‡½æ•°ç»„ä»¶æ²¡æœ‰ thisï¼Œè‡ªç„¶æ— æ³•é€šè¿‡è¿™ç§æ–¹æ³•ä½¿ç”¨ï¼Œæœ‰çš„æœ‹å‹è¯´ï¼Œæˆ‘å¯ä»¥ç”¨ useState æ¥ä¿ç•™å˜é‡çš„å€¼ï¼Œä½†æ˜¯ useState ä¼šè§¦å‘ç»„ä»¶ renderï¼Œåœ¨è¿™é‡Œå®Œå…¨æ˜¯ä¸éœ€è¦çš„ï¼Œæˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨ useRef æ¥å®ç°äº†ï¼Œå…·ä½“çœ‹ä¸‹é¢ä¾‹å­</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> [ count, setCount ] = useState(<span class="number">0</span>)</span><br><span class="line">  <span class="keyword">const</span> timer = useRef(<span class="literal">null</span>)</span><br><span class="line">  <span class="keyword">let</span> timer2 </span><br><span class="line">  </span><br><span class="line">  useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> id = setInterval(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      setCount(<span class="function"><span class="params">count</span> =&gt;</span> count + <span class="number">1</span>)</span><br><span class="line">    &#125;, <span class="number">500</span>)</span><br><span class="line"></span><br><span class="line">    timer.current = id</span><br><span class="line">    timer2 = id</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      clearInterval(timer.current)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, [])</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> onClickRef = useCallback(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    clearInterval(timer.current)</span><br><span class="line">  &#125;, [])</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> onClick = useCallback(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    clearInterval(timer2)</span><br><span class="line">  &#125;, [])</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      ç‚¹å‡»æ¬¡æ•°: &#123; count &#125;</span><br><span class="line">      &lt;button onClick=&#123;onClick&#125;&gt;æ™®é€š&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">      &lt;button onClick=&#123;onClickRef&#125;&gt;useRef&lt;/</span>button&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ å½“æˆ‘ä»¬ä»¬ä½¿ç”¨æ™®é€šçš„æŒ‰é’®å»æš‚åœå®šæ—¶å™¨æ—¶å‘ç°å®šæ—¶å™¨æ— æ³•æ¸…é™¤ï¼Œå› ä¸º App ç»„ä»¶æ¯æ¬¡ renderï¼Œéƒ½ä¼šé‡æ–°ç”³æ˜ä¸€æ¬¡ timer2, å®šæ—¶å™¨çš„ id åœ¨ç¬¬äºŒæ¬¡ render æ—¶ï¼Œå°±ä¸¢å¤±äº†ï¼Œæ‰€ä»¥æ— æ³•æ¸…é™¤å®šæ—¶å™¨ï¼Œé’ˆå¯¹è¿™ç§æƒ…å†µï¼Œå°±éœ€è¦ä½¿ç”¨åˆ° useRefï¼Œæ¥ä¸ºæˆ‘ä»¬ä¿ç•™å®šæ—¶å™¨ idï¼Œç±»ä¼¼äº this.xxxï¼Œè¿™å°±æ˜¯ useRef çš„å¦å¤–ä¸€ç§ç”¨æ³•ã€‚</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ Ref.current ç›¸å½“äº Vue é‡Œåˆå§‹åŒ–æ—¶ data() return çš„å¯¹è±¡äº†ï¼ï¼ éå¸¸å…³é”®</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>umi.request ä¸­ï¼ŒGET è¯·æ±‚å¸¦æ•°ç»„æ—¶</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‚è€ƒ https://github.com/umijs/umi-request/blob/master/README_zh-CN.md</span></span><br><span class="line"><span class="keyword">import</span> request <span class="keyword">from</span> <span class="string">'@/utils/request'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">getListData</span>(<span class="params">params</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> request(<span class="string">'/api/listdata'</span>, &#123;</span><br><span class="line">    params,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å¦‚æœä¼ å…¥çš„ params ä¸º &#123; array: [0, 1] &#125; ï¼ŒæœŸæœ›è¯·æ±‚æ ¼å¼ä¸º array[0]=0&amp;array[1]=1ï¼Œ umi.request ä¼šè½¬æ¢æˆ array=0&amp;array=1 å¯¼è‡´åç«¯æ— æ³•æ¥æ”¶æ•°æ®ï¼Œå› ä¸ºå®ƒé»˜è®¤çš„åºåˆ—åŒ–æ–¹å¼æ˜¯ Qs.stringify(params, &#123; arrayFormat: 'repeat', strictNullHandling: true &#125;)</span></span><br><span class="line"><span class="comment">// å¯ä»¥ä½¿ç”¨ paramsSerializer å¯¹ params åšè‡ªå®šä¹‰çš„åºåˆ—åŒ–ã€‚ ä¸€èˆ¬å¼•å…¥ qs ä½¿ç”¨</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> Qs <span class="keyword">from</span> <span class="string">"qs"</span>;</span><br><span class="line"><span class="keyword">import</span> request <span class="keyword">from</span> <span class="string">'@/utils/request'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">getListData</span>(<span class="params">params</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> request(<span class="string">'/api/listdata'</span>, &#123;</span><br><span class="line">    paramsSerializer: <span class="function">(<span class="params">params</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> Qs.stringify(params)</span><br><span class="line">    &#125;,</span><br><span class="line">    params,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><em>ProFormCaptcha</em> ç»„ä»¶ä¸­ï¼Œä½ç‰ˆæœ¬ pro-form ä¼šå‡ºç° bug</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åŸç‰ˆ</span></span><br><span class="line">&lt;ProFormCaptcha</span><br><span class="line">  fieldProps=&#123;&#123;</span><br><span class="line">    size: <span class="string">'large'</span>,</span><br><span class="line">    prefix: <span class="xml"><span class="tag">&lt;<span class="name">MailTwoTone</span> <span class="attr">className</span>=<span class="string">&#123;styles.prefixIcon&#125;</span> /&gt;</span></span>,</span><br><span class="line">  &#125;&#125;</span><br><span class="line">  captchaProps=&#123;&#123;</span><br><span class="line">    size: <span class="string">'large'</span>,</span><br><span class="line">  &#125;&#125;</span><br><span class="line">  placeholder=&#123;intl.formatMessage(&#123;</span><br><span class="line">    id: <span class="string">'pages.login.captcha.placeholder'</span>,</span><br><span class="line">    defaultMessage: <span class="string">'è¯·è¾“å…¥éªŒè¯ç '</span>,</span><br><span class="line">  &#125;)&#125;</span><br><span class="line">  captchaTextRender=&#123;(timing, count) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (timing) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;count&#125;</span> <span class="subst">$&#123;intl.formatMessage(&#123;</span></span></span><br><span class="line"><span class="string"><span class="subst">        id: <span class="string">'pages.getCaptchaSecondText'</span>,</span></span></span><br><span class="line"><span class="string"><span class="subst">        defaultMessage: <span class="string">'è·å–éªŒè¯ç '</span>,</span></span></span><br><span class="line"><span class="string"><span class="subst">      &#125;</span>)&#125;`</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> intl.formatMessage(&#123;</span><br><span class="line">      id: <span class="string">'pages.login.phoneLogin.getVerificationCode'</span>,</span><br><span class="line">      defaultMessage: <span class="string">'è·å–éªŒè¯ç '</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;&#125;</span><br><span class="line">  name=<span class="string">"captcha"</span></span><br><span class="line">  <span class="comment">// phoneName="mobile"  åŠ å…¥è¿™ä¸€è¡Œå³å¯éªŒè¯æ‰‹æœºå·ã€‚</span></span><br><span class="line">  rules=&#123;[</span><br><span class="line">    &#123;</span><br><span class="line">      required: <span class="literal">true</span>,</span><br><span class="line">      message: (</span><br><span class="line">        &lt;FormattedMessage</span><br><span class="line">          id=<span class="string">"pages.login.captcha.required"</span></span><br><span class="line">          defaultMessage=<span class="string">"è¯·è¾“å…¥éªŒè¯ç ï¼"</span></span><br><span class="line">        /&gt;</span><br><span class="line">      ),</span><br><span class="line">    &#125;,</span><br><span class="line">  ]&#125;</span><br><span class="line">  onGetCaptcha=&#123;<span class="keyword">async</span> (mobile) =&gt; &#123;</span><br><span class="line">    form.validateFields([<span class="string">'mobile'</span>])</span><br><span class="line">      .then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(res)</span><br><span class="line">      &#125;)</span><br><span class="line">    <span class="comment">// if (!form.getFieldValue('mobile')) &#123;</span></span><br><span class="line">    <span class="comment">//   message.error('è¯·å…ˆè¾“å…¥æ‰‹æœºå·');</span></span><br><span class="line">    <span class="comment">//   return;</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">    <span class="keyword">const</span> result = <span class="keyword">await</span> getFakeCaptcha(mobile);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (result === <span class="literal">false</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    message.success(<span class="string">'è·å–éªŒè¯ç æˆåŠŸï¼éªŒè¯ç ä¸ºï¼š1234'</span>);</span><br><span class="line">  &#125;&#125;</span><br><span class="line">/&gt;</span><br><span class="line"><span class="comment">// ç‚¹å‡»è·å–éªŒè¯ç æŒ‰é’®æ—¶ï¼Œä¼šå‡ºç°è¦æ±‚éªŒè¯ç éç©ºè€Œä¸æ˜¯æ‰‹æœºå·éç©º è§£å†³æ–¹æ³•ï¼š å‡çº§ pro-form è‡³ 1.11ç‰ˆæœ¬ä»¥ä¸Š</span></span><br><span class="line"><span class="comment">// å‡çº§åç‚¹å‡»æŒ‰é’®ä¸å†è§¦å‘ éªŒè¯ç çš„éªŒè¯ã€‚è€Œæ˜¯ç›´æ¥é€šè¿‡ï¼Œçœ‹äº†æºç ä¹‹åäº†è§£åˆ°ï¼Œéœ€è¦é…ç½® phoneName="mobile"ï¼Œå°†ä¼šåœ¨è·å–éªŒè¯ç ä¹‹å‰éªŒè¯ 'mobile' è¡¨å•å­—æ®µã€‚</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>å‡½æ•°ç»„ä»¶ä¼ å€¼</p>
<p>å‡½æ•°ç»„ä»¶æ¥å—ä¸€ä¸ªå¯¹è±¡ï¼ŒæŒ‚è½½ç€ä¼ å…¥è¿›æ¥çš„å€¼</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Cmp</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">Cmp</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; value &#125; = props</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">    	&lt;div&gt;</span><br><span class="line">            &#123;value&#125; <span class="comment">/* å°†æ˜¾ç¤º 9527 */</span></span><br><span class="line">        &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ Father</span></span><br><span class="line"><span class="regexp">export default function Father() &#123;</span></span><br><span class="line"><span class="regexp">    return (</span></span><br><span class="line"><span class="regexp">    	&lt;Cmp value=&#123;9527&#125; /</span>&gt;</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><em>Authorized</em> é‰´æƒ</p>
<ol>
<li><p>ç›´æ¥å»çœ‹ utils ä¸‹çš„ Authorized.js, å‘ç°å®ƒå¼•å…¥äº†ç›¸åŒç›®å½•ä¸‹çš„ authority.js æ–‡ä»¶æ¥è·å–æƒé™ï¼ŒåŒæ—¶å¼•å…¥äº† <code>@/components/Authorized</code> ç»„ä»¶ï¼Œauthority.js ä½œç”¨æ˜¯è·å–å½“å‰ localStorage é‡Œçš„è§’è‰²åç§°ã€‚ä¹‹åæŠŠè¿™ä¸ªè§’è‰²åç§°ä¼ å…¥ <code>@/components/Authorized</code> è¿™ä¸ªç»„ä»¶ä¸­ã€‚ </p>
</li>
<li><p>æ¥åˆ° <code>@/components/Authorized/index.jsx</code> ä¹‹åå‘ç°å®ƒå¼•å…¥äº†åŒçº§ç›®å½•ä¸‹çš„ renderAuthorize.js å’Œ Authorized.jsxï¼ŒAuthorized æ˜¯ä¸€ä¸ªç»„ä»¶ï¼Œæ¥æ”¶ children, authority, noMatch ä¸‰ä¸ªå‚æ•°ï¼Œé‡Œé¢é€šè¿‡å¼•å…¥åŒçº§ç›®å½•ä¸‹çš„ checkPermissions æ¥å¾—åˆ°éœ€è¦æ¸²æŸ“çš„ domï¼Œè°ƒç”¨æ–¹å¼ä¸º check(<em>authority</em>, childrenRender, <em>noMatch</em>)ï¼Œå‚æ•°ä¸€ä¸ºé€šè¿‡æ¸²æŸ“æ‰€éœ€çš„æƒé™ï¼ˆå³åœ¨ router ä¸­å®šä¹‰çš„ç»„ä»¶çš„ authority è§’è‰²æƒé™æ•°ç»„ï¼‰ï¼Œå‚æ•°äºŒä¸ºæƒé™é€šè¿‡æ—¶æ¸²æŸ“çš„ç»„ä»¶ï¼Œå‚æ•°ä¸‰ä¸ºæƒé™ä¸é€šè¿‡æ—¶æ¸²æŸ“çš„ç»„ä»¶ã€‚è°ƒç”¨ check æ—¶ï¼Œä¼šè°ƒç”¨ checkPermissions(<em>authority</em>, CURRENT, <em>target</em>, <em>Exception</em>)ï¼Œä¸­é—´å¤šäº†ä¸€ä¸ª CURRENT å‚æ•°ï¼Œè¿™ä¸ªå‚æ•°å°±æ˜¯ä»å½“å‰ localStorage ä¸­è¯»å–çš„è§’è‰²æƒé™ï¼Œä¹‹åä¼šåˆ¤æ–­æ˜¯å¦åœ¨ authority ä¸­ï¼Œå¦‚æœå­˜åœ¨ï¼Œè¿”å› targetï¼Œå³æ­£ç¡®è·¯ç”±ï¼Œå¦åˆ™è¿”å›æœªé€šè¿‡ç»„ä»¶ï¼Œä¸€èˆ¬ä¸º 403.</p>
</li>
<li><p>renderAuthorize æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œæ¥å—ä¸€ä¸ªç»„ä»¶ï¼Œè¿”å›ä¸€ä¸ªæ–¹æ³•ï¼Œè¿”å›çš„æ–¹æ³•æ¥å—è§’è‰²åç§°ï¼Œæœ€åæŠŠä¹‹å‰çš„ç»„ä»¶è¿”å›ï¼ŒåŒæ—¶å¯¹å¤–æš´éœ²å½“å‰çš„è§’è‰²åç§° CURRENTã€‚</p>
</li>
</ol>
</li>
<li><p>é¡µé¢è·¯ç”±å®ˆå«</p>
<p>antd pro ä¸­ä½¿ç”¨ umi.jsï¼ŒæŸ¥çœ‹ <a href="https://umijs.org/zh-CN/docs/routing#redirectï¼Œé€šè¿‡åœ¨" target="_blank" rel="noopener">https://umijs.org/zh-CN/docs/routing#redirectï¼Œé€šè¿‡åœ¨</a> route ä¸­å¢åŠ  wrappers å±æ€§æ¥å®Œæˆå‰ç½®è·¯ç”±å®ˆå«</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// route</span></span><br><span class="line">&#123;</span><br><span class="line">    name: <span class="string">'task-list'</span>,</span><br><span class="line">    path: <span class="string">'/ratings/task-list'</span>,</span><br><span class="line">    wrappers: [</span><br><span class="line">      <span class="string">'./wrappers/auth'</span>,</span><br><span class="line">    ],</span><br><span class="line">    component: <span class="string">'./ratings/task-list'</span>,</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line"><span class="comment">// wrappers</span></span><br><span class="line"><span class="keyword">import</span> &#123; Redirect &#125; <span class="keyword">from</span> <span class="string">'umi'</span></span><br><span class="line"><span class="keyword">import</span> &#123; Result &#125; <span class="keyword">from</span> <span class="string">'antd'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; getAuthority &#125; <span class="keyword">from</span> <span class="string">'@/utils/authority'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (props) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> authorityList = props.route.authority  <span class="comment">// è·å–é¡µé¢æƒé™ï¼Œå¦‚æœè¯¥è·¯ç”±è®¾ç½®äº† authority å°±èƒ½è·å–åˆ°ã€‚</span></span><br><span class="line">  <span class="keyword">const</span> CURRENT = getAuthority() &amp;&amp; getAuthority()[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (CURRENT &amp;&amp; <span class="built_in">Array</span>.isArray(authorityList) &amp;&amp;  authorityList.some(<span class="function"><span class="params">authority</span> =&gt;</span> CURRENT === authority)) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &#123; props.children &#125;</span><br><span class="line">      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    )</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">  return &lt;Result</span></span><br><span class="line"><span class="regexp">  status="403"</span></span><br><span class="line"><span class="regexp">  title="403"</span></span><br><span class="line"><span class="regexp">  subTitle="Sorry, you are not authorized to access this page."</span></span><br><span class="line"><span class="regexp">  /</span>&gt;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// if (isLogin) &#123;</span></span><br><span class="line">  <span class="comment">//   return &lt;div&gt;&#123; props.children &#125;&lt;/div&gt;;</span></span><br><span class="line">  <span class="comment">//   &#125; </span></span><br><span class="line">  <span class="comment">// else &#123;</span></span><br><span class="line">    <span class="comment">// return &lt;Redirect to="/user/login" /&gt;;</span></span><br><span class="line">  <span class="comment">// &#125;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>ç™»å½•é€»è¾‘</p>
<p>ç‚¹å‡»ç™»å½•åï¼Œåœ¨ User/login/index.jsx ä¸­ä¼šè§¦å‘ handleSubmit æ–¹æ³•ï¼Œå®ƒä¼šè§¦å‘ model å±‚çš„ dispatch ï¼Œè°ƒç”¨ login/login æ¥å£ï¼Œè€Œ dispatch éœ€è¦åˆ° @/models/login.js ä¸­æŸ¥çœ‹</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// User/login/index.jsx</span></span><br><span class="line">...</span><br><span class="line"><span class="keyword">const</span> handleSubmit = <span class="function">(<span class="params">values</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; dispatch &#125; = props;</span><br><span class="line">    dispatch(&#123;</span><br><span class="line">      type: <span class="string">'login/login'</span>,</span><br><span class="line">      payload: &#123; ...values, type &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment">// login.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; stringify &#125; <span class="keyword">from</span> <span class="string">'querystring'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; history &#125; <span class="keyword">from</span> <span class="string">'umi'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; fakeAccountLogin &#125; <span class="keyword">from</span> <span class="string">'@/services/login'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; setAuthority &#125; <span class="keyword">from</span> <span class="string">'@/utils/authority'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; getPageQuery &#125; <span class="keyword">from</span> <span class="string">'@/utils/utils'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; message &#125; <span class="keyword">from</span> <span class="string">'antd'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Model = &#123;</span><br><span class="line">  namespace: <span class="string">'login'</span>,</span><br><span class="line">  state: &#123;</span><br><span class="line">    status: <span class="literal">undefined</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  effects: &#123;</span><br><span class="line">    *login(&#123; payload &#125;, &#123; call, put &#125;) &#123;</span><br><span class="line">      <span class="keyword">const</span> response = <span class="keyword">yield</span> call(fakeAccountLogin, payload);</span><br><span class="line">      <span class="built_in">console</span>.log(response)</span><br><span class="line">      <span class="keyword">yield</span> put(&#123;</span><br><span class="line">        type: <span class="string">'changeLoginStatus'</span>,</span><br><span class="line">        payload: response,</span><br><span class="line">      &#125;); <span class="comment">// Login successfully</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (response.status === <span class="string">'ok'</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> urlParams = <span class="keyword">new</span> URL(<span class="built_in">window</span>.location.href);</span><br><span class="line">        <span class="keyword">const</span> params = getPageQuery(); <span class="comment">// è·å–åœ°å€æ  ? åçš„å‚æ•° è¿”å›ä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line">        message.success(<span class="string">'ğŸ‰ ğŸ‰ ğŸ‰  ç™»å½•æˆåŠŸï¼'</span>);</span><br><span class="line">        <span class="keyword">let</span> &#123; redirect &#125; = params;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (redirect) &#123;</span><br><span class="line">          <span class="keyword">const</span> redirectUrlParams = <span class="keyword">new</span> URL(redirect);</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> (redirectUrlParams.origin === urlParams.origin) &#123;</span><br><span class="line">            redirect = redirect.substr(urlParams.origin.length);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (redirect.match(<span class="regexp">/^\/.*#/</span>)) &#123;</span><br><span class="line">              redirect = redirect.substr(redirect.indexOf(<span class="string">'#'</span>) + <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">window</span>.location.href = <span class="string">'/'</span>;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        history.replace(redirect || <span class="string">'/'</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    logout() &#123;</span><br><span class="line">      <span class="keyword">const</span> &#123; redirect &#125; = getPageQuery(); <span class="comment">// Note: There may be security issues, please note</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (<span class="built_in">window</span>.location.pathname !== <span class="string">'/user/login'</span> &amp;&amp; !redirect) &#123;</span><br><span class="line">        history.replace(&#123;</span><br><span class="line">          pathname: <span class="string">'/user/login'</span>,</span><br><span class="line">          search: stringify(&#123;</span><br><span class="line">            redirect: <span class="built_in">window</span>.location.href,</span><br><span class="line">          &#125;),</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  reducers: &#123;</span><br><span class="line">    changeLoginStatus(state, &#123; payload &#125;) &#123;</span><br><span class="line">      setAuthority(payload.currentAuthority);</span><br><span class="line">      <span class="keyword">return</span> &#123; ...state, <span class="attr">status</span>: payload.status, <span class="attr">type</span>: payload.type &#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> Model;</span><br></pre></td></tr></table></figure>
</li>
<li><p>proTable ç»„ä»¶é‡Œçš„ editable å±æ€§</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ—å‡ºçš„å¯é…ç½®é€‰é¡¹ä¸º https://www.npmjs.com/package/@ant-design/pro-table#editable</span></span><br><span class="line"><span class="comment">// é»˜è®¤ä¼šå‡ºç°ä¿å­˜ã€åˆ é™¤ã€å–æ¶ˆ ä¸‰ä¸ªæŒ‰é’®ï¼Œç°åœ¨éœ€è¦éšè—åˆ é™¤ã€‚é€šè¿‡ actionRender è‡ªå®šä¹‰æ“ä½œæ ã€‚ä½†æ— æ³•è·å–ä¿®æ”¹åè¡¨å•ï¼Œç»è¿‡ä¸€ç•ªå®éªŒï¼Œå‘ç°è¿”å›çš„ config å‚æ•°ä¸­ï¼Œé‡Œé¢çš„ form å¯¹è±¡ä¸Šå­˜åœ¨è·å–è¡¨å•å€¼çš„æ–¹æ³•ã€‚æ–‡æ¡£ä¸Šå¹¶æœªæåŠ actionRender å±æ€§çš„å…·ä½“ç”¨æ³•ã€‚ä»¥ä¸‹ä¸ºè·å–è¡Œå†…ä¿®æ”¹åè¡¨å•å…ƒç´ çš„æš‚è¡ŒåŠæ³•ï¼Œæ‰¾ä¸åˆ°å“ªä¸ªæ–¹æ³•èƒ½å¤Ÿè§¦å‘ æ–‡æ¡£ä¸­çš„ onSave æ–¹æ³•ã€‚</span></span><br><span class="line">&lt;ProTable</span><br><span class="line">      editable=&#123;&#123;</span><br><span class="line">        type: <span class="string">'multiple'</span>,</span><br><span class="line">        actionRender: <span class="function">(<span class="params">row, config</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">return</span> (</span><br><span class="line">            [</span><br><span class="line">              &lt;a </span><br><span class="line">                key=<span class="string">"save"</span></span><br><span class="line">                onClick=&#123;<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">                  <span class="keyword">const</span> opt = config.form.getFieldsValue([config.recordKey])[config.recordKey]</span><br><span class="line">                  opt.id = config.recordKey</span><br><span class="line">                  <span class="keyword">await</span> updateUser(opt)</span><br><span class="line">                  actionRef.current.reload()</span><br><span class="line">                  config.cancelEditable(config.recordKey)</span><br><span class="line">                &#125;&#125;</span><br><span class="line">              &gt;ä¿å­˜&lt;<span class="regexp">/a&gt;,</span></span><br><span class="line"><span class="regexp">              &lt;a </span></span><br><span class="line"><span class="regexp">                key="cancel"</span></span><br><span class="line"><span class="regexp">                onClick=&#123;() =&gt; config.cancelEditable(config.recordKey)&#125;</span></span><br><span class="line"><span class="regexp">              &gt;å–æ¶ˆ&lt;/</span>a&gt;</span><br><span class="line">            ]</span><br><span class="line">          )</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;&#125;</span><br><span class="line"><span class="comment">//    ...</span></span><br><span class="line">    /&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>React ä¿®æ”¹ç»„ä»¶çš„åˆå§‹å€¼ï¼Œå¦‚æ·»åŠ å’Œç¼–è¾‘ä½¿ç”¨åŒä¸€ç»„ä»¶çš„æƒ…å†µ</p>
<p>ä½¿ç”¨ä¸€ä¸ªå˜é‡å»æ§åˆ¶è¿™ä¸ªç»„ä»¶çš„æ¸²æŸ“ï¼Œå°±åƒ Vue ä¸­ v-if ä¸€æ ·</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">å¦‚</span><br><span class="line">&#123; createModalVisible &amp;&amp; <span class="xml"><span class="tag">&lt;<span class="name">ActionForm</span>/&gt;</span></span> &#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>antd ä¸­ï¼Œå½“è¡¨å•å…ƒç´ ä¸ Form ç»„ä»¶åŒæ—¶ä½¿ç”¨æ—¶ï¼Œ Form ç»„ä»¶å°†ä¼šæ¥ç®¡è¡¨å•å…ƒç´ çš„ä¸€äº›å±æ€§ï¼Œå¦‚</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> normFile = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Upload event:'</span>, e);</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">Array</span>.isArray(e)) &#123;</span><br><span class="line">        <span class="keyword">return</span> e;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> e &amp;&amp; e.fileList.filter(<span class="function"><span class="params">file</span> =&gt;</span> !!file.status);</span><br><span class="line">&#125;;</span><br><span class="line">&lt;Form&gt;</span><br><span class="line">    &#123;<span class="comment">/* æ¥ç®¡äº† name å±æ€§ */</span>&#125;</span><br><span class="line">    &lt;Form.Item</span><br><span class="line">        label=<span class="string">"æ¨¡æ¿åç§°"</span></span><br><span class="line">        name=<span class="string">"name"</span></span><br><span class="line">        rules=&#123;[</span><br><span class="line">            &#123;</span><br><span class="line">                required: <span class="literal">true</span>,</span><br><span class="line">                message: <span class="string">'è¯·è¾“å…¥æ¨¡æ¿åç§°'</span>,</span><br><span class="line">            &#125;,</span><br><span class="line">        ]&#125;</span><br><span class="line">    &gt;</span><br><span class="line">        &lt;Input /&gt;</span><br><span class="line">    &lt;<span class="regexp">/Form.Item&gt;</span></span><br><span class="line"><span class="regexp">    &#123;/</span>* æ¥ç®¡äº† name fileList å±æ€§ *<span class="regexp">/&#125;</span></span><br><span class="line"><span class="regexp">    &#123;/</span>* fileList ç”± getValueFromEvent å‡½æ•°çš„è¿”å›å€¼å®šä¹‰ *<span class="regexp">/&#125;</span></span><br><span class="line"><span class="regexp">    &#123;/</span>* valuePropName æŒ‡å®šè§¦å‘äº‹ä»¶åè¿”å›çš„ e å¯¹è±¡ä¸­çš„å±æ€§ä½œä¸ºè¯¥ FormItem å±æ€§éªŒè¯çš„æ ‡å‡†ï¼›æ¯”å¦‚ä¸‹é¢çš„ä¸Šä¼ ç»„ä»¶ä¸­å†™äº† fileListï¼Œå¦‚æœæ”¹æˆ fffï¼Œé‚£ä¹ˆåœ¨ä¸Šä¼ æ—¶è™½ç„¶æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼Œä½† FormItem æ‰¾ä¸åˆ°è¿”å›çš„äº‹ä»¶å¯¹è±¡ e ä¸­ fff å±æ€§ï¼Œä»ç„¶å®šä¹‰ä¸ºæœªä¸Šä¼ æ–‡ä»¶ï¼Œå³ä½¿ e.fileList æœ‰å€¼ï¼ŒåŒæ—¶ä¹Ÿä¸ä¼šè§¦å‘ Upload ç»„ä»¶ä¸­çš„ beforeUploadã€‚ é»˜è®¤å€¼ä¸º value *<span class="regexp">/&#125;</span></span><br><span class="line"><span class="regexp">    &lt;Form.Item</span></span><br><span class="line"><span class="regexp">        name="upload"</span></span><br><span class="line"><span class="regexp">        label="ä¸Šä¼ æ¨¡æ¿"</span></span><br><span class="line"><span class="regexp">        valuePropName="fileList"</span></span><br><span class="line"><span class="regexp">        getValueFromEvent=&#123;normFile&#125;</span></span><br><span class="line"><span class="regexp">        extra="è¯·ä¸Šä¼  excel æ ¼å¼æ–‡ä»¶"</span></span><br><span class="line"><span class="regexp">        rules=&#123;[</span></span><br><span class="line"><span class="regexp">            &#123;</span></span><br><span class="line"><span class="regexp">                required: true,</span></span><br><span class="line"><span class="regexp">                message: 'è¯·ä¸Šä¼ æ¨¡æ¿',</span></span><br><span class="line"><span class="regexp">            &#125;,</span></span><br><span class="line"><span class="regexp">        ]&#125;</span></span><br><span class="line"><span class="regexp">    &gt;</span></span><br><span class="line"><span class="regexp">        &lt;Upload </span></span><br><span class="line"><span class="regexp">            maxCount=&#123;1&#125;</span></span><br><span class="line"><span class="regexp">            listType="picture"</span></span><br><span class="line"><span class="regexp">            beforeUpload=&#123;file =&gt; &#123;</span></span><br><span class="line"><span class="regexp">				let suffix = name.substr(name.lastIndexOf("."))</span></span><br><span class="line"><span class="regexp">                if (".xls" != suffix &amp;&amp; ".xlsx" != suffix) &#123;</span></span><br><span class="line"><span class="regexp">                    return false</span></span><br><span class="line"><span class="regexp">                &#125; else &#123;</span></span><br><span class="line"><span class="regexp">                    return true</span></span><br><span class="line"><span class="regexp">                &#125;</span></span><br><span class="line"><span class="regexp">            &#125;&#125;</span></span><br><span class="line"><span class="regexp">        &gt;</span></span><br><span class="line"><span class="regexp">            &lt;Button icon=&#123;&lt;UploadOutlined /</span>&gt;&#125;&gt;ä¸Šä¼ æ¨¡æ¿&lt;<span class="regexp">/Button&gt;</span></span><br><span class="line"><span class="regexp">        &lt;/</span>Upload&gt;</span><br><span class="line"></span><br><span class="line">    &lt;<span class="regexp">/Form.Item&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>Form&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>React ä¸­æ ·å¼é—®é¢˜</p>
<p>ä¿®æ”¹ç»„ä»¶æ ·å¼ï¼Œ Vue ä¸­å¯ä»¥é€šè¿‡ä¸æ·»åŠ  scoped æˆ–è€…æ ·å¼ç©¿é€æ¥ä¿®æ”¹ç»„ä»¶æ ·å¼ï¼Œ React ä¸­é€šè¿‡å°†ç±»ååŒ…è£¹åœ¨ :global() æ¥å®ç°</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¦‚ä¸‹ .ant-statistic-title æ˜¯ antd Statistic ç»„ä»¶é»˜è®¤çš„å±æ€§å</span></span><br><span class="line"><span class="comment">// è¿™æ ·ç›´æ¥ä¿®æ”¹ä¼šç ´åå…¶ä»–çš„ç»„ä»¶çš„æ ·å¼ï¼Œå¯ä»¥åœ¨æƒ³è¦ä¿®æ”¹æ ·å¼çš„æ ‡ç­¾å¤–é¢å®šä¹‰ä¸€ä¸ªçˆ¶çº§å…ƒç´ ï¼Œåœ¨ç”¨ä¸€ä¸ªçˆ¶çº§é€‰æ‹©å™¨å°±å¯ä»¥äº†ã€‚</span></span><br><span class="line"><span class="selector-pseudo">:global(.ant-statistic-title)</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">16px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¹æ¯”åœ¨ Vue ä¸­ï¼Œå†™æ³•å¤§æ¦‚æ˜¯è¿™æ ·ï¼Œè¿™åº”è¯¥å’Œä¸Šé¢ React çš„ä¿®æ”¹æ–¹æ³•ç­‰åŒï¼Œéƒ½ä¼šä¿®æ”¹å…¶ä»–ç»„ä»¶çš„æ ·å¼ã€‚</span></span><br><span class="line">&lt;style lang="less"&gt;</span><br><span class="line">    <span class="selector-class">.ant-statistic-title</span> &#123;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">16px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"><span class="comment">// æˆ–</span></span><br><span class="line">&lt;style lang="stylus" scoped&gt;</span><br><span class="line">    &gt;&gt;&gt; <span class="selector-class">.ant-statistic-title</span> &#123;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">16px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>React ä¸­ï¼Œæ‰€æœ‰æ•°ç»„ç»„ä»¶å¿…é¡»ç»‘å®š key å€¼ï¼Œå› æ­¤åœ¨ antd ä¸­ï¼ŒTable ç»„ä»¶çš„ dataSource å’Œ columns éƒ½éœ€è¦æŒ‡å®š keyå€¼ï¼Œcolumns key å€¼åœ¨å®ƒçš„æœ¬èº«çš„æ•°ç»„ä¸­çš„æ¯ä¸ªå¯¹è±¡ä¸Šåˆ†åˆ«å®šä¹‰ï¼ŒdataSource éœ€è¦ä½¿ç”¨ rowKey æŒ‡å®šéœ€è¦ç»‘å®šçš„ ä¸»é”®ï¼Œé»˜è®¤ä¸º â€˜keyâ€™ï¼Œå¦‚æœæ•°æ®ä¸­æ²¡æœ‰ keyï¼Œå°†ä¼šæŠ¥é”™ï¼Œé”™è¯¯ä¸ºï¼Œçœ‹äº†åŠå¤©æ‰å‘ç°æ˜¯ Table ç»„ä»¶å¯¼è‡´çš„é—®é¢˜ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">devScripts.js:<span class="number">5836</span> Warning: Each child <span class="keyword">in</span> a list should have a unique <span class="string">"key"</span> prop.</span><br><span class="line"></span><br><span class="line">Check the render method <span class="keyword">of</span> <span class="string">`Body`</span>. See https:<span class="comment">//reactjs.org/link/warning-keys for more information.</span></span><br><span class="line">    at BodyRow (http:<span class="comment">//localhost:8000/vendors~p__TableList~p__Welcome~p__ratings__project-list~p__ratings__review-list~p__ratings__task-li~a67d39dd.js:2555:25)</span></span><br></pre></td></tr></table></figure>


</li>
</ol>
<ol start="16">
<li><p>antd pro ä¸­ï¼ŒProTable çš„ columns ä¸­è®¾ç½®çš„å±æ€§ï¼Œå¦‚æœä¸º dateRangeï¼Œå°†æ— æ³•è®¾ç½®æ ¼å¼åŒ–æ—¶é—´ï¼Œéœ€è¦è‡ªå·±æ‰‹åŠ¨ä¿®æ”¹</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> columns = [</span><br><span class="line">    &#123;</span><br><span class="line">      title: <span class="string">'å®Œæˆæ—¶é—´'</span>,</span><br><span class="line">      dataIndex: <span class="string">'end_at'</span>,</span><br><span class="line">      hideInTable: <span class="literal">true</span>,</span><br><span class="line">      valueType: <span class="string">'dateRange'</span>,</span><br><span class="line">      search: &#123;</span><br><span class="line">        transform: <span class="function">(<span class="params">value</span>) =&gt;</span>  (&#123; <span class="attr">end_at</span>: [value[<span class="number">0</span>].split(<span class="string">' '</span>)[<span class="number">0</span>], value[<span class="number">1</span>].split(<span class="string">' '</span>)[<span class="number">0</span>]] &#125;) <span class="comment">// æ ¼å¼åŒ–</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li><p>react ä¸­çš„ {â€¦obj} å’Œæ™®é€š JS æ–‡ä»¶ä¸­çš„ {â€¦obj} ä¸åŒï¼Œç”±äºæ­£å¸¸æƒ…å†µä¸‹ï¼ŒObject å¯¹è±¡æ²¡æœ‰å†…ç½®è¿­ä»£å™¨ï¼Œæ— æ³•ä½¿ç”¨å±•å¼€è¿ç®—ç¬¦ï¼Œä½†æ˜¯ç”±äº babel è½¬ä¹‰ï¼Œä½¿å¾— react ä¸­ä¹Ÿå¯ä»¥å¯¹å¯¹è±¡ä½¿ç”¨å±•å¼€è¿ç®—ç¬¦ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// xxx.jsx</span></span><br><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">    a: <span class="number">1</span>,</span><br><span class="line">    b: <span class="number">2</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(...obj) <span class="comment">// 1 2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// xxx.js</span></span><br><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">    a: <span class="number">1</span>,</span><br><span class="line">    b: <span class="number">2</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(...obj) <span class="comment">// error obj is not iterable</span></span><br></pre></td></tr></table></figure>



</li>
</ol>
<h2 id="é¢˜å¤–ï¼š"><a href="#é¢˜å¤–ï¼š" class="headerlink" title="é¢˜å¤–ï¼š"></a>é¢˜å¤–ï¼š</h2><h3 id="ES6-çš„è§£æ„èµ‹å€¼"><a href="#ES6-çš„è§£æ„èµ‹å€¼" class="headerlink" title="ES6 çš„è§£æ„èµ‹å€¼"></a>ES6 çš„è§£æ„èµ‹å€¼</h3><ol>
<li><h5 id="å¤šå±‚è§£æ„"><a href="#å¤šå±‚è§£æ„" class="headerlink" title="å¤šå±‚è§£æ„"></a>å¤šå±‚è§£æ„</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> res = &#123;</span><br><span class="line">    data: &#123;</span><br><span class="line">        data: &#123;</span><br><span class="line">            msg: <span class="string">'last'</span></span><br><span class="line">        &#125;,</span><br><span class="line">        meta: &#123;</span><br><span class="line">            pagination: &#123;</span><br><span class="line">                count: <span class="number">2</span>,</span><br><span class="line">                current_page: <span class="number">1</span>,</span><br><span class="line">                links: &#123;&#125;,</span><br><span class="line">                per_page: <span class="number">20</span>,</span><br><span class="line">                total: <span class="number">2</span>,</span><br><span class="line">                total_pages: <span class="number">1</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    status: <span class="string">'success'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; <span class="attr">data</span>: &#123; data, <span class="attr">meta</span>: &#123; <span class="attr">pagination</span>: &#123; total, <span class="attr">total_pages</span>: pageSize, <span class="attr">current_page</span>: current &#125; &#125; &#125;, status &#125; = res</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ­¤æ—¶èƒ½å¤Ÿè§£æ„å‡º data, total, pageSize, current, status äº”ç§å˜é‡ï¼Œ meta å’Œ pagination å¹¶ä¸æ˜¯å˜é‡</span></span><br><span class="line"><span class="built_in">console</span>.log(data) <span class="comment">// &#123; msg: 'last' &#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(total) <span class="comment">// 2</span></span><br><span class="line"><span class="built_in">console</span>.log(pageSize) <span class="comment">// 1</span></span><br><span class="line"><span class="built_in">console</span>.log(current) <span class="comment">// 1</span></span><br><span class="line"><span class="built_in">console</span>.log(status) <span class="comment">// 'success'</span></span><br><span class="line"><span class="built_in">console</span>.log(meta) <span class="comment">// ERROR meta is not defined</span></span><br><span class="line"><span class="built_in">console</span>.log(pagination) <span class="comment">// ERROR pagination is not defined</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¦‚æœéœ€è¦åŒæ—¶è§£æ„å‡º meta å’Œ pagination, åœ¨å¤–å±‚å¤šå®šä¹‰ä¸€æ¬¡å³å¯ï¼Œè§£æ„èµ‹å€¼å·²å®šä¹‰çš„å˜é‡æ°¸è¿œåœ¨ : å³è¾¹ã€‚</span></span><br><span class="line"><span class="keyword">const</span> &#123; <span class="attr">data</span>: &#123; data, meta, <span class="attr">meta</span>: &#123; pagination, <span class="attr">pagination</span>: &#123; total, <span class="attr">total_pages</span>: pageSize, <span class="attr">current_page</span>: current &#125; &#125; &#125;, status &#125; = res</span><br></pre></td></tr></table></figure>
</li>
<li><h5 id="å‰¥ç¦»å±æ€§"><a href="#å‰¥ç¦»å±æ€§" class="headerlink" title="å‰¥ç¦»å±æ€§"></a>å‰¥ç¦»å±æ€§</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ­£å¸¸å†™çš„æ—¶å€™ï¼Œåç«¯è¿”å›çš„ resData å¦‚ä¸‹ï¼Œä½†æ­¤æ—¶æˆ‘ä»¬ä¸éœ€è¦ id å’Œ category_id æ—¶ï¼Œå¯èƒ½ä¼šå†™æˆä¸‹é¢è¿™æ ·</span></span><br><span class="line"><span class="keyword">const</span> resData = [</span><br><span class="line">    &#123;</span><br><span class="line">        id: <span class="number">1</span>,</span><br><span class="line">        category_id: <span class="number">1</span>,</span><br><span class="line">        content: <span class="string">'content1'</span>,</span><br><span class="line">        detail: <span class="string">'detail1'</span>,</span><br><span class="line">        score: <span class="string">'score1'</span>,</span><br><span class="line">        type: <span class="string">'type1'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        id: <span class="number">2</span>,</span><br><span class="line">        category_id: <span class="number">2</span>,</span><br><span class="line">        content: <span class="string">'content2'</span>,</span><br><span class="line">        detail: <span class="string">'detail2'</span>,</span><br><span class="line">        score: <span class="string">'score2'</span>,</span><br><span class="line">        type: <span class="string">'type2'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> tableDataList = resData.map(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        columns,</span><br><span class="line">        data: &#123;</span><br><span class="line">            content: item.content,</span><br><span class="line">            detail: item.detail,</span><br><span class="line">            score: item.score,</span><br><span class="line">            type: item.type,</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½†æˆ‘ä»¬å¯ä»¥é€šè¿‡ ... æ¥å¿«é€Ÿå‰¥ç¦»å±æ€§ï¼Œçœç•¥äº†å¾ˆå¤šä¸å¿…è¦çš„å†™æ³•ï¼Œå¹¶ä¸”éå¸¸æ¸…æ¥š</span></span><br><span class="line"><span class="keyword">const</span> tableDataList = resData.map(<span class="function">(<span class="params">&#123; id, category_id, ...item&#125;</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        columns,</span><br><span class="line">        data: item</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ•°ç»„</span></span><br><span class="line"><span class="keyword">const</span> deleteNumber = <span class="function">(<span class="params">arr, index</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> [...arr.slice(<span class="number">0</span>, index), ...arr.slice(index + <span class="number">1</span>)];</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">let</span> testArr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"><span class="built_in">console</span>.log(deleteNumber(testArr, <span class="number">4</span>)); <span class="comment">// [1, 2, 3, 4]</span></span><br></pre></td></tr></table></figure>


</li>
</ol>
<h3 id="linux-ä¸-windows-çš„æ–‡ä»¶å"><a href="#linux-ä¸-windows-çš„æ–‡ä»¶å" class="headerlink" title="linux ä¸ windows çš„æ–‡ä»¶å"></a>linux ä¸ windows çš„æ–‡ä»¶å</h3><p>æœåŠ¡å™¨ä¸€èˆ¬æ˜¯ linux ï¼Œè€Œ linux æ˜¯å¤§å°å†™æ•æ„Ÿçš„ï¼Œ windows æ˜¯å¤§å°å†™ä¸æ•æ„Ÿçš„</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// actionForm.jsx</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> () =&gt; &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯ä»¥çœ‹åˆ°ï¼Œ ActionForm ä¸å­˜åœ¨çš„æ–‡ä»¶å actionForm ä¸å¯¹åº”ï¼Œä½† windows å¯ä»¥è¯»å–åˆ°è¿™ä¸ªæ–‡ä»¶ï¼Œlinux ä¸¥æ ¼æ£€æµ‹å¤§å°å†™ï¼Œå°†ä¸ä¼šè¯»å–</span></span><br><span class="line"><span class="keyword">import</span> ActionForm <span class="keyword">from</span> <span class="string">'./components/ActionForm'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åŒæ—¶ï¼Œå¦‚æœåœ¨ windows ä¸Šï¼Œä»…ä»…æ”¹å˜æ–‡ä»¶åçš„å¤§å°å†™ï¼Œæ˜¯ä¸ä¼šè§¦å‘ git status çŠ¶æ€çš„æ”¹å˜çš„ã€‚</span></span><br></pre></td></tr></table></figure>




      
    </div>
    
    
    

    

    
      <div class="post-share">åˆ†äº«åˆ°ï¼š</div>
    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div></div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>Donate</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/wechatpay.png" alt="Dloux WeChat Pay"/>
        <p>WeChat Pay</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/images/alipay.png" alt="Dloux Alipay"/>
        <p>Alipay</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/react/" rel="tag"># react</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2021/03/18/electron/" rel="next" title="electron">
                <i class="fa fa-chevron-left"></i> electron
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2021/03/19/vite/" rel="prev" title="vite">
                vite <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="disqus_thread">
        <div class="disqus-loading">
          <strong>Disqus åŠ è½½ä¸­...</strong>
          <p>å¦‚æœé•¿æ—¶é—´æ— æ³•åŠ è½½ï¼Œè¯·é’ˆå¯¹ disq.us | disquscdn.com | disqus.com å¯ç”¨ä»£ç†</p>
        </div>
      </div>
    </div>

  





  

    
      <script type="text/javascript">
        if (disqus_config) {
          var disqus_config = function () {
            this.page.url = 'https://dloux.gitee.io/2021/03/19/react/';
            this.page.identifier = '2021/03/19/react/';
            this.page.title = 'react';
          };
          if (window.DISQUS) {
            $('.disqus-loading').remove();
            window.DISQUS.reset({
              reload: true,
              config: function () {
                this.page.url = 'https://dloux.gitee.io/2021/03/19/react/';
                this.page.identifier = '2021/03/19/react/';
                this.page.title = 'react';
              }
            });
          }
        }
        else {
          var disqus_config = function () {
            this.page.url = 'https://dloux.gitee.io/2021/03/19/react/';
            this.page.identifier = '2021/03/19/react/';
            this.page.title = 'react';
          };
          var d = document, s = d.createElement('script');
          s.src = 'https://diygod-me.disqus.com/embed.js';
          s.setAttribute('data-timestamp', '' + +new Date());
          (d.head || d.body).appendChild(s);
        }
      </script>
    

  




	





  















        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/sidebar-card.jpg"
                alt="Dloux" />
            
              <p class="site-author-name" itemprop="name"><span style="opacity:.2;"></span>Dloux</p>
              <p class="site-description motion-element" itemprop="description">ä½ èƒ½æŠ“åˆ°æˆ‘ä¹ˆï¼Ÿ</p>
          </div>

          <div class="links-of-author motion-element">
            
              
                <span class="links-of-author-item">
                  <a href="https://github.com/dlouxgit" target="_blank" title="GitHub" data-balloon="GitHub" data-balloon-pos="up">
                    
                      <i class="fa fa-fw fa-github"></i></a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://twitter.com/dlouxgit" target="_blank" title="Twitter" data-balloon="Twitter" data-balloon-pos="up">
                    
                      <i class="fa fa-fw fa-twitter"></i></a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="/images/qq-g.jpg" target="_blank" title="QQ ç¾¤" data-balloon="QQ ç¾¤" data-balloon-pos="up">
                    
                      <i class="fa fa-fw fa-qq"></i></a>
                </span>
              
            
          </div>

          

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">55</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">5</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            
            

          </nav>

          
          
            <div class="cc-license motion-element" itemprop="license">
              <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" target="_blank">
                <img src="/images/cc-by-nc-sa.png" alt="Creative Commons" />
              </a>
            </div>
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#React-åŸºç¡€"><span class="nav-number">1.</span> <span class="nav-text">React åŸºç¡€</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#é¢˜å¤–ï¼š"><span class="nav-number">2.</span> <span class="nav-text">é¢˜å¤–ï¼š</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ES6-çš„è§£æ„èµ‹å€¼"><span class="nav-number">2.1.</span> <span class="nav-text">ES6 çš„è§£æ„èµ‹å€¼</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#å¤šå±‚è§£æ„"><span class="nav-number">2.1.0.1.</span> <span class="nav-text">å¤šå±‚è§£æ„</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#å‰¥ç¦»å±æ€§"><span class="nav-number">2.1.0.2.</span> <span class="nav-text">å‰¥ç¦»å±æ€§</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#linux-ä¸-windows-çš„æ–‡ä»¶å"><span class="nav-number">2.2.</span> <span class="nav-text">linux ä¸ windows çš„æ–‡ä»¶å</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-image"></div>
      <div class="footer-inner">
        <p>åšå®¢å·²èŒèŒå“’è¿è¡Œ<span id="since"></span><span class="my-face">(â—'â—¡'â—)ï¾‰â™¥</span></p>
<p>custom text</p>

<p>Â© <span itemprop="copyrightYear">2021</span> Dloux.
    ç”± <a href="https://hexo.io/" target="_blank" class="external" rel="nofollow">Hexo</a> å¼ºåŠ›é©±åŠ¨.
    Theme By <a href="https://github.com/DIYgod/hexo-theme-sagiri" target="_blank" class="external" rel="nofollow">Sagiri</a> v0.0.4.
    <a href="/sitemap.xml" target="_blank">ç«™ç‚¹åœ°å›¾</a>.
    xxxx.
</p>
<p>Made with <i class="fa fa-heart throb" style="color: #d43f57;"></i> by <span class="author" itemprop="copyrightHolder">Dloux</span>. </p>

        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    <canvas id="evanyou"></canvas>
    <!-- æš‚æ—¶æ³¨é‡Š live2d
    <canvas id="live2d" width="150" height="400" class="live2d"></canvas>
    -->
    

  </div>

  <script type="text/javascript" src="/js/sagiri.min.js?v=0.0.4"></script>

  





  

  
  

  

  

  

</body>
</html>
